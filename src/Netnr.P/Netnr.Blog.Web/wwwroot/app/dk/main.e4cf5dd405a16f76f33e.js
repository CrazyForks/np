(()=>{"use strict";var __webpack_modules__={484:(e,a,t)=>{t.d(a,{F:()=>r});var n=t(769),r={lk:()=>agGrid.LicenseManager.prototype.outputMissingLicenseKey=e=>{},defaultColDef:e=>Object.assign({width:150,minWidth:100,maxWidth:4e3,filter:!0,sortable:!0,resizable:!0,filter:"agMultiColumnFilter",menuTabs:["generalMenuTab","filterMenuTab","columnsMenuTab"]},e),autoGroupColumnDef:e=>Object.assign({width:300,maxWidth:4e3},e),optionDef:e=>Object.assign({localeText:"zh-CN"==n.t.languageGet()?r.localeText:null,defaultColDef:r.defaultColDef(),autoGroupColumnDef:r.autoGroupColumnDef(),rowGroupPanelShow:"always",enableBrowserTooltips:!0,rowSelection:"multiple",suppressRowClickSelection:!0,enableRangeSelection:!0,autoSizePadding:40,headerHeight:32,pagination:!1,paginationPageSize:100,cacheBlockSize:100,suppressMoveWhenRowDragging:!0,animateRows:!0,isRowSelectable:e=>!0!==e.group,onSortChanged:e=>e.api.refreshCells(),onFilterChanged:e=>e.api.refreshCells(),onRowGroupOpened:e=>e.api.refreshCells()},e),numberCol:e=>Object.assign({headerName:"🆔",valueGetter:"node.rowIndex + 1",width:120,maxWidth:150,checkboxSelection:!0,headerCheckboxSelection:!0,headerCheckboxSelectionFilteredOnly:!0,sortable:!1,filter:!1,menuTabs:!1},e),filterParamsDef:(e,a)=>{switch(e){case"Number":return{filters:[{filter:`ag${e}ColumnFilter`},{filter:"agSetColumnFilter"}]};case"Date":return{filters:[{filter:"agDateColumnFilter",filterParams:{comparator:function(e,a){if(null==a||""==a)return-1;var t=new Date(a);return t=new Date(Number(t.getFullYear()),Number(t.getMonth())-1,Number(t.getDate())),(e=new Date(Number(e.getFullYear()),Number(e.getMonth())-1,Number(e.getDate()))).getTime()==t.getTime()?0:t<e?-1:t>e?1:void 0}}},{filter:"agSetColumnFilter",filterParams:{comparator:(e,a)=>a}}]}}return a},getAllRows:function(e,a=!0){let t=[];return a?e.api.forEachLeafNode((e=>t.push(e.data))):e.api.forEachNode((e=>t.push(e.data))),t},getSelectedOrRangeRow:function(e){var a=e.api.getSelectedRows(),t=e.api.getCellRanges();return a.length>0?a[0]:t.length>0?e.api.getDisplayedRowAtIndex(t[0].startRow.rowIndex).data:void 0},getContainer:e=>e.api.gridOptionsWrapper.environment.eGridDiv,setGridLoading:function(e,a){if(e&&e.api)switch(a){case 1:e.api.hideOverlay();break;case 2:e.api.hideOverlay(),e.api.showNoRowsOverlay();break;default:e.api.showLoadingOverlay()}},localeText:{selectAll:"（全部）",selectAllSearchResults:"（全部搜索结果）",searchOoo:"搜索...",blanks:"（空）",noMatches:"未找到",filterOoo:"搜索...",equals:"等于",notEqual:"不等于",blank:"空",notBlank:"非空",empty:"选择一项",lessThan:"小于",greaterThan:"大于",lessThanOrEqual:"小于等于",greaterThanOrEqual:"大于等于",inRange:"范围",inRangeStart:"开始值",inRangeEnd:"结束值",contains:"包含",notContains:"不包含",startsWith:"头包含",endsWith:"尾包含",dateFormatOoo:"yyyy-mm-dd",andCondition:"和",orCondition:"或",applyFilter:"确定",resetFilter:"重置",clearFilter:"清除",cancelFilter:"取消",textFilter:"文本搜索",numberFilter:"数字搜索",dateFilter:"日期搜索",setFilter:"项搜索",columns:"列",filters:"搜索",pivotMode:"枢轴模式",groups:"行组",rowGroupColumnsEmptyMessage:"拖拽列到此处进行分组",values:"值",valueColumnsEmptyMessage:"拖拽到此处合计",pivots:"列标签",pivotColumnsEmptyMessage:"拖拽到此处设置列标签",group:"分组",rowDragRows:"行",loadingOoo:"加载中...",noRowsToShow:"（空）",enabled:"启用",pinColumn:"固定列",pinLeft:"左固定",pinRight:"右固定",noPin:"取消固定",valueAggregation:"合计",autosizeThiscolumn:"当前列大小自适应",autosizeAllColumns:"所有列大小自适应",groupBy:"分组",ungroupBy:"不分组",addToValues:"添加值 ${variable}",removeFromValues:"移除值 ${variable}",addToLabels:"添加到标签 ${variable}",removeFromLabels:"移除标签 ${variable}",resetColumns:"重置列",expandAll:"展开全部",collapseAll:"折叠全部",copy:"复制",ctrlC:"Ctrl+C",copyWithHeaders:"复制（带标题）",copyWithHeaderGroups:"复制（带分组）",paste:"粘贴",ctrlV:"Ctrl+V",export:"内置保存",csvExport:"CSV 导出",excelExport:"Excel 导出",sum:"求和",min:"最小",max:"最大",none:"无",count:"总数",avg:"平均",filteredRows:"过滤行",selectedRows:"选中",totalRows:"总行",totalAndFilteredRows:"搜索",more:"更多",to:"-",of:"，总共",page:"当前",nextPage:"下一页",lastPage:"尾页",firstPage:"首页",previousPage:"上一页",pivotColumnGroupTotals:"总",pivotChartAndPivotMode:"图表枢轴 & 枢轴模式",pivotChart:"图表枢轴",chartRange:"范围图表",columnChart:"柱状图",groupedColumn:"分组",stackedColumn:"堆叠柱形图",normalizedColumn:"100% 堆叠柱形图",barChart:"条形图",groupedBar:"分组",stackedBar:"堆叠柱形图",normalizedBar:"100% 堆叠柱形图",pieChart:"饼形图",pie:"饼图",doughnut:"环形图",line:"线图",xyChart:"散点图及气泡图",scatter:"散点图",bubble:"气泡图",areaChart:"面积图",area:"面积",stackedArea:"叠堆",normalizedArea:"100% 叠堆",histogramChart:"直方图",pivotChartTitle:"图表枢轴",rangeChartTitle:"范围图表",settings:"设置",data:"数据",format:"格式",categories:"类别",defaultCategory:"(无)",series:"系数",xyValues:"X Y 值",paired:"配对模式",axis:"轴",navigator:"导航",color:"颜色",thickness:"坐标宽度",xType:"X Type",automatic:"Automatic",category:"类别",number:"数字",time:"时间",xRotation:"X 旋转",yRotation:"Y 旋转",ticks:"Ticks",width:"宽",height:"高",length:"长",padding:"填充",spacing:"间距",chart:"图表",title:"标题",titlePlaceholder:"图表标题 - 双击编辑",background:"背景",font:"字体",top:"上",right:"右",bottom:"下",left:"左",labels:"标签",size:"大小",minSize:"最小",maxSize:"最大",legend:"指标项",position:"位置",markerSize:"Marker Size",markerStroke:"Marker Stroke",markerPadding:"Marker Padding",itemSpacing:"Item Spacing",itemPaddingX:"Item Padding X",itemPaddingY:"Item Padding Y",layoutHorizontalSpacing:"Horizontal Spacing",layoutVerticalSpacing:"Vertical Spacing",strokeWidth:"线条宽度",offset:"Offset",offsets:"Offsets",tooltips:"显示提示",callout:"Callout",markers:"标点",shadow:"阴影",blur:"发散",xOffset:"X 偏移",yOffset:"Y 偏移",lineWidth:"线条粗细",normal:"正常",bold:"加粗",italic:"斜体",boldItalic:"加粗斜体",predefined:"Predefined",fillOpacity:"填充透明度",strokeOpacity:"线条透明度",histogramBinCount:"Bin count",columnGroup:"柱状",barGroup:"条形",pieGroup:"饼状",lineGroup:"线",scatterGroup:"散点及气泡",areaGroup:"面积",histogramGroup:"直方",groupedColumnTooltip:"Grouped",stackedColumnTooltip:"Stacked",normalizedColumnTooltip:"100% Stacked",groupedBarTooltip:"Grouped",stackedBarTooltip:"Stacked",normalizedBarTooltip:"100% Stacked",pieTooltip:"Pie",doughnutTooltip:"Doughnut",lineTooltip:"Line",groupedAreaTooltip:"Area",stackedAreaTooltip:"Stacked",normalizedAreaTooltip:"100% Stacked",scatterTooltip:"Scatter",bubbleTooltip:"Bubble",histogramTooltip:"Histogram",noDataToChart:"No data available to be charted.",pivotChartRequiresPivotMode:"Pivot Chart requires Pivot Mode enabled.",chartSettingsToolbarTooltip:"Menu",chartLinkToolbarTooltip:"Linked to Grid",chartUnlinkToolbarTooltip:"Unlinked from Grid",chartDownloadToolbarTooltip:"Download Chart"}}},147:(e,a,t)=>{t.d(a,{x:()=>m});var n=t(213),r=t(372),o=t(178),l=t(821),i=t(513),s=t(3),c=t(384),d=t(769),p=t(334),u=t(644),m={actionRun:function(e,a){var t="object"==typeof a?a.getAttribute("data-val"):a;switch(e){case"theme":l.p.theme=t,m.themeSL(),m.themeGrid(),m.themeEditor(),r.U.stepSave();break;case"language":d.t.language=t,l.p.domMenu.querySelectorAll('[data-cmd="language"]').forEach((e=>{e.checked=e.getAttribute("data-val")==d.t.language})),"object"==typeof a&&(u.R.output(d.t.lg.reloadDone),r.U.stepSave());break;case"setting-manager":l.p.domDialogSetting.show(),l.p.domTextApiServer.value=l.p.apiServer;var b=[];for(const e in l.p.parameterConfig){const a=l.p.parameterConfig[e],t=d.t.lg[`parameterKey_${e}`];switch(a.type){case"number":b.push(`<div><sl-input name="${e}" label="${t}" type="${a.type}" required placeholder="${d.t.lg.default} ${a.defaultValue}" value="${a.value}"></sl-input></div>`);break;case"select":case"boolean":b.push(`<div><sl-select name="${e}" label="${t}" value="${a.value}" hoist="true">`),a.list.forEach((t=>{var n=d.t.lg[`parameterKey_${e}_${t.val}`.replace("-","_")],r=a.defaultValue==t.val?"class='nrc-item-default'":"";b.push(`<sl-menu-item ${r} value="${t.val}">${n}</sl-menu-item>`)})),b.push("</sl-select></div>")}}b.push(`<div><sl-button size="large" pill>${l.p.emoji.success}${d.t.lg.save}</sl-button></div>`),l.p.domParameterConfig.innerHTML=b.join(""),1!=l.p.domDialogSetting.getAttribute("event-bind")&&(l.p.domDialogSetting.setAttribute("event-bind",1),l.p.domTextApiServer.addEventListener("input",(function(){l.p.apiServer=this.value,r.U.stepSave()}),!1),l.p.domTextApiServer.addEventListener("blur",(function(){this.value.endsWith("/")&&(l.p.apiServer=this.value.substring(0,this.value.length-1),this.value=l.p.apiServer),r.U.stepSave()}),!1),l.p.domParameterConfig.addEventListener("click",(function(e){if("SL-BUTTON"==e.target.tagName){for(const e in l.p.parameterConfig){const a=l.p.parameterConfig[e];let t=l.p.domParameterConfig.querySelector(`[name="${e}"]`).value;"number"==a.type?t=parseInt(t):"boolean"==a.type&&(t="true"==t),a.value=t}r.U.stepSave(),u.R.output(d.t.lg.done)}}),!1));break;case"about":u.R.alert(`\n                    <h3>NDK (Netnr.DataKit)</h3>\n                    <p>${d.t.lg.version}: ${l.p.version}</p>\n                    <p><a href="https://github.com/netnr/np" target="_blank">https://github.com/netnr/np</a></p>\n                    <p><a href="https://zme.ink" target="_blank">Sponsors</a></p>\n                    `,"25vw");break;case"set-api-server":l.p.domTextApiServer.value=l.p.apiServer=t,r.U.stepSave();break;case"config-export":case"config-export-clipboard":var g=[],h=[],f={date:u.R.now(),version:l.p.version};l.p.domConfigExportItems.querySelectorAll("sl-checkbox").forEach((e=>{if(e.checked){var a=e.getAttribute("data-val");g.push(a);var t=Object.values(s.$.keys).find((e=>e.key==a));h.push(s.$.instanceConfig.getItem(t.key))}})),Promise.all(h).then((a=>{for(var t=0;t<a.length;t++)f[g[t]]=a[t];m.safeConfig(f,"AESEncrypt").then((()=>{if(e.endsWith("clipboard")){var a=JSON.stringify(f,null,4);u.R.clipboard(a).then((()=>{u.R.output(d.t.lg.done),u.R.toast(d.t.lg.done)}))}else{a=JSON.stringify(f);u.R.download(a,"ndk.json")}}))}));break;case"config-import":case"config-import-clipboard":try{new Promise((t=>{e.endsWith("clipboard")?u.R.clipboard().then((e=>{t(e)})):t(a.previousElementSibling.value)})).then((e=>{if(""==e.trim())u.R.output(d.t.lg.contentNotEmpty);else{var a=JSON.parse(e),t=[];m.safeConfig(a,"AESDecrypt").then((()=>{var e=Object.keys(a);Object.values(s.$.keys).forEach((n=>{e.includes(n.key)&&t.push(s.$.instanceConfig.setItem(n.key,a[n.key]))})),Promise.all(t).then((()=>{u.R.output(d.t.lg.done),u.R.toast(d.t.lg.done),location.reload(!1)}))}))}}))}catch(e){console.debug(e),u.R.output(e)}break;case"new-query":switch(l.p.domTabGroup1.activeTab.panel){case"tp1-conns":(E=agg.getSelectedOrRangeRow(l.p.gridOpsConns))?o.W.tabBuild(u.R.random(),l.p.iconSvg("plug-fill",E.alias),"sql").then((e=>{l.p.domTabGroup2.show(e),r.U.cpSet(e,E),r.U.cpInfo(e)})):u.R.output(d.t.lg.selectDataRows);break;case"tp1-database":if(E=agg.getSelectedOrRangeRow(l.p.gridOpsDatabase))o.W.tabBuild(u.R.random(),l.p.iconSvg("server",E.DatabaseName),"sql").then((e=>{l.p.domTabGroup2.show(e);var a=r.U.cpGet(1);r.U.cpSet(e,a.cobj,E.DatabaseName),r.U.cpInfo(e)}));else{var v=r.U.cpGet(1);E=v.cobj,o.W.tabBuild(u.R.random(),l.p.iconSvg("plug-fill",E.alias),"sql").then((e=>{l.p.domTabGroup2.show(e),r.U.cpSet(e,E),r.U.cpInfo(e)}))}break;case"tp1-table":case"tp1-column":(v=r.U.cpGet(1))&&v.cobj&&v.databaseName?o.W.tabBuild(u.R.random(),l.p.iconSvg("server",v.databaseName),"sql").then((e=>{l.p.domTabGroup2.show(e);var a=r.U.cpGet(1);r.U.cpSet(e,a.cobj,a.databaseName),r.U.cpInfo(e)})):u.R.output(d.t.lg.selectDataRows)}break;case"sql-execute-selected-or-all":var S=a.getAttribute("panel"),y=o.W.tabKeys[S];p.Y.editorSql(S);break;case"sql-formatting":S=a.getAttribute("panel"),y=o.W.tabKeys[S];n.C.formatter(y.editor);break;case"quick-generate-code":if(v=r.U.cpCurrent()){var E=v.cobj;o.W.tabBuild(10099,l.p.iconSvg("file-earmark-code",d.t.lg.generateCode),"code").then((e=>{l.p.domTabGroup2.show(e),r.U.cpSet(e,E),r.U.cpInfo(e)}))}break;case"quick-generate-faker":if(v=r.U.cpCurrent()){E=v.cobj;o.W.tabBuild(10098,l.p.iconSvg("box",d.t.lg.generateFaker),"faker").then((e=>{l.p.domTabGroup2.show(e),r.U.cpSet(e,E),r.U.cpInfo(e)}))}break;case"quick-dbenvinfo":if(v=r.U.cpCurrent()){E=v.cobj;o.W.tabBuild(u.R.random(),l.p.iconSvg("info-circle",E.alias),"sql").then((e=>{l.p.domTabGroup2.show(e),r.U.cpSet(e,E),r.U.cpInfo(e);var a=c.A[E.type].find((e=>"db-env-info"==e.name)).sql;o.W.tabKeys[e].editor.setValue(a),p.Y.editorSql(e)}))}break;case"quick-dbparamsinfo":if(v=r.U.cpCurrent()){E=v.cobj;o.W.tabBuild(u.R.random(),l.p.iconSvg("info-circle",E.alias),"sql").then((e=>{l.p.domTabGroup2.show(e),r.U.cpSet(e,E),r.U.cpInfo(e);var a=c.A[E.type].find((e=>"db-params-info"==e.name)).sql;o.W.tabKeys[e].editor.setValue(a),p.Y.editorSql(e)}))}break;case"open-link":var _=document.createElement("a");_.href=t,_.target="_blank",_.click();break;case"sql-notes":S=a.getAttribute("panel"),v=r.U.cpGet(S);i.P.viewExecuteSql({Item1:{"sql-notes":c.A[v.cobj.type]}},S);break;case"sql-historys":S=a.getAttribute("panel"),v=r.U.cpGet(S);s.$.historysGet().then((e=>{i.P.viewExecuteSql({Item1:{"sql-historys":e}},S)}));break;case"view-cell-image":var T=`<div style="text-align:center"><img style="max-width:100%;" src="data:image;base64,${t}"></div>`;u.R.alert(T,"full");break;case"view-cell-text":u.R.alert("<sl-textarea></sl-textarea>","full");try{l.p.domAlert.querySelector("sl-textarea").value=window.atob(t)}catch(e){u.R.output(e)}}},themeSL:()=>{l.p.domMenu.querySelectorAll('sl-menu-item[data-cmd="theme"]').forEach((e=>{e.checked=e.getAttribute("data-val")==l.p.theme})),"dark"==l.p.themeGet()?document.documentElement.classList.add("sl-theme-dark"):document.documentElement.classList.remove("sl-theme-dark")},themeGrid:function(){var e=e=>{var a="ag-theme-balham",t="ag-theme-balham-dark";if(e.classList.remove(a),e.classList.remove(t),"dark"===l.p.themeGet())e.classList.add(t);else e.classList.add(a)};for(const t in l.p)if(t.startsWith("domGrid")){var a=l.p[t];e(a)}for(var t in l.p.domTabGroup2.querySelectorAll(".nr-grid-execute-sql").forEach((a=>{e(a)})),o.W.tabKeys){var n=o.W.tabKeys[t];n.grids&&n.grids.forEach((a=>{var t=a.domGridExecuteSql;e(t)}))}},themeEditor:function(){if(window.monaco)if("dark"===l.p.themeGet())monaco.editor.setTheme("vs-dark");else monaco.editor.setTheme("vs")},setSpliterSize:(e,a="no")=>{var t=e.classList.contains("nrc-spliter-horizontal"),n=e.children;if("auto"==a)if(t&&n[3].clientWidth/e.clientWidth<.15)a="50%";else{if(t||!(n[3].clientHeight/e.clientHeight<.15))return!1;a="30%"}"yes"==a?a="30%":"no"==a&&(a="calc(100% - var(--nrc-spliter-width))"),t?(n[0].style.width=a,n[2].style.left=a,n[3].style.width=`calc(100% - var(--nrc-spliter-width) - ${a})`):(n[0].style.height=a,n[2].style.top=a,n[3].style.height=`calc(100% - var(--nrc-spliter-width) - ${a})`)},getSpliterSize:e=>e.classList.contains("nrc-spliter-horizontal")?(parseFloat(getComputedStyle(e.firstElementChild).width)/parseFloat(getComputedStyle(e).width)*100).toFixed(2)+"%":(parseFloat(getComputedStyle(e.firstElementChild).height)/parseFloat(getComputedStyle(e).height)*100).toFixed(2)+"%",safeConfig:(e,a)=>new Promise((t=>{let n=e[s.$.keys.keyConns.key]||[],r=0;n.forEach((e=>{u.R[a](e.conn,l.p.key).then((a=>{r++,e.conn=a})).catch((()=>{r++}))})),l.p.defer.safeConfig=setInterval((()=>{n.length==r&&(clearInterval(l.p.defer.safeConfig),t(e))}),100)})),size:function(){var e=document.documentElement.clientHeight;l.p.domSpliter1.style.height=e-l.p.domSpliter1.getBoundingClientRect().top-5+"px",["Conns","Database","Table","Column"].forEach((a=>{var t=l.p[`domGrid${a}`];if("none"!=getComputedStyle(t.parentElement).display){var n=t.getBoundingClientRect().top+5;t.style.height=e-n+"px"}})),l.p.domTabGroup2.querySelectorAll(".nr-spliter2").forEach((a=>{var t=a.parentElement;if("none"!=getComputedStyle(t).display){var n=a.getBoundingClientRect().top+5;a.style.height=e-n+"px";var r=o.W.tabKeys[t.name];r&&r.grids&&r.grids.forEach((a=>{if("none"!=getComputedStyle(a.domTabPanel).display){var t=e-a.domGridExecuteSql.getBoundingClientRect().top-5+"px";if(a.domGridExecuteSql.style.height=t,!a.gridOps&&a.opsExecuteSql){var n=new agGrid.Grid(a.domGridExecuteSql,a.opsExecuteSql).gridOptions;a.domFilterExecuteSql.addEventListener("input",(function(){n.api.setQuickFilter(this.value)}),!1),a.gridOps=n}}}))}})),l.p.domTabGroup2.querySelectorAll(".nr-spliter3").forEach((a=>{var t=a.parentElement;if("none"!=getComputedStyle(t).display){var n=a.getBoundingClientRect().top+5;a.style.height=e-n+"px";var r=o.W.tabKeys[t.name];r.domEditor1.style.height=e-n-r.domTool1.clientHeight+"px",r.domEditor2.style.height=e-n-r.domTool2.clientHeight+"px"}}))}}},213:(e,a,t)=>{t.d(a,{C:()=>i});var n=t(821),r=t(769),o=t(178),l=t(372),i={init:e=>{if(e){for(var a,t={paths:{}},n=0;n<document.scripts.length;n++){var o=document.scripts[n];if(o.src.includes("monaco-editor")){a=o.src;break}}t.paths.vs=a.replace("/loader.js",""),"zh-CN"==r.t.languageGet()&&(t["vs/nls"]={availableLanguages:{"*":"zh-cn"}}),e.config(t),e(["vs/editor/editor.main"],(function(){i.extend()}))}else i.extend()},extend:()=>{monaco.languages.html.registerHTMLLanguageService("xml",{},{documentFormattingEdits:!0});["sql","mysql","pgsql"].forEach((e=>{monaco.languages.registerDocumentFormattingEditProvider(e,{provideDocumentFormattingEdits:function(e,a,t){let r;return n.p.domTabGroup2.querySelectorAll(".nr-editor-sql").forEach((a=>{let t=a.getAttribute("panel");o.W.tabKeys[t].editor.getModel()==e&&(r=l.U.cpGet(t).cobj.type)})),[{text:i.formatterSQL(e.getValue(),r),range:e.getFullModelRange()}]}})}))},config:e=>Object.assign({value:"",theme:"dark"==n.p.themeGet()?"vs-dark":"vs",fontSize:n.p.parameterConfig.editorFontSize.value,language:"sql",lineNumbers:n.p.parameterConfig.editorLineNumbers.value,wordWrap:n.p.parameterConfig.editorWordWrap.value,automaticLayout:!0,scrollbar:{verticalScrollbarSize:13,horizontalScrollbarSize:13},minimap:{enabled:!1}},e),create:(e,a)=>new Promise((t=>{t(monaco.editor.create(e,i.config(a)))})),formatter:e=>e.trigger("a","editor.action.formatDocument"),selectedValue:e=>e.getModel().getValueInRange(e.getSelection()),selectedOrAllValue:e=>{var a=i.selectedValue(e);return""==a.trim()&&(a=e.getValue()),a},keepSetValue:(e,a)=>{var t=e.getPosition();e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:a}]),e.setSelection(new monaco.Range(0,0,0,0)),e.setPosition(t)},formatterSQL:function(e,a){var t;switch(a){case"MySQL":case"MariaDB":case"PostgreSQL":t=a.toLowerCase();break;case"Oracle":t="plsql";break;default:t="tsql"}return sqlFormatter.format(e,{language:t})},setLanguage:(e,a)=>{monaco.editor.setModelLanguage(e.getModel(),a)},fullScreen:function(e){e.addAction({id:"meid-fullscreen",label:r.t.lg.fullScreenSwitch,keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyMod.Alt|monaco.KeyCode.KeyM],contextMenuGroupId:"me-01",run:function(e){e.getContainerDomNode().classList.toggle("nrc-fullscreen")}})},wordWrap:function(e){e.addAction({id:"meid-wordwrap",label:r.t.lg.wrapSwitch,keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyMod.Alt|monaco.KeyCode.KeyN],contextMenuGroupId:"me-01",run:function(e){var a=e.getContainerDomNode(),t=a.getAttribute("wordWrap");null==t&&(t=e.getRawOptions().wordWrap),t="on"==t?"off":"on",a.setAttribute("wordWrap",t),e.updateOptions({wordWrap:t})}})},typeAsLanguage:function(e){var a;switch(e){case"MySQL":case"MariaDB":a="mysql";break;case"PostgreSQL":a="pgsql";break;default:a="sql"}return a}}},334:(e,a,t)=>{t.d(a,{Y:()=>c});var n=t(178),r=t(821),o=t(213),l=t(644),i=(t(384),t(33)),s=t(3),c={executeSql:(e,a,t)=>new Promise(((n,o)=>{var l=new FormData;l.append("tdb",e.type),l.append("conn",e.conn),l.append("sql",t),a&&l.append("databaseName",a),t.length<9999&&s.$.historysAdd(e.id,a,t),i.N.request(`${r.p.apiServer}${r.p.apiExecuteSql}`,{method:"POST",body:l}).then((e=>n(e.data))).catch((e=>o(e)))})),editorSql:e=>{var a=n.W.tabKeys[e],t=o.C.selectedOrAllValue(a.editor);if(""==t.trim())l.R.output(ndkI18n.lg.contentNotEmpty);else{var r=ndkStep.cpGet(e);c.executeSql(r.cobj,r.databaseName,t).then((a=>{ndkView.viewExecuteSql(a,e)}))}}}},644:(e,a,t)=>{t.d(a,{R:()=>o});var n=t(821),r=t(769),o={hump:e=>e.substring(0,1).toUpperCase()+e.substring(1),htmlEncode:e=>{var a=document.createElement("div");return a.innerText=e,a.innerHTML},htmlCull:e=>{var a=document.createElement("div");return a.innerHTML=e,a.innerText},cssvar:(e,a,t)=>{if(null==t)return getComputedStyle(e).getPropertyValue(a);e.style.setProperty(a,t)},type:function(e){return{}.toString.call(e).split(" ")[1].replace("]","")},arrayDistinct:e=>Array.from(new Set(e)),groupBy:(e,a)=>Array.from(new Set(e.map(a))),byteLength:e=>{var a=0;return Array.from(e).map((function(e){a+=e.charCodeAt(0)>255?2:1})),a},formatByteSize:function(e,a=2,t=1024){if(Math.abs(e)<t)return e+" B";const n=1e3==t?["KB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];let r=-1;const o=10**a;do{e/=t,++r}while(Math.round(Math.abs(e)*o)/o>=t&&r<n.length-1);return(1*e.toFixed(a)).toString()+" "+n[r]},formatDateTime:(e,a)=>{a=a||Date.now();var t=Intl.DateTimeFormat().resolvedOptions(),n={hour12:!1,timeZone:t.timeZone};switch(e){case"date":n=Object.assign({year:"numeric",month:"2-digit",day:"2-digit"},n);break;case"time":n=Object.assign({hour:"numeric",minute:"2-digit",second:"2-digit"},n);break;case"year":return new Date(a).getFullYear();default:n=Object.assign({year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"2-digit",second:"2-digit"},n)}return new Intl.DateTimeFormat(t.locale,n).format(a)},now:()=>o.formatDateTime("datetime"),formatNull:()=>'<em style="color:var(--sl-color-neutral-400)">(Null)</em>',notify:(e,a)=>{if(window.Notification)if("granted"===Notification.permission){var t=new Notification(e,a);t.onclick=function(){window.focus(),t.close()}}else"denied"!==Notification.permission&&Notification.requestPermission((function(t){if("granted"===t){var n=new Notification(e,a);n.onclick=function(){window.focus(),n.close()}}}))},toast:function(e,a="primary",t="info-circle",n=8e3){const r=Object.assign(document.createElement("sl-alert"),{type:a,closable:!0,duration:n,innerHTML:`\n          <sl-icon name="${t}" slot="icon"></sl-icon>\n          ${e}\n        `});return document.body.append(r),r.toast()},alert:(e,a="50vw")=>{null==n.p.domAlert&&(n.p.domAlert=document.createElement("sl-dialog"),document.body.appendChild(n.p.domAlert),n.p.domAlert.addEventListener("click",(function(e){"primary"==e.target.getAttribute("variant")&&n.p.domAlert.hide()}),!1)),"full"==a&&(a="98vw"),n.p.domAlert.setAttribute("style",`--width:${a}`),n.p.domAlert.innerHTML=`${e}<sl-button slot="footer" variant="primary">${r.t.lg.close}</sl-button>`,n.p.domAlert.show()},output:e=>{n.p.domOutputBody.style.display="block",clearTimeout(n.p.defer.outputAutoHide),n.p.defer.outputAutoHide=setTimeout((()=>{n.p.domOutputBody.style.display="none"}),6e3);try{"string"!=typeof e&&(e=JSON.stringify(e))}catch(e){}var a=[{content:e}];n.p.gridOpsOutput.rowData.unshift(a[0]),n.p.gridOpsOutput.api.applyTransaction({addIndex:0,add:a});var t=n.p.gridOpsOutput.api.getDisplayedRowAtIndex(0);n.p.gridOpsOutput.api.flashCells({rowNodes:[t]})},markdownEncode:e=>(null!=e&&(e=e.toString().replace(/\n/g,"<br/>").replace(/\r/g,"").replace(/\[/g,"\\[").replace(/\(/g,"\\(")),e),rowsToMarkdown:(e,a,t)=>{null==a&&Object.keys(e[0]).forEach((e=>{a.push({headerName:a[e]||e,field:e})})),null==t&&(t={});var n=[];return e.forEach((e=>{var r=[];a.forEach((a=>{var n=e[a.field];null!=a.cellRenderer&&(n=a.cellRenderer({value:n,data:e})),n=o.markdownEncode(n),t.htmlCull&&(n=o.htmlCull(n)),r.push(n)})),n.push(`| ${r.join(" | ")} |`)})),`| ${a.map((e=>e.headerName)).join(" | ")} |\n| ${a.map((e=>"---")).join(" | ")} |\n${n.join("\n")}`},random:(e=2e4,a=99999)=>Math.floor(Math.random()*(a-e+1)+e),UUID:()=>window.crypto?crypto.randomUUID():URL.createObjectURL(new Blob([])).split("/").pop(),AESEncrypt:(e,a)=>new Promise(((t,n)=>{let r=(new TextEncoder).encode(a);window.crypto.subtle.digest("SHA-256",r).then((a=>{let r=window.crypto.getRandomValues(new Uint8Array(12)),o=Array.from(r).map((e=>String.fromCharCode(e))).join(""),l={name:"AES-GCM",iv:r};window.crypto.subtle.importKey("raw",a,l,!1,["encrypt"]).then((a=>{let r=(new TextEncoder).encode(e);window.crypto.subtle.encrypt(l,a,r).then((e=>{let a=Array.from(new Uint8Array(e)).map((e=>String.fromCharCode(e))).join(""),n=window.btoa(o+a);t(n)})).catch(n)})).catch(n)})).catch(n)})),AESDecrypt:(e,a)=>new Promise(((t,n)=>{let r=(new TextEncoder).encode(a);window.crypto.subtle.digest("SHA-256",r).then((a=>{let r=window.atob(e).slice(0,12),o={name:"AES-GCM",iv:new Uint8Array(Array.from(r).map((e=>e.charCodeAt(0))))};window.crypto.subtle.importKey("raw",a,o,!1,["decrypt"]).then((a=>{let r=window.atob(e).slice(12),l=new Uint8Array(Array.from(r).map((e=>e.charCodeAt(0))));window.crypto.subtle.decrypt(o,a,l).then((e=>{let a=(new TextDecoder).decode(e);t(a)})).catch(n)})).catch(n)})).catch(n)})),download:function(e,a){var t=document.createElement("a"),n=new Blob([e]);t.download=a,t.href=URL.createObjectURL(n),document.body.appendChild(t),t.click(),URL.revokeObjectURL(n),t.remove()},readFileContent:(e,a="utf-8")=>new Promise(((t,n)=>{var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(){n(r.error)},r.readAsText(e,a)})),clipboard:e=>new Promise(((a,t)=>{if(o.supportClipboard)null==e?navigator.clipboard.readText().then((e=>{a(e)})).catch((e=>{t(e)})):navigator.clipboard.writeText(e).then((e=>{a(e)})).catch((e=>{t(e)}));else if(null!=e){var n=document.createElement("textarea");n.value=e,n.style.position="fixed",n.style.opacity=0,document.body.appendChild(n),n.select(),document.execCommand("Copy"),n.remove(),a(e)}else t(r.t.lg.unsupported)})),supportClipboard:window.isSecureContext&&null!=navigator.clipboard}},722:(e,a,t)=>{t.d(a,{l:()=>i});var n=t(644),r=t(769),o=t(372),l=t(821),i={ref:{echoTableColumn:function(e){var a,t=[];if(l.p.gridOpsColumn&&(t=l.p.gridOpsColumn.api.getSelectedRows(),a=o.U.cpGet(1).cobj.type),0==t.length)return n.R.output(r.t.lg.selectColumn),r.t.lg.selectColumn;console.debug("allColumns",t),console.debug("ctype",a);let i=n.R.groupBy(t,(e=>null==e.SchemaName?e.TableName:`${e.SchemaName}.${e.TableName}`));i.forEach((n=>{let r=t.filter((e=>null==e.SchemaName?e.TableName==n:`${e.SchemaName}.${e.TableName}`==n)),o=r[0],l=n.split(".").pop();e(t,a,i,n,r,o,l,[])}))},csharp:{isNullable:["DateTime","DateTimeOffset","Guid","NpgsqlTypes.NpgsqlLSeg","NpgsqlTypes.NpgsqlLine","NpgsqlTypes.NpgsqlPath","NpgsqlTypes.NpgsqlPoint","TimeSpan","bool","byte","decimal","double","float","int","long"],SQLite:{integer:["int","Integer"],real:["double","Real"],text:["string","Text"],blob:["byte[]","Blob"]},MySQL:{bigint:["long","Int64"],binary:["byte[]","Binary"],bit:["ulong","Bit"],blob:["byte[]","Blob"],char:["string","VarChar"],date:["DateTime","Date"],datetime:["DateTime","DateTime"],decimal:["decimal","Decimal"],double:["double","Double"],float:["float","Float"],int:["int","Int32"],json:["string","JSON"],longblob:["byte[]","LongBlob"],longtext:["string","LongText"],mediumblob:["byte[]","MediumBlob"],mediumint:["int","Int32"],mediumtext:["string","MediumText"],text:["string","Text"],time:["DateTime","Time"],timestamp:["DateTime","Timestamp"],tinyblob:["byte[]","TinyBlob"],tinyint:["short","Int16"],tinytext:["string","TinyText"],varbinary:["byte[]","VarBinary"],varchar:["string","VarChar"],year:["string","Year"]},Oracle:{BFILE:["byte[]","BFile"],VARCHAR2:["string","Varchar2"],BINARY_DOUBLE:["double","BinaryDouble"],BINARY_FLOAT:["float","BinaryFloat"],BLOB:["byte[]","Blob"],CLOB:["string","Clob"],CHAR:["string","Char"],DATE:["DateTime","Date"],LONG:["Long","Long"],"LONG RAW":["byte[]","LongRaw"],NCLOB:["string","NClob"],NUMBER:["decimal","Decimal"],NVARCHAR2:["string","NVarchar2"],RAW:["byte[]","Raw"],"TIMESTAMP(6)":["DateTime","TimeStamp"],"INTERVAL DAY(2) TO SECOND(6)":["TimeSpan","IntervalDS"],"INTERVAL YEAR(2) TO MONTH":["string","IntervalYM"],"TIMESTAMP(6) WITH LOCAL TIME ZONE":["DateTimeOffset","TimeStampLTZ"],"TIMESTAMP(6) WITH TIME ZONE":["DateTimeOffset","TimeStampTZ"]},SQLServer:{bigint:["long","BigInt"],binary:["byte[]","Binary"],bit:["bool","Bit"],char:["string","Char"],date:["DateTime","Date"],datetime:["DateTime","DateTime"],datetime2:["DateTime","DateTime2"],datetimeoffset:["DateTimeOffset","DateTimeOffset"],decimal:["decimal","Decimal"],float:["double","Float"],image:["byte[]","Image"],int:["int","Int"],money:["decimal","Money"],nchar:["string","NChar"],ntext:["string","NText"],numeric:["decimal","Decimal"],nvarchar:["string","NVarChar"],real:["float","Real"],smalldatetime:["DateTime","SmallDateTime"],smallint:["short","SmallInt"],smallmoney:["decimal","SmallMoney"],sql_variant:["object","NVarChar"],text:["string","Text"],time:["TimeSpan","Time"],timestamp:["byte[]","Timestamp"],tinyint:["byte","TinyInt"],uniqueidentifier:["Guid","UniqueIdentifier"],varbinary:["byte[]","VarBinary"],varchar:["string","VarChar"],xml:["string","Xml"]},PostgreSQL:{bit:["System.Collections.BitArray","Bit"],bool:["bool","Boolean"],box:["NpgsqlTypes.NpgsqlBox","Box"],bytea:["byte[]","Bytea"],bpchar:["string","Varchar"],cidr:["ValueTuple<System.Net.IPAddress, int>","Cidr"],circle:["NpgsqlTypes.NpgsqlCircle","Circle"],date:["DateTime","Date"],numeric:["decimal","Numeric"],float4:["float","Double"],float8:["double","Double"],inet:["System.Net.IPAddress","Inet"],int2:["short","Integer"],int4:["int","Integer"],int8:["long","Bigint"],interval:["TimeSpan","Interval"],json:["string","Json"],jsonb:["string","Jsonb"],line:["NpgsqlTypes.NpgsqlLine","Line"],lseg:["NpgsqlTypes.NpgsqlLSeg","LSeg"],macaddr:["System.Net.NetworkInformation.PhysicalAddress","MacAddr"],money:["decimal","Money"],path:["NpgsqlTypes.NpgsqlPath","Path"],point:["NpgsqlTypes.NpgsqlPoint","Point"],text:["string","Text"],time:["TimeSpan","Time"],timestamp:["DateTime","Timestamp"],timestamptz:["DateTime","TimestampTz"],timetz:["TimeSpan","TimeTz"],tsquery:["NpgsqlTypes.NpgsqlTsQuery","TsQuery"],tsvector:["NpgsqlTypes.NpgsqlTsVector","TsVector"],txid_snapshot:["string","Varchar"],uuid:["Guid","Uuid"],varbit:["System.Collections.BitArray","Varbit"],varchar:["string","Varchar"],xml:["string","Xml"]}}},fns:[{language:"csharp",name:"Model",fn:()=>{let e=[],a="Netnr.Blog.Domain",t="Netnr.Blog.Domain",n=window.ndkGenerateCode.ref;return n.echoTableColumn(((r,o,l,i,s,c,d,p)=>{p.push("using System;"),p.push(""),p.push(`namespace ${t}`),p.push("{"),p.push("\t/// <summary>"),(c.TableComment||"").split("\n").forEach((e=>p.push(`\t/// ${e.trim()}`))),p.push("\t/// </summary>"),p.push(`\tpublic partial class ${d}`),p.push("\t{"),s.forEach((e=>{p.push("\t\t/// <summary>"),(e.ColumnComment||"").split("\n").forEach((e=>p.push(`\t\t/// ${e.trim()}`))),p.push("\t\t/// </summary>"),e.DataType="Oracle"==o?e.DataType.toUpperCase():e.DataType.toLowerCase();let a="object",t=n.csharp[o][e.DataType];t&&(a=t[0]),"Oracle"==o&&"decimal"==a&&0==e.DataScale&&(a="int"),1==e.IsNullable&&n.csharp.isNullable.includes(a)&&(a+="?"),p.push(`\t\tpublic ${a} ${e.ColumnName} { get; set; }`)})),p.push("\t}"),p.push("}"),e.push({name:`${d}.cs`,content:p.join("\r\n"),path:a})})),console.debug("fnout",e),e}},{language:"csharp",name:"DAL",fn:()=>{let e=[],a="Netnr.Blog.Application",t="Netnr.Blog.Application",n=window.ndkGenerateCode.ref;return n.echoTableColumn(((r,o,l,i,s,c,d,p)=>{switch(p.push("using System;"),p.push("using System.Data;"),o){case"MySQL":case"MariaDB":p.push("using MySql.Data.MySqlClient;");break;case"SQLite":p.push("using Microsoft.Data.Sqlite;");break;case"Oracle":p.push("using Oracle.ManagedDataAccess.Client;");break;case"SQLServer":p.push("using System.Data.SqlClient;");break;case"PostgreSQL":p.push("using Npgsql;"),p.push("using NpgsqlTypes;")}p.push(""),p.push(`namespace ${t}`),p.push("{"),p.push("\t/// <summary>"),(c.TableComment||"").split("\n").forEach((e=>p.push(`\t/// ${e.trim()}`))),p.push("\t/// </summary>"),p.push(`\tpublic partial class ${d}`),p.push("\t{"),p.push(`\t\tpublic ${d}() { }`),p.push("");let u={namespaceDomain:"Netnr.Blog.Domain",pprefix:"Oracle"==o?":":"@",fields:s.map((e=>e.ColumnName)),dbQuery:"DbHelper.SqlExecuteReader",dbExecute:"DbHelper.SqlExecuteNonQuery",dbParameterClass:"",dbParameterType:""};switch(o){case"MySQL":case"MariaDB":u.dbParameterType="MySqlDbType",u.dbParameterClass="MySqlParameter";break;case"SQLite":u.dbParameterType="SqliteType",u.dbParameterClass="SqliteParameter";break;case"Oracle":u.dbParameterType="OracleDbType",u.dbParameterClass="OracleParameter";break;case"SQLServer":u.dbParameterType="SqlDbType",u.dbParameterClass="SqlParameter";break;case"PostgreSQL":u.dbParameterType="NpgsqlDbType",u.dbParameterClass="NpgsqlParameter"}p.push("\t\t/// <summary>"),p.push("\t\t/// 查询"),p.push("\t\t/// </summary>"),p.push('\t\t/// <param name="whereSql">SQL条件，可选</param>'),p.push("\t\t/// <returns>返回数据集</returns>"),p.push("\t\tpublic DataSet Query(string whereSql = null)"),p.push("\t\t{"),p.push(`\t\t\tvar sql = "select * from ${i}";`),p.push("\t\t\tif (!string.IsNullOrWhiteSpace(whereSql))"),p.push("\t\t\t{"),p.push('\t\t\t\tsql += " where " + whereSql;'),p.push("\t\t\t}"),p.push(""),p.push(`\t\t\tvar ds = ${u.dbQuery}(sql);`),p.push("\t\t\treturn ds;"),p.push("\t\t}"),p.push(""),p.push("\t\t/// <summary>"),p.push("\t\t/// 删除"),p.push("\t\t/// </summary>"),p.push('\t\t/// <param name="whereSql">SQL条件</param>'),p.push("\t\t/// <returns>返回受影响行数</returns>"),p.push("\t\tpublic int Delete(string whereSql)"),p.push("\t\t{"),p.push(`\t\t\tvar sql = "delete from ${i} where " + whereSql;`),p.push(`\t\t\tvar num = ${u.dbExecute}(sql);`),p.push("\t\t\treturn num;"),p.push("\t\t}"),p.push(""),p.push("\t\t/// <summary>"),p.push("\t\t/// 新增"),p.push("\t\t/// </summary>"),p.push('\t\t/// <param name="model">新增实体对象</param>'),p.push("\t\t/// <returns>返回受影响行数</returns>"),p.push(`\t\tpublic int Add(${u.namespaceDomain}.${d} model)`),p.push("\t\t{"),p.push(`\t\t\tvar sql = @"insert into ${i} `),p.push(`\t\t\t\t\t\t(${u.fields.join(", ")}) values `),p.push(`\t\t\t\t\t\t(${u.pprefix+u.fields.join(", "+u.pprefix)})";`),p.push(""),p.push(`\t\t\t${u.dbParameterClass}[] parameters = {`),s.forEach((e=>{let a="";e.DataType="Oracle"==o?e.DataType.toUpperCase():e.DataType.toLowerCase();let t,r=n.csharp[o][e.DataType];r&&(a=r[1]),"Oracle"==o&&"Decimal"==a&&0==e.DataScale&&(a="Int32"),t=isNaN(parseInt(e.DataLength))||"Oracle"==o&&"lob"==a.slice(-3)?"":`, ${e.DataLength}`;let l=`new ${u.dbParameterClass}("${u.pprefix+e.ColumnName}", ${u.dbParameterType}.${a}${t})`;p.push(`\t\t\t\t${l},`)})),p.push("\t\t\t};"),p.push("");for(let e=0;e<s.length;e++){let a=s[e];p.push(`\t\t\tparameters[${e}].Value = model.${a.ColumnName};`)}p.push(""),p.push(`\t\t\tint num = ${u.insert}(sql, parameters);`),p.push("\t\t\treturn num;"),p.push("\t\t}"),p.push(""),p.push("\t\t/// <summary>"),p.push("\t\t/// 修改"),p.push("\t\t/// </summary>"),p.push('\t\t/// <param name="model">修改实体对象</param>'),p.push("\t\t/// <returns>返回受影响行数</returns>"),p.push(`\t\tpublic int Update(${u.namespaceDomain}.${d} model)`),p.push("\t\t{"),p.push(`\t\t\tvar sql = @"update ${i} set `);let m=[],b=[];s.forEach((e=>{let a=`${u.pprefix+e.ColumnName}=${u.pprefix+e.ColumnName}`;e.PrimaryKey>0?b.push(a):m.push(a)})),p.push(`\t\t\t\t\t\t${m.join(", ")} `),p.push(`\t\t\t\t\t\twhere ${b.join(" and ")}";`),p.push(""),p.push(`\t\t\t${u.dbParameterClass}[] parameters = {`),s.forEach((e=>{let a="";e.DataType="Oracle"==o?e.DataType.toUpperCase():e.DataType.toLowerCase();let t,r=n.csharp[o][e.DataType];r&&(a=r[1]),"Oracle"==o&&"Decimal"==a&&0==e.DataScale&&(a="Int32"),t=isNaN(parseInt(e.DataLength))||"Oracle"==o&&"lob"==a.slice(-3)?"":`, ${e.DataLength}`;let l=`new ${u.dbParameterClass}("${u.pprefix+e.ColumnName}", ${u.dbParameterType}.${a}${t})`;p.push(`\t\t\t\t${l},`)})),p.push("\t\t\t};"),p.push("");for(let e=0;e<s.length;e++){let a=s[e];p.push(`\t\t\tparameters[${e}].Value = model.${a.ColumnName};`)}switch(p.push(""),p.push(`\t\t\tint num = ${u.dbExecute}(sql, parameters);`),p.push("\t\t\treturn num;"),p.push("\t\t}"),p.push(""),p.push("\t\t/// <summary>"),p.push("\t\t/// 分页查询"),p.push("\t\t/// </summary>"),p.push('\t\t/// <param name="pageNumber">页码</param>'),p.push('\t\t/// <param name="pageSize">页量</param>'),p.push('\t\t/// <param name="whereSql">SQL条件</param>'),p.push('\t\t/// <param name="sortOrder">排序</param>'),p.push('\t\t/// <param name="total">返回总条数</param>'),p.push("\t\t/// <returns>返回数据表及总条数</returns>"),p.push("\t\tpublic DataTable Query(int pageNumber, int pageSize, string whereSql, string sortOrder, out int total)"),p.push("\t\t{"),p.push('\t\t\tsortOrder = string.IsNullOrWhiteSpace(sortOrder) ? "" : "ORDER BY " + sortOrder;'),"Oracle"!=o&&(p.push('\t\t\twhereSql = string.IsNullOrWhiteSpace(whereSql) ? "" : "WHERE " + whereSql;'),p.push("")),o){case"MySQL":case"MariaDB":p.push(`\t\t\tvar sql = $"SELECT * FROM ${i} {whereSql} {sortOrder} LIMIT {(pageNumber - 1) * pageSize}, {pageSize}";`),p.push(`\t\t\tsql += $";SELECT COUNT(1) AS TOTAL FROM ${i} {whereSql}";`);break;case"SQLite":case"PostgreSQL":p.push(`\t\t\tvar sql = $"SELECT * FROM ${i} {whereSql} {sortOrder} LIMIT {pageSize} OFFSET {(pageNumber - 1) * pageSize}";`),p.push(`\t\t\tsql += $";SELECT COUNT(1) AS TOTAL FROM ${i} {whereSql}";`);break;case"Oracle":p.push('\t\t\tvar ws1 = string.IsNullOrWhiteSpace(whereSql) ? "" : whereSql + " AND ";'),p.push('\t\t\tvar ws2 = string.IsNullOrWhiteSpace(whereSql) ? "" : "WHERE " + whereSql;'),p.push(""),p.push(`\t\t\tvar sql = $"SELECT * FROM ( SELECT ROWNUM AS rowno, a.* FROM ${i} a WHERE {ws1} ROWNUM <= {pageNumber * pageSize} {sortOrder} ) x WHERE x.rowno >= {(pageNumber - 1) * pageSize}";`),p.push(`\t\t\tsql += $";SELECT COUNT(1) AS TOTAL FROM ${i} {ws2}";`);break;case"SQLServer":p.push(`\t\t\tvar sql = $"SELECT TOP {rows} * FROM ( SELECT ROW_NUMBER() OVER( {sortOrder} ) AS numid, * FROM ${i} {whereSql} ) x WHERE numid > {(pageNumber - 1) * pageSize}";`),p.push(`\t\t\tsql += $";SELECT COUNT(1) AS TOTAL FROM ${i} {whereSql}";`)}p.push(""),p.push(`\t\t\tvar ds = ${u.dbQuery}(sql);`),p.push("\t\t\ttotal = Convert.ToInt32(ds.Table[1].Rows[0][0].ToString());"),p.push("\t\t\treturn ds.Table[0];"),p.push("\t\t}"),p.push(""),p.push("\t}"),p.push("}"),e.push({name:`${d}.cs`,content:p.join("\r\n"),path:a})})),console.debug("fnout",e),e}},{language:"java",name:"Model",fn:()=>{let e=[],a="Netnr.Blog.Domain";return window.ndkGenerateCode.ref.echoTableColumn(((t,n,r,o,l,i,s,c)=>{c.push("import javax.persistence.*;"),e.push({name:`${s}.cs`,content:c.join("\r\n"),path:a})})),console.debug("fnout",e),e}}]};i.ref.csharp.MariaDB=i.ref.csharp.MySQL,Object.assign(i.ref.csharp.SQLite,i.ref.csharp.SQLServer),i.fns.forEach((e=>{e.code=e.fn.toString().replace(/(_ndkFunction__WEBPACK_IMPORTED_MODULE_\d+__).ndkFunction./gm,"ndkFunction.").replace(/(_ndkI18n__WEBPACK_IMPORTED_MODULE_\d+__).ndkI18n./gm,"ndkI18n.").replace(/(_ndkStep__WEBPACK_IMPORTED_MODULE_\d+__).ndkStep./gm,"ndkStep.").replace(/(_ndkVary__WEBPACK_IMPORTED_MODULE_\d+__).ndkVary./gm,"ndkVary.")}))},408:(e,a,t)=>{t.d(a,{w:()=>i});var n=t(769),r=t(644),o=t(33),l=t(821),i={loopTable:(e,a,t,s,c,d)=>{let p=t[s].TableName,u=t[s].SchemaName||"",m=["SQLServer","PostgreSQL"].includes(e.type)?[u,p].filter((e=>""!=e)).join("."):p;r.R.output(`${m} ${s+1}/${t.length}`),o.N.reqTableDDL(e,a,u,p).then((o=>{var p=o.data,u="-- --------------------";l.p.generateDDL.push(`${u}`),l.p.generateDDL.push(`-- ${m}`),l.p.generateDDL.push(`${u}`),l.p.generateDDL.push(p),l.p.generateDDL.push(""),++s<t.length?i.loopTable(e,a,t,s,c,d):(r.R.output(n.t.lg.done),c())})).catch((e=>{d(e.msg)}))},reqDDL:(e,a,t)=>new Promise(((o,s)=>{switch(l.p.generateDDL=[],e.type){case"SQLite":l.p.generateDDL.push(`-- ${e.type}`),l.p.generateDDL.push(`-- ${e.conn}`),l.p.generateDDL.push(`-- Database: ${a}`),l.p.generateDDL.push(`-- Date: ${r.R.now()}`),l.p.generateDDL.push(""),l.p.generateDDL.push("PRAGMA foreign_keys = false;"),l.p.generateDDL.push(""),i.loopTable(e,a,t,0,(function(){l.p.generateDDL.push("PRAGMA foreign_keys = true;"),o(l.p.generateDDL.join("\r\n"))}),(function(e){s(e)}));break;case"MySQL":case"MariaDB":l.p.generateDDL.push(`-- ${e.type}`),l.p.generateDDL.push(`-- Database: ${a}`),l.p.generateDDL.push(`-- Date: ${r.R.now()}`),l.p.generateDDL.push(""),l.p.generateDDL.push("SET FOREIGN_KEY_CHECKS = 0;"),l.p.generateDDL.push(""),i.loopTable(e,a,t,0,(function(){l.p.generateDDL.push("SET FOREIGN_KEY_CHECKS = 1;"),o(l.p.generateDDL.join("\r\n"))}),(function(e){s(e)}));break;case"Oracle":case"SQLServer":case"PostgreSQL":l.p.generateDDL.push(`-- ${e.type}`),l.p.generateDDL.push(`-- Database: ${a}`),l.p.generateDDL.push(`-- Date: ${r.R.now()}`),l.p.generateDDL.push(""),i.loopTable(e,a,t,0,(function(){o(l.p.generateDDL.join("\r\n"))}),(function(e){s(e)}));break;default:s(n.t.lg.unsupported)}}))}},268:(e,a,t)=>{t.d(a,{A:()=>d});var n=t(408),r=t(644),o=t(769),l=t(372),i=t(178),s=t(821),c=t(33),d={sqlDataType:(e,a)=>{var t=(a.ColumnComment||"").trim().replace(/[\r\n]/g,"").replace(/\s+/g," "),n=a.DataLength>0?a.DataLength:999,o=t.replaceAll("'","''").substring(0,n),l={category:"string",comment:t,defaultValue:"''",mockValue:`'${o}'`};switch(a.DataType=a.DataType.toLowerCase(),a.DataType){case"int":case"bigint":case"tinyint":case"smallint":case"mediumint":case"decimal":case"float":case"double":case"number":case"int2":case"int4":case"int8":case"integer":case"serial":case"float4":case"float8":case"real":case"numeric":case"money":Object.assign(l,{category:"number",defaultValue:0,mockValue:0});break;case"date":case"datetime":case"timestamp":case"time":case"year":Object.assign(l,{category:"date",mockValue:`'${r.R.formatDateTime(a.DataType)}'`});break;case"bool":case"boolean":Object.assign(l,{category:"boolean",defaultValue:"false",mockValue:"false"})}switch(e){case"SQLite":["nvarchar","varchar","text"].includes(a.DataType)&&a.PrimaryKey>0&&(l.mockValue="hex(randomblob(16))");break;case"MySQL":case"MariaDB":["varchar"].includes(a.DataType)&&a.DataLength>=36&&a.PrimaryKey>0&&(l.mockValue="uuid()");break;case"Oracle":["varchar","varchar2"].includes(a.DataType)&&a.DataLength>=36&&a.PrimaryKey>0&&(l.mockValue="sys_guid()");break;case"SQLServer":["varchar","nvarchar"].includes(a.DataType)&&a.DataLength>=36&&a.PrimaryKey>0?l.mockValue="newid()":["nvarchar","nchar","ntext"].includes(a.DataType)&&(l.mockValue=`N'${o}'`);break;case"PostgreSQL":["varchar","varchar2"].includes(a.DataType)&&a.DataLength>=36&&a.PrimaryKey>0&&(l.mockValue="uuid_generate_v4()")}return l},sqlQuote:(e,a,t=!1)=>{if(0==t&&0==s.p.parameterConfig.buildSqlWithQuote.value)return a;switch(e){case"SQLite":case"SQLServer":return`[${a}]`;case"MySQL":case"MariaDB":return"`"+a+"`";case"Oracle":case"PostgreSQL":return`"${a}"`;default:return a}},sqlFullTableName:(e,a)=>{var t=[d.sqlQuote(e.cobj.type,e.databaseName)];return["MySQL","MariaDB"].includes(e.cobj.type)||null==a.SchemaName||""==a.SchemaName||t.push(d.sqlQuote(e.cobj.type,a.SchemaName)),t.push(d.sqlQuote(e.cobj.type,a.TableName)),t.join(".")},buildNewTabSql:(e,a)=>{var t=s.p.gridOpsTable.api.getSelectedRows();0==t.length&&null!=e&&(t=[e]),0!=t.length&&i.W.tabBuild(r.R.random(),s.p.iconSvg("table",t[0].TableName),"sql").then((e=>{s.p.domTabGroup2.show(e);var p=i.W.tabKeys[e];p.editor.setValue(`-- ${o.t.lg.generatingScript}`);var u=l.U.cpGet(1);l.U.cpSet(e,u.cobj,u.databaseName,t[0].TableName),l.U.cpInfo(e),"DDL"==a?n.w.reqDDL(u.cobj,u.databaseName,t).then((e=>{p.editor.setValue(e)})).catch((e=>{p.editor.setValue(`-- ${e}`)})):c.N.reqColumn(u.cobj,u.databaseName,t.map((e=>e.TableName)).join(","),!0).then((n=>{var o=l.U.cpGet(e),i=[];r.R.groupBy(n,(e=>e.TableName)).forEach((e=>{var r=t.find((a=>a.TableName==e)),l=n.filter((a=>a.TableName==e)),s=d[`build${a}Sql`](o,r,l);i.push(s)})),i=1==i.length?ndkEditor.formatterSQL(i[0],u.cobj.type):i.join(";\r\n"),p.editor.setValue(i)}))}))},buildSelectSql:(e,a,t)=>{var n=d.sqlFullTableName(e,a),r=[];if(t)return t.forEach((a=>r.push(d.sqlQuote(e.cobj.type,a.ColumnName)))),`SELECT ${r.join(", ")} FROM ${n}`;var o=s.p.parameterConfig.selectDataLimit.value;switch(e.cobj.type){case"SQLServer":return`SELECT TOP ${o} * FROM ${n}`;case"MySQL":case"MariaDB":return`SELECT * FROM ${n} LIMIT 0,${o}`;case"Oracle":return`SELECT * FROM ${n} WHERE ROWNUM <= ${o}`;case"SQLite":case"PostgreSQL":return`SELECT * FROM ${n} LIMIT ${o} OFFSET 0`}},buildInsertSql:(e,a,t)=>{var n=d.sqlFullTableName(e,a),r=[],o=[],l=s.p.parameterConfig.buildSqlWithComment.value;return t.forEach((a=>{r.push(d.sqlQuote(e.cobj.type,a.ColumnName));var t=d.sqlDataType(e.cobj.type,a);if(l){var n=`-- ${a.ColumnName}(${a.PrimaryKey>0?s.p.emoji.key+a.PrimaryKey+", ":""}${a.ColumnType}, ${1==a.IsNullable?"null":"not null"}) ${t.comment}`;o.push(`\n  ${n}\n  ${t.mockValue}`)}else o.push(`${t.mockValue}`)})),`INSERT INTO ${n}(${r.join(", ")}) VALUES (${o.join(", ")})`},buildUpdateSql:(e,a,t,n)=>{var r=d.sqlFullTableName(e,a),o=[],l=[],i=s.p.parameterConfig.buildSqlWithComment.value;t.forEach((a=>{var t,n=d.sqlQuote(e.cobj.type,a.ColumnName),r=d.sqlDataType(e.cobj.type,a);i?t=`\n  ${`-- ${a.ColumnName}(${a.PrimaryKey>0?s.p.emoji.key+a.PrimaryKey+", ":""}${a.ColumnType}, ${1==a.IsNullable?"null":"not null"}) ${r.comment}`}\n  ${n} = ${r.defaultValue}`:t=`${n} = ${r.defaultValue}`;a.PrimaryKey>0?l.push(t):o.push(t)})),0==l.length&&(l.push(o[0]),o=o.splice(0,1));var c=i?"\nWHERE":"WHERE";return`UPDATE ${r} SET ${o.join(", ")} ${c} ${l.join(" AND ")}`},buildDeleteSql:(e,a,t,n)=>{var r=d.sqlFullTableName(e,a),o=[],l=[];return t.forEach((a=>{var t=`${d.sqlQuote(e.cobj.type,a.ColumnName)} = ${d.sqlDataType(e.cobj.type,a).defaultValue}`;0==o.length&&o.push(t),a.PrimaryKey>0&&l.push(t)})),0==l.length&&(l=o),`DELETE FROM ${r} WHERE ${l.join(" AND ")}`},buildTruncateSql:(e,a)=>`TRUNCATE TABLE ${d.sqlFullTableName(e,a)}`,buildDropSql:(e,a)=>`DROP TABLE ${d.sqlFullTableName(e,a)}`,dataFullTableName:(e,a)=>{var t,n,r=a.BaseTableName;switch(e.cobj.type){case"SQLite":t=a.BaseCatalogName;break;case"MySQL":case"MariaDB":case"Oracle":t=a.BaseSchemaName;break;case"SQLServer":case"PostgreSQL":t=a.BaseCatalogName,n=a.BaseSchemaName}var o=[d.sqlQuote(e.cobj.type,t)];return null!=n&&o.push(d.sqlQuote(e.cobj.type,n)),o.push(d.sqlQuote(e.cobj.type,r)),console.debug(o),o.join(".")},dataNewSql:(e,a)=>{var t,n=agg.getContainer(e),s=n.getAttribute("data-key"),c=i.W.tabKeys[s];if(c.esdata.Item2)for(var p=0;p<c.grids.length;p++){if(c.grids[p].domGridExecuteSql==n){t=c.esdata.Item2[Object.keys(c.esdata.Item2)[p]];break}}if(t){var u=l.U.cpGet(s),m=e.api.getSelectedRows();if(m.length){var b=d[`data${a}Sql`](u,m,t);r.R.clipboard(b).then((()=>{r.R.output("Done!")}))}else r.R.output(o.t.lg.selectDataRows)}else r.R.output(o.t.lg.unsupported)},dataInsertSql:(e,a,t)=>{var n=d.dataFullTableName(e,t[0]),r=[],o={};t.forEach((a=>{var t=a.DataTypeName;null==t&&(t=a.DataType.split(",")[0].split(".")[1].toLowerCase());var n={DataType:null==a.DataTypeName?t.replace(/\d+/g,""):a.DataTypeName,DataLength:a.ColumnSize,AutoIncrement:a.IsAutoIncrement,PrimaryKey:a.IsKey?1:0},r=d.sqlDataType(e.cobj.type,n);o[a.ColumnName]={sdt:r,column:n}}));var l=s.p.parameterConfig.dataSqlBulkInsert.value,i=[],c=[];(l<=1||"Oracle"==e.cobj.type)&&(l=1);var p=s.p.parameterConfig.dataSqlWithAutoIncrement.value;if(a.forEach((a=>{i=[];var t=[];for(var s in a){var u=d.sqlQuote(e.cobj.type,s),m=a[s];const{sdt:n,column:r}=o[s];0==p&&r.AutoIncrement||(i.push(u),null==m?t.push("null"):"number"==typeof m||["number","boolean"].includes(n.category)?t.push(m):"SQLServer"==e.cobj.type&&n.mockValue.startsWith("N'")?t.push(`N'${m.replaceAll("'","''")}'`):t.push(`'${m.replaceAll("'","''")}'`))}if(c.push(t),c.length>=l){var b=1==c.length?"":"\n";r.push(`INSERT INTO ${n} (${i.join(", ")}) VALUES ${b}${c.map((e=>`(${e.join(", ")})`)).join(",\n")}`),c=[]}})),c.length>0){var u=1==c.length?"":"\n";r.push(`INSERT INTO ${n} (${i.join(", ")}) VALUES ${u}${c.map((e=>`(${e.join(", ")})`)).join(",\n")}`)}return r.join(";\n")},dataUpdateSql:(e,a,t)=>{var n=d.dataFullTableName(e,t[0]),r=[],o={};return t.forEach((a=>{var t=a.DataTypeName;null==t&&(t=a.DataType.split(",")[0].split(".")[1].toLowerCase());var n={DataType:null==a.DataTypeName?t.replace(/\d+/g,""):a.DataTypeName,DataLength:a.ColumnSize,AutoIncrement:a.IsAutoIncrement,PrimaryKey:a.IsKey?1:0},r=d.sqlDataType(e.cobj.type,n);o[a.ColumnName]={sdt:r,column:n}})),a.forEach((a=>{var t=[],l=[];for(var i in a){var s,c=d.sqlQuote(e.cobj.type,i),p=a[i];const{sdt:n,column:r}=o[i];s=null==p?`${c} = null`:"number"==typeof p||["number","boolean"].includes(n.category)?`${c} = ${p}`:"SQLServer"==e.cobj.type&&n.mockValue.startsWith("N'")?`${c} = N'${p.replaceAll("'","''")}'`:`${c} = '${p.replaceAll("'","''")}'`,r.PrimaryKey>0?l.push(s):t.push(s)}0==l.length&&(l=t),r.push(`UPDATE ${n} SET ${t.join(", ")} WHERE ${l.join(" AND ")}`)})),r.join(";\n")},dataDeleteSql:(e,a,t)=>{var n=d.dataFullTableName(e,t[0]),r=[],o={};return t.forEach((a=>{var t=a.DataTypeName;null==t&&(t=a.DataType.split(",")[0].split(".")[1].toLowerCase());var n={DataType:null==a.DataTypeName?t.replace(/\d+/g,""):a.DataTypeName,DataLength:a.ColumnSize,PrimaryKey:a.IsKey?1:0},r=d.sqlDataType(e.cobj.type,n);o[a.ColumnName]={sdt:r,column:n}})),a.forEach((a=>{var t=[],l=[];for(var i in a){var s,c=d.sqlQuote(e.cobj.type,i),p=a[i];const{sdt:n,column:r}=o[i];s=null==p?`${c} = null`:"number"==typeof p||["number","boolean"].includes(n.category)?`${c} = ${p}`:"SQLServer"==e.cobj.type&&n.mockValue.startsWith("N'")?`${c} = 'N${p.replaceAll("'","''")}'`:`${c} = '${p.replaceAll("'","''")}'`,r.PrimaryKey>0?l.push(s):t.push(s)}0==l.length&&(l=t),r.push(`DELETE FROM ${n} WHERE ${l.join(" AND ")}`)})),r.join(";\n")}}},769:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{t:()=>ndkI18n});var ndkI18n={language:"auto",resLanguage:[{key:"zh-CN",icon:"flag"},{key:"en-US",icon:"flag"},{key:"auto",icon:"flag"}],languageGet:()=>"auto"==ndkI18n.language?navigator.language in ndkI18n.languages?navigator.language:"en-US":ndkI18n.language,get:e=>ndkI18n.languages[ndkI18n.languageGet()][e]||e,lg:{},languages:{"zh-CN":{menu:"菜单",setting:"设置",quick:"快捷",note:"笔记",link:"链接",search:"搜索",export:"导出",import:"导入",exportData:"导出数据",importData:"导入数据",delete:"删除",refresh:"刷新",confirm:"确认",close:"关闭",cancel:"取消",save:"保存",default:"默认",current:"当前",about:"关于",version:"版本",notify:"通知",fullScreenSwitch:"全屏切换",wrapSwitch:"换行切换",createTime:"创建时间",updateTime:"更新时间",group:"分组",expandAll:"全部展开",collapseAll:"全部收起",generatingScript:"正在生成脚本",pleaseChoose:"请选择",run:"运行",debug:"调试",done:"已完成!",reloadDone:"刷新页面才能看到效果!",success:"成功!",contentNotEmpty:"内容不能为空!",selectAnItem:"请选择项!",selectConn:"请选择连接!",selectColumn:"请选择列!",selectDataRows:"请选择数据行!",inProgress:"正在进行中...",onlyTextFile:"只能是文本文件!",unsupported:"不支持!",copiedToClipboard:"已复制到剪贴板!",themeKey_light:"主题-浅色",themeKey_dark:"主题-深色",themeKey_auto:"主题-自动",languageKey_zh_CN:"简体中文",languageKey_en_US:"English",languageKey_auto:"语言-自动",setTitle:"设置",setServerTitle:"服务设置",setServerPlaceholder:"服务地址",setParameterConfigTitle:"参数设置",parameterKey_autoFilterDatabaseNumber:"数据库名超过自动过滤",parameterKey_selectDataLimit:"查询数据默认限制行数",parameterKey_buildSqlWithQuote:"生成 SQL 带符号",parameterKey_buildSqlWithQuote_true:"带符号",parameterKey_buildSqlWithQuote_false:"不带",parameterKey_buildSqlWithComment:"生成 SQL 带注释",parameterKey_buildSqlWithComment_true:"带注释",parameterKey_buildSqlWithComment_false:"不带",parameterKey_dataSqlBulkInsert:"数据 SQL 批量插入",parameterKey_dataSqlWithAutoIncrement:"数据 SQL 带自增列",parameterKey_dataSqlWithAutoIncrement_true:"带自增列",parameterKey_dataSqlWithAutoIncrement_false:"不带自增列",parameterKey_editorFontSize:"编辑器字体大小",parameterKey_editorLineNumbers:"编辑器行号",parameterKey_editorLineNumbers_on:"显示",parameterKey_editorLineNumbers_off:"不显示",parameterKey_editorWordWrap:"编辑器换行",parameterKey_editorWordWrap_on:"自动换行",parameterKey_editorWordWrap_off:"不换行",parameterKey_gridDataShowLength:"表格数据显示截断",parameterKey_maxSqlHistory:"SQL 历史记录",parameterKey_readFileEncoding:"读取文件编码",parameterKey_readFileEncoding_GBK:"GBK",parameterKey_readFileEncoding_utf_8:"utf-8",setExportTitle:"配置导入导出",setExportSave:"导出配置",setExportSaveClipboard:"导出配置（剪贴板）",setImportPlaceholder:"拖拽配置文件到此处 或 粘贴配置文件内容",setImportSave:"导入配置",setImportSaveClipboard:"导入配置（剪贴板）",storageKey_conns:"连接",storageKey_steps:"步骤",storageKey_errors:"错误",storageKey_notes:"笔记",storageKey_historys:"历史",dbEnvInfo:"环境信息",dbParamsInfo:"参数信息",package:"包",generateCode:"生成代码",generateFaker:"生成假数据",tab1Conns:"连接",tab1Database:"库",tab1Table:"表",tab1Column:"列",connAlias:"连接名",connEnv:"环境",connGroup:"分组",connType:"类型",connOrder:"排序",connConnection:"连接字符串",connControl:"操作",newQuery:"新建查询",openConn:"打开连接",createConn:"新建连接",demoConn:"示例连接",editConn:"编辑连接",copyConn:"复制连接",deleteConn:"删除连接",confirmDelete:"确认删除",databaseInfo:"数据库信息",dbName:"库名",dbOwner:"所有者",dbSpace:"表空间",dbCharSet:"字符集",dbCollate:"排序规则",dbDataSize:"数据大小",dbLogSize:"日志大小",dbIndexSize:"索引大小",dbDataPath:"库路径",dbLogPath:"日志路径",openDatabase:"打开库",executeSqlFile:"执行 SQL 文件",tableName:"表名",tableComment:"表注释",tableRows:"行数",tableDataSize:"数据大小",tableIndexSize:"索引大小",tableCharSet:"字符集",tableCollate:"排序规则",schemaName:"模式",tableOwner:"所属",tableSpace:"空间",tableCatagory:"类别",tableDesign:"表设计",tableData:"表数据",tableGenerateSQL:"生成 SQL",columnName:"列名",columnComment:"列注释",columnTypeLength:"类型及长度",columnType:"类型",columnLength:"长度",columnScale:"精度",columnOrder:"列序",columnPrimary:"主键",columnAutoIncrement:"自增",columnDefault:"默认值",columnIsNullable:"必填",sqlButtonExecute:"执行选中或全部脚本",sqlButtonFormat:"格式化脚本",sqlButtonNote:"笔记",sqlButtonHistory:"执行 SQL 历史记录",dataGenerateSQL:"复制为 SQL"},"en-US":{menu:"Menu",setting:"Setting",quick:"Quick",note:"Note",link:"Link",search:"Search",export:"Export",import:"Import",exportData:"Export Data",importData:"Import Data",delete:"Delete",refresh:"Refresh",confirm:"Confirm",close:"Close",cancel:"Cancel",save:"Save",default:"Default",current:"Current",about:"About",version:"Version",notify:"Notify",fullScreenSwitch:"Full Screen Switch",wrapSwitch:"Wrap Switch",createTime:"Create Time",updateTime:"Update Time",group:"Group",expandAll:"Expand All",collapseAll:"Collapse All",generatingScript:"Generating Script",pleaseChoose:"Please Choose",run:"Run",debug:"Debug",done:"Done!",reloadDone:"Reload page to see the effect!",success:"Success!",contentNotEmpty:"Content can not be empty!",selectAnItem:"Select an item!",selectConn:"Please select connection!",selectColumn:"Please select column!",selectDataRows:"Select data rows!",inProgress:"In progress...",onlyTextFile:"Only text file!",unsupported:"Unsupported!",copiedToClipboard:"Copied to clipboard!",themeKey_light:"Theme Light",themeKey_dark:"Theme Dark",themeKey_auto:"Theme Auto",languageKey_zh_CN:"简体中文",languageKey_en_US:"English",languageKey_auto:"Language Auto",setTitle:"Setting",setServerTitle:"Server setting",setServerPlaceholder:"Server host",setParameterConfigTitle:"Parameter configuration",parameterKey_autoFilterDatabaseNumber:"Auto filter database number",parameterKey_selectDataLimit:"Select data default limit",parameterKey_buildSqlWithQuote:"Build SQL with quote",parameterKey_buildSqlWithQuote_true:"With quote",parameterKey_buildSqlWithQuote_false:"Without quote",parameterKey_buildSqlWithComment:"Build SQL with comment",parameterKey_buildSqlWithComment_true:"With comment",parameterKey_buildSqlWithComment_false:"Without comment",parameterKey_dataSqlBulkInsert:"Data SQL bulk insert",parameterKey_dataSqlWithAutoIncrement:"Data SQL with auto increment",parameterKey_dataSqlWithAutoIncrement_true:"With auto increment",parameterKey_dataSqlWithAutoIncrement_false:"Without auto increment",parameterKey_editorFontSize:"Editor font size",parameterKey_editorLineNumbers:"Editor line numbers",parameterKey_editorLineNumbers_on:"Show",parameterKey_editorLineNumbers_off:"Hide",parameterKey_editorWordWrap:"Editor word wrap",parameterKey_editorWordWrap_on:"Auto wrap",parameterKey_editorWordWrap_off:"No wrap",parameterKey_gridDataShowLength:"Grid data show length",parameterKey_maxSqlHistory:"Max SQL history",parameterKey_readFileEncoding:"Read file encoding",parameterKey_readFileEncoding_GBK:"GBK",parameterKey_readFileEncoding_utf_8:"utf-8",setExportTitle:"Configuration import and export",setExportSave:"Export configuration",setExportSaveClipboard:"Export configuration (clipboard)",setImportPlaceholder:"Paste configuration content",setImportSave:"Import configuration",setImportSaveClipboard:"Import configuration (clipboard)",storageKey_conns:"conns",storageKey_steps:"steps",storageKey_errors:"errors",storageKey_notes:"notes",storageKey_historys:"historys",dbEnvInfo:"Env Info",dbParamsInfo:"Params Info",package:"Package",generateCode:"Generate Code",generateFaker:"Generate Faker",tab1Conns:"Connection",tab1Database:"Database",tab1Table:"Table",tab1Column:"Column",connAlias:"Alias",connEnv:"Env",connGroup:"Group",connType:"Type",connOrder:"Order",connConnection:"Connection String",connControl:"Control",newQuery:"New Query",openConn:"Open Conn",createConn:"Create Conn",demoConn:"Demo Conn",editConn:"Edit Conn",copyConn:"Copy Conn",deleteConn:"Delete Conn",confirmDelete:"Confirm Delete",databaseInfo:"Database Info",dbName:"Database Name",dbOwner:"Owner",dbSpace:"Space",dbCharSet:"CharSet",dbCollate:"Collate",dbDataSize:"Data Size",dbLogSize:"Log Size",dbIndexSize:"Index Size",dbDataPath:"Data Path",dbLogPath:"Log Path",openDatabase:"Open Database",executeSqlFile:"Execute SQL File",tableName:"Table Name",tableComment:"Table Comment",tableRows:"Rows",tableDataSize:"Data Size",tableIndexSize:"Index Size",tableCharSet:"CharSet",tableCollate:"Collate",schemaName:"Schema",tableOwner:"Owner",tableSpace:"Space",tableCatagory:"Catagory",tableDesign:"Table Design",tableData:"Table Data",tableGenerateSQL:"Generate SQL",columnName:"Column Name",columnComment:"Column Comment",columnTypeLength:"Type and Length",columnType:"Type",columnLength:"Length",columnScale:"Scale",columnOrder:"Order",columnPrimary:"Primary Key",columnAutoIncrement:"Auto Increment",columnDefault:"Default",columnIsNullable:"Required",sqlButtonExecute:"Execute Selected or All Script",sqlButtonFormat:"Format Script",sqlButtonNote:"Note",sqlButtonHistory:"Execute SQL History",dataGenerateSQL:"Copy as SQL"}}};let elang=[];for(const e in ndkI18n.languages["zh-CN"])elang.push(`get ${e}() { return ndkI18n.get('${e}') }`);eval(`ndkI18n.lg = {${elang.join(",")}}`)},384:(e,a,t)=>{t.d(a,{A:()=>n});var n={SQLite:[{group:"rely",name:"db-env-info",sql:"SELECT 'Version' col, sqlite_version() val UNION ALL SELECT 'DateTime' col, datetime() val UNION ALL SELECT 'IgnoreCase' col, 'a' = 'A' val;\nPRAGMA encoding",remark:"数据库环境信息"},{group:"default",name:"database-name",sql:"PRAGMA database_list",remark:"数据库名称"},{group:"default",name:"uuid",sql:"select hex(randomblob(16))",remark:"模拟 UUID"},{group:"default",name:"vacuum",sql:"VACUUM",remark:"磁盘空间释放"},{group:"default",name:"attach",sql:"ATTACH DATABASE '/tmp/dbname.db' AS main2",remark:"附加数据库"},{group:"default",name:"info",sql:"select sqlite_version(); -- 版本\nPRAGMA encoding; -- 编码\n\nselect * from main.sqlite_master; -- 所有表信息、DDL\nPRAGMA table_info('SysButton'); -- 表信息\nselect cid, name, type, [notnull], quote(dflt_value) as dflt_value, pk from pragma_table_info('SysUser'); -- 表信息\n\nselect m.*, p.cid, p.name as colname, p.type as coltype, p.[notnull], quote(p.dflt_value) as dflt_value, p.pk\nfrom main.sqlite_master m left join pragma_table_info(m.name) p ON m.name<>p.name; -- 所有表信息\n",remark:"信息"},{group:"default",name:"daetime-function",sql:"select '日期时间' as name, datetime() as value\nunion all\nselect '日期', date()\nunion all\nselect '时间', time()\nunion all\nselect '+2 天', date('now','+2 day')\nunion all\nselect '-2 年', date('now','-2 year')\nunion all\nselect '格式化（yyyy MM dd）', strftime('%Y %m %d','now')\nunion all\nselect '格式化（HH mm ss fff)', strftime('%H %M %S %s','now')",remark:"时间函数"},{group:"default",name:"empty",sql:""}]};n.MySQL=n.MariaDB=[{group:"rely",name:"db-env-info",sql:"SELECT 'Name' col, @@version_comment val UNION ALL SELECT 'Version' col, @@version val UNION ALL SELECT 'Compile' col, @@version_compile_machine val UNION ALL SELECT 'DirInstall' col, @@basedir val UNION ALL SELECT 'DirData' col, @@datadir val UNION ALL SELECT 'DirTemp' col, @@tmpdir val UNION ALL SELECT 'Engine' col, @@default_storage_engine val UNION ALL SELECT 'CharSet' col, @@collation_server val UNION ALL SELECT 'TimeZone' col, @@system_time_zone val UNION ALL SELECT 'MaxConn' col, @@max_connections val UNION ALL SELECT 'CurrConn' col, count( 1 ) val FROM information_schema.PROCESSLIST WHERE USER != 'event_scheduler' UNION ALL SELECT 'DateTime' col, now() AS val UNION ALL SELECT 'TimeOut' col, @@wait_timeout AS val UNION ALL SELECT 'IgnoreCase' col, 'a' = 'A' AS val UNION ALL SELECT 'System' col, @@version_compile_os val",remark:"数据库环境信息"},{group:"rely",name:"db-params-info",sql:"SELECT concat(VARIABLE_NAME, '=', VARIABLE_VALUE) AS params, CASE VARIABLE_VALUE WHEN 'OFF' THEN 'SET GLOBAL local_infile = ON' END AS idea, '是否允许加载本地数据，BulkCopy 需要开启，ON 开启，OFF 关闭' AS remark FROM performance_schema.session_variables WHERE VARIABLE_NAME = 'local_infile' UNION ALL SELECT concat(VARIABLE_NAME, '=', VARIABLE_VALUE) AS params, CASE WHEN VARIABLE_VALUE < 600 THEN 'SET GLOBAL innodb_lock_wait_timeout = 600' END AS idea, 'innodb 的 dml 操作的行级锁的等待时间，事务等待获取资源等待的最长时间，BulkCopy 量大超时设置，单位：秒' AS remark FROM performance_schema.session_variables WHERE VARIABLE_NAME = 'innodb_lock_wait_timeout' UNION ALL SELECT concat(VARIABLE_NAME, '=', VARIABLE_VALUE) AS params, CASE WHEN VARIABLE_VALUE != 1073741824 THEN 'SET GLOBAL max_allowed_packet = 1073741824' END AS idea, '传输的 packet 大小限制，最大 1G，单位：B' AS remark FROM performance_schema.session_variables WHERE VARIABLE_NAME = 'max_allowed_packet' UNION ALL SELECT concat(VARIABLE_NAME, '=', VARIABLE_VALUE) AS params, CASE WHEN VARIABLE_VALUE != 0 THEN concat('SET GLOBAL ', VARIABLE_NAME, ' = 0') END AS idea, '缓存中统计信息过期时间，要直接从存储引擎获取统计信息，将其设置为 0，单位：秒；expiry 为 MySQL8' AS remark FROM performance_schema.session_variables WHERE VARIABLE_NAME IN ( 'information_schema_stats', 'information_schema_stats_expiry' ) UNION ALL SELECT concat( t1.p1, '%, Innodb_buffer_pool_size: ', @@innodb_buffer_pool_size ) AS params, concat('SET GLOBAL Innodb_buffer_pool_size = ', t1.p2) AS idea, concat( '缓存索引和数据的内存大小，多多益善，内存读写减少磁盘读写，', '推荐设置 Innodb_buffer_pool_size 为服务器总可用内存的 75%, 过多造成浪费，', '计算 Innodb_buffer_pool_pages_data / Innodb_buffer_pool_pages_total * 100%，', '结果 > 95% 则增加 Innodb_buffer_pool_size，结果 < 95% 则减少 Innodb_buffer_pool_size' ) AS remark FROM ( SELECT TRUNCATE( ( SELECT VARIABLE_VALUE FROM performance_schema.global_status WHERE VARIABLE_NAME = 'Innodb_buffer_pool_pages_data' ) / ( SELECT VARIABLE_VALUE FROM performance_schema.global_status WHERE VARIABLE_NAME = 'Innodb_buffer_pool_pages_total' ) * 100, 0 ) p1, TRUNCATE( ( SELECT VARIABLE_VALUE FROM performance_schema.global_status WHERE VARIABLE_NAME = 'Innodb_buffer_pool_pages_data' ) * ( SELECT VARIABLE_VALUE FROM performance_schema.global_status WHERE VARIABLE_NAME = 'Innodb_page_size' ) * 1.05, 0 ) AS p2 ) t1 UNION ALL SELECT concat(VARIABLE_NAME, '=', VARIABLE_VALUE) AS params, 'SET GLOBAL innodb_flush_log_at_trx_commit=1' AS idea, '1 保证事务，等待磁盘写入；0 和  2 高性能缓存再写入，宕机可能丢失数据' AS remark FROM performance_schema.session_variables WHERE VARIABLE_NAME = 'innodb_flush_log_at_trx_commit'",remark:"数据库参数信息"},{group:"default",name:"database-name",sql:"SELECT SCHEMA_NAME AS DatabaseName FROM information_schema.schemata ORDER BY SCHEMA_NAME",remark:"数据库名称"},{group:"default",name:"uuid",sql:"select uuid()",remark:"生成 UUID"},{group:"default",name:"show-common",sql:"show databases; -- 显示数据库\nshow tables from information_schema; -- 显示当前数据库中所有表名称\nshow columns from information_schema.TABLES; -- 显示表中列名称\nshow table status; -- 显示表的信息\nshow index from information_schema.TABLES; -- 显示表索引\n\nshow grants for root; -- 显示用户权限\n\nshow status; -- 显示系统特定资源信息\nshow variables; -- 显示系统变量的名称和值\nshow variables like '%local_infile%'; -- 搜索\n\nshow processlist; -- 显示运行进程\n\nshow warnings; -- 显示最后的错误、警告和通知\nshow errors; -- 显示最后的错误\n\nshow slave status; -- 从状态\nshow master status; -- 主状态",remark:"show 常用命令"},{group:"default",name:"sleep",sql:"select sysdate(), sleep(1), sysdate()"},{group:"default",name:"datetime-function",sql:"select now(), sysdate(), sleep(1)\nunion all\nselect now(), sysdate(), 0; -- 当前日期时间，now 执行开始得到值 sysdate 实时获取\n\nselect concat('日期：',current_date(),' , 时间：',current_time()) '日期、时间' -- 日期、时间\nunion all\nselect concat('UTC日期：',utc_date(),' , UTC时间：',utc_time());\n\nselect utc_timestamp(); -- utc日期时间\nselect unix_timestamp(now()); -- 转时间戳\nselect date_format(now(), '%Y/%m/%d %H:%i:%s'); -- 格式化",remark:"时间函数"},{group:"default",name:"string-length",sql:'-- 字符串字节长度、字符长度\nSELECT\n  LENGTH("demo") "英文(demo)",\n  LENGTH("测试。") "中文符号(测试。)",\n  CHAR_LENGTH("demo") "CHAR - 英文(demo)",\n  CHAR_LENGTH("测试。") "CHAR - 中文符号(测试。)";',remark:"字符串长度"},{group:"default",name:"innodb_buffer_pool_size",sql:"\n-- Innodb buffer pool 缓存池中包含数据的页的数目，包括脏页。单位是 page\n-- Innodb buffer pool 的页总数目。单位是 page\nshow global status where Variable_name in ('Innodb_buffer_pool_pages_data', 'Innodb_buffer_pool_pages_total', 'Innodb_page_size');\n\nSELECT @@innodb_buffer_pool_size/1024/1024/1024; -- 字节转为 G\n\n-- 在线调整 InnoDB 缓冲池大小，如果不设置，默认为 128M\n-- set global innodb_buffer_pool_size = 1024*1024*1024*9; -- 单位字节",remark:"InnoDB 缓冲池大小"},{group:"default",name:"empty",sql:""}],n.Oracle=[{group:"rely",name:"db-env-info",sql:"SELECT 'Name' col, ( SELECT PRODUCT FROM ( SELECT ROW_NUMBER() OVER( ORDER BY PRODUCT DESC ) numid, A.* FROM product_component_version A ) WHERE numid = 3 ) val FROM dual UNION ALL SELECT 'Version' col, ( SELECT VERSION FROM product_component_version WHERE ROWNUM = 1 ) val FROM dual UNION ALL SELECT 'Compile' col, ( SELECT STATUS FROM ( SELECT ROW_NUMBER() OVER( ORDER BY PRODUCT DESC ) numid, A.* FROM product_component_version A ) WHERE numid = 3 ) val FROM dual UNION ALL SELECT 'DirData' col, ( SELECT file_name FROM dba_data_files WHERE file_id = 1 ) val FROM dual UNION ALL SELECT 'CharSet' col, ( SELECT VALUE FROM Nls_Database_Parameters WHERE PARAMETER = 'NLS_CHARACTERSET' ) val FROM dual UNION ALL SELECT 'TimeZone' col, SESSIONTIMEZONE val FROM dual UNION ALL SELECT 'DateTime' col, TO_CHAR(SYSDATE, 'yyyy-mm-dd hh24:mi:ss') val FROM DUAL UNION ALL SELECT 'MaxConn', ( SELECT TO_CHAR(VALUE) AS MaxConn FROM v$parameter WHERE NAME = 'processes' ) val FROM dual UNION ALL SELECT 'CurrConn' col, ( SELECT TO_CHAR(COUNT(1)) FROM v$process ) val FROM dual UNION ALL SELECT 'IgnoreCase' col, ( CASE WHEN 'a' = 'A' THEN '1' ELSE '0' END ) val FROM dual UNION ALL SELECT 'System' col, ( SELECT REPLACE(PRODUCT, ': ', '') FROM ( SELECT ROW_NUMBER() OVER( ORDER BY PRODUCT DESC ) numid, A.* FROM product_component_version A ) WHERE numid = 1 ) val FROM dual",desc:"数据库环境信息"},{group:"default",name:"database-name",sql:"SELECT USERNAME AS DatabaseName FROM ALL_USERS ORDER BY USERNAME",desc:"数据库名称"},{group:"default",name:"uuid",sql:"select rawtohex(sys_guid()) from dual",desc:"生成 GUID"},{group:"default",name:"manager",sql:"-- sqlplus 连接数据库，密码请勿带 @ 符号，巨坑\nsqlplus system/oracle@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(Host=localhost)(Port=1521))(CONNECT_DATA=(SID=orcl)))\n\n-- 查看表空间物理文件的名称及大小\nSELECT tablespace_name, file_id, file_name, round(bytes / (1024 * 1024), 0) total_space_MB FROM dba_data_files ORDER BY tablespace_name;\n\n-- 查询用户对应表空间\nselect username, default_tablespace from dba_users;\n-- 查看你能管理的所有用户\nselect * from all_users;\n-- 查看当前用户信息\nselect * from user_users;\n\n-- 创建表空间（大小 500M，每次 5M 自动增大，最大不限制）\n-- create tablespace DSPACE datafile '/u01/app/oracle/oradata/EE/DNAME.dbf' size 500M autoextend on next 5M maxsize unlimited;\n-- create tablespace DSPACE datafile 'c:oracleoradata\testDNAME.dbf' size 500M autoextend on next 5M maxsize unlimited;\n\n-- 删除表空间\n-- drop tablespace DSPACE including contents and datafiles cascade constraint;\n\n-- 创建用户并指定表空间\n-- create user DNAME identified by DPWD default tablespace DSPACE;\n\n-- 修改用户密码\nalter user \"DNAME\" identified by \"DPWD\";\n\n-- 为用户指定表空间\nalter user DNAME default tablespace DSPACE;\n\n-- 删除用户\ndrop user DNAME cascade;\n\n-- 授予权限\n-- connect：授予最终用户的典型权利，最基本的\n-- resource：授予开发人员\n-- dba：授予数据库所有的权限\ngrant connect, resource to DNAME;\ngrant dba to DNAME;\n-- 撤销权限\nrevoke dba from DNAME;\n-- 查询用户授予的角色权限\nselect * from dba_role_privs where grantee='DNAME';\n\n-- 锁定用户\nalter user DNAME account lock;\n-- 解锁用户\nalter user DNAME account unlock;\n\n-- 账号过期查询\nSELECT username, account_status, expiry_date FROM dba_users;\n-- 密码过期策略\nSELECT * FROM dba_profiles WHERE profile='DEFAULT' AND resource_name='PASSWORD_LIFE_TIME';",desc:"管理、维护"},{group:"default",name:"expdp-impdp",sql:"-- 按用户导出\nexpdp system/oracle@orcl schemas=$user dumpfile=$dbname.dmp logfile=$dbname.log directory=DATA_PUMP_DIR\n-- 按表名导出\nexpdp system/oracle@orcl tables=($TABLE1,$TABLE2) dumpfile=$dbname.dmp logfile=$dbname.log directory=DATA_PUMP_DIR\n-- 按用户导入（表覆盖）\nimpdp system/oracle@orcl schemas=$user dumpfile=$dbname.dmp logfile=$dbname.log directory=DATA_PUMP_DIR table_exists_action=REPLACE\n-- 按用户导入（转换空间）\nimpdp system/oracle@orcl schemas=$user TRANSFORM=segment_attributes:n dumpfile=$dbname.dmp logfile=$dbname.log directory=DATA_PUMP_DIR table_exists_action=REPLACE\n\n-- 导入导出包权限设置\nchown oracle -R /u01/app/oracle/admin/EE/dpdump/\n\n-- DIRECTORY 参数说明\n-- 查看管理员目录\nselect * from dba_directories\n-- 创建逻辑目录，还需手动创建目录，Oracle 不关心目录是否存在，不存在会报错\ncreate directory DP_DIR as 'C:appAdministrator/admin/orcl/dpdump/'\n-- DUMPFILE 指定的 dmp 文件应放在 DIRECTORY 目录下\n-- 删除逻辑目录\ndrop directory DP_DIR",desc:"导入导出"},{group:"default",name:"common-function",sql:"select sysdate, sys_guid(), rawtohex(sys_guid()) from dual",desc:"常用函数"},{group:"default",name:"cursor-query",sql:"-- 接收参数 cmd.Parameters.Add(cursor, OracleDbType.RefCursor, DBNull.Value, ParameterDirection.Output)\nBEGIN\n    OPEN :o1 for SELECT 1,2 FROM dual;\n    OPEN :o2 for SELECT 3,4 FROM dual;\nEND;",remark:"游标多表查询"},{group:"default",name:"empty",sql:""}],n.SQLServer=[{group:"rely",name:"db-env-info",sql:"SELECT 'Name' col, SUBSTRING(@@VERSION, 1, CHARINDEX(' - ', @@VERSION, 1)) + ' ' + CONVERT(varchar(99), SERVERPROPERTY('Edition')) val UNION ALL SELECT 'Version' col, SERVERPROPERTY('ProductVersion') val UNION ALL SELECT 'DirData' col, SERVERPROPERTY('InstanceDefaultDataPath') val UNION ALL SELECT 'CharSet' col, SERVERPROPERTY('Collation') val UNION ALL SELECT 'DateTime' col, GETDATE() val UNION ALL SELECT 'TimeOut' col, value_in_use val FROM sys.configurations WHERE description = 'remote query timeout' UNION ALL SELECT 'MaxConn' col, @@MAX_CONNECTIONS val UNION ALL SELECT 'CurrConn' col, ( SELECT COUNT(dbid) FROM sys.sysprocesses ) val UNION ALL SELECT 'IgnoreCase' col, ( CASE WHEN 'a' = 'A' THEN 1 ELSE 0 END ) val UNION ALL SELECT 'System' col, REPLACE( RIGHT( @@VERSION, CHARINDEX(CHAR(10), REVERSE(@@VERSION), 2) - 2 ), CHAR(10), '' ) val;\n    EXEC master.dbo.Xp_instance_regread N'HKEY_LOCAL_MACHINE', N'SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation', N'TimeZoneKeyName'",remark:"数据库环境信息"},{group:"default",name:"database-name",sql:"SELECT name AS DatabaseName FROM sys.databases ORDER BY name"},{group:"default",name:"uuid",sql:"select newid()"},{group:"default",name:"query-history",sql:"SELECT QS.creation_time, SUBSTRING(ST.text, (QS.statement_start_offset / 2)+1, ((CASE QS.statement_end_offset WHEN-1 THEN DATALENGTH(st.text)ELSE QS.statement_end_offset END-QS.statement_start_offset)/ 2)+1) AS statement_text, ST.text, QS.total_worker_time, QS.last_worker_time, QS.max_worker_time, QS.min_worker_time\nFROM sys.dm_exec_query_stats QS\n     CROSS APPLY sys.dm_exec_sql_text(QS.sql_handle) ST\nWHERE ST.text LIKE '%%' AND QS.creation_time BETWEEN dateadd(MM, -1, GETDATE())AND GETDATE()\nORDER BY QS.creation_time DESC",remark:"查询历史"},{group:"default",name:"connection-info",sql:"SELECT a.spid, b.name, 'kill ' + CONVERT(varchar, a.spid) + ';' AS kill_command FROM MASTER..SysProcesses a LEFT JOIN sys.databases b ON b.database_id = a.dbid",remark:"数据库连接信息、关闭连接"},{group:"default",name:"table-size",sql:"-- 定义表变量\nDECLARE @T TABLE([name] VARCHAR(99),\n[rows] INT,\nreserved VARCHAR(99),\ndata_size VARCHAR(99),\nindex_size VARCHAR(99),\nunused VARCHAR(99));\n\n-- 将表占用情况存放到表变量\nINSERT INTO @T EXEC sp_MSforeachtable \"exec sp_spaceused '?'\";\nSELECT * FROM @T",remark:"表大小情况"},{group:"default",name:"identity_cache",sql:"ALTER DATABASE SCOPED CONFIGURATION SET IDENTITY_CACHE = OFF -- 关闭自增缓存\nselect * from sys.database_scoped_configurations where name = 'IDENTITY_CACHE' -- 查询自增缓存状态",remark:"自增缓存"},{group:"default",name:"sleep",sql:"SELECT GETDATE()\nWAITFOR DELAY N'00:00:01.500'\nSELECT GETDATE()"},{group:"default",name:"datetime-function",sql:"declare @local datetime=getdate()\ndeclare @utc datetime=getutcdate()\ndeclare @utc8 datetime=dateadd(hour, 8, getutcdate())\nprint N'当前时间：'+CONVERT(varchar(99), @local, 21)\nprint N'UTC：'+CONVERT(varchar(99), @utc, 21)\nprint N'UTC +8：'+CONVERT(varchar(99), @utc8, 21)\nprint N'格式化（yyyy-MM-dd HH:mm:ss.fff）：'+CONVERT(varchar(99), @utc8, 21)\nprint N'格式化（yyyy-MM-dd HH:mm:ss）：'+CONVERT(varchar(99), @utc8, 20)\nprint N'格式化（yyyy-MM-dd）：'+CONVERT(varchar(99), @utc8, 23)\nprint N'格式化（yyyy.MM.dd）：'+CONVERT(varchar(99), @utc8, 102)\nprint N'格式化（yyyy/MM/dd）：'+CONVERT(varchar(99), @utc8, 111)\nprint N'格式化（yyyyMMdd）：'+CONVERT(varchar(99), @utc8, 112)\nprint N'格式化（HH:mm:ss）：'+CONVERT(varchar(99), @utc8, 24)\nprint N'追加一天：'+CONVERT(varchar(99), dateadd(day, 1, @utc8), 21)",remark:"时间函数"},{group:"default",name:"guid",sql:"print newid()"},{group:"default",name:"sp_GetDDL",sql:"-- ref: https://www.stormrage.com/SQLStuff/sp_GetDDL_Latest.txt",remark:"获取表结构"},{group:"default",name:"empty",sql:""}],n.PostgreSQL=[{group:"rely",name:"db-env-info",sql:"SELECT 'Name' col, split_part(split_part(VERSION(), ',', 1), ' on ', 1) UNION ALL SELECT 'Version' col, ( SELECT setting FROM pg_settings WHERE NAME = 'server_version' ) val UNION ALL SELECT 'Compile' col, split_part(VERSION(), ',', 2) val UNION ALL SELECT 'DirInstall' col, ( SELECT split_part(setting, 'main', 1) FROM pg_settings WHERE NAME = 'archive_command' ) val UNION ALL SELECT 'DirData' col, ( SELECT setting FROM pg_settings WHERE NAME = 'data_directory' ) val UNION ALL SELECT 'CharSet' col, ( SELECT setting FROM pg_settings WHERE NAME = 'server_encoding' ) val UNION ALL SELECT 'TimeZone' col, ( SELECT setting FROM pg_settings WHERE NAME = 'TimeZone' ) val UNION ALL SELECT 'DateTime' col, to_char(now(), 'YYYY-MM-DD HH24:MI:SS.MS') val UNION ALL SELECT 'MaxConn' col, ( SELECT setting FROM pg_settings WHERE NAME = 'max_connections' ) val UNION ALL SELECT 'CurrConn' col, CAST(COUNT(1) AS VARCHAR) val FROM pg_stat_activity UNION ALL SELECT 'TimeOut' col, ( SELECT setting FROM pg_settings WHERE NAME = 'statement_timeout' ) val UNION ALL SELECT 'IgnoreCase' col, CASE 'a' = 'A' WHEN 't' THEN '1' ELSE '0' END val UNION ALL SELECT 'System' col, split_part(split_part(VERSION(), ',', 1), ' on ', 2) val",remark:"数据库环境信息"},{group:"default",name:"database-name",sql:"SELECT datname AS DatabaseName FROM pg_database ORDER BY datname"},{group:"default",name:"sleep",sql:"select clock_timestamp(), pg_sleep(1), clock_timestamp();"},{group:"default",name:"uuid",sql:"select uuid_generate_v4()",remark:'生成 uuid , 须添加扩展：create extension "uuid-ossp";'},{group:"default",name:"print",sql:"DO $$\nBEGIN\n    RAISE NOTICE '当前日期时间：%', now();\n    RAISE NOTICE '版本信息：%', version();\nEND\n$$;\n",remark:"打印输出"},{group:"default",name:"empty",sql:""}]},33:(e,a,t)=>{t.d(a,{N:()=>i});var n=t(644),r=t(821),o=t(3),l=t(769),i={statusSet:e=>{null==e&&(e=i.statusInfo.queueList.length>0),(r.p.domRequestStatus.loading=e)?(r.p.domRequestStatus.type="danger",i.statusInfo.run()):(r.p.domRequestStatus.type="default",i.statusInfo.stop()),r.p.gridOpsQueue.api.setRowData(i.statusInfo.queueList)},statusInfo:{title:document.title,queueList:[],queueAdd:e=>{i.statusInfo.queueList.unshift(e),i.statusSet()},queueRemove:e=>{for(var a=i.statusInfo.queueList.length-1;a>=0;a--)i.statusInfo.queueList[a].id==e.id&&i.statusInfo.queueList.splice(a,1);i.statusSet()},queueCancel:e=>{e.abortCtrl.abort(),i.statusInfo.queueRemove(e)},si:null,run:(e=1,a=!0)=>{for(var t=[],n=r.p.emoji.loading,o=0;o<e;o++)t.push(n);document.title=" "+t.join(" "),a?e++:e--,a=5!=e&&a,a=1==e||a,document.querySelector("sl-icon-button").classList.add("nrc-rotate-1"),clearTimeout(i.statusInfo.si),i.statusInfo.si=setTimeout((()=>{i.statusInfo.run(e,a)}),600)},stop:()=>{clearTimeout(i.statusInfo.si),document.title=i.statusInfo.title,document.querySelector("sl-icon-button").classList.remove("nrc-rotate-1")}},parameterJoin:e=>{var a=[];for(var t in e)a.push(`${t}=${encodeURIComponent(e[t])}`);return a.join("&")},request:(e,a)=>new Promise(((t,r)=>{let o={id:n.R.UUID(),date:n.R.formatDateTime(),url:e,abortCtrl:new AbortController};i.statusInfo.queueAdd(o);let s=[];fetch(e,Object.assign({method:"GET",signal:o.abortCtrl.signal},a)).then((e=>{if(404!=e.status)return e.json();s=[l.t.lg.menu,l.t.lg.setting,l.t.lg.setServerTitle,l.t.lg.setServerPlaceholder].join(" > ")+" ? <br/>"})).then((e=>{var l;(console.debug(e),i.statusInfo.queueRemove(o),200==e.code)?t(e):(a&&a.body&&(l=a.body.get("sql")),l?(n.R.alert(`${e.msg}<sl-divider></sl-divider><code style="word-break:break-all">${l.substring(0,999)}</code>`),r(e)):(n.R.output(e.msg),r(e)))})).catch((a=>{n.R.alert(`${s}${a}<sl-divider></sl-divider><code style="word-break:break-all">${e}</code>`),i.statusInfo.queueRemove(o),r(a)}))})),reqConns:()=>new Promise((e=>{o.$.connsGet().then((a=>{0==a.length&&(a=r.p.resConnDemo),a.sort(((e,a)=>e.order-a.order)),e(a)}))})),reqDatabaseName:(e,a=!1)=>new Promise(((t,n)=>{new Promise((t=>{a?t():o.$.cc([e.id]).then((e=>{null!=e?t(e.data):t()})).catch((()=>t()))})).then((a=>{if(a)t(a);else{var l=i.parameterJoin({tdb:e.type,conn:e.conn});i.request(`${r.p.apiServer}${r.p.apiGetDatabaseName}?${l}`).then((a=>{var n=[];a.data.forEach((e=>{n.push({DatabaseName:e})})),o.$.cc([e.id],n),t(n)})).catch((e=>n(e)))}}))})),reqDatabaseInfo:(e,a,t=!1)=>new Promise(((n,l)=>{var s=""==a?[]:a.split(",");new Promise((a=>{t?a():o.$.cc([e.id]).then((e=>{if(null!=e){var t=!0;e.data.forEach((e=>{0==s.length?Object.hasOwnProperty.call(e,"DatabaseCharset")||(t=!1):s.includes(e.DatabaseName)&&!Object.hasOwnProperty.call(e,"DatabaseCharset")&&(t=!1)})),t?a(e.data):a()}else a()})).catch((()=>a()))})).then((t=>{if(t)n(t);else{var s=i.parameterJoin({tdb:e.type,conn:e.conn,filterDatabaseName:a});i.request(`${r.p.apiServer}${r.p.apiGetDatabaseInfo}?${s}`).then((a=>{o.$.cc([e.id]).then((t=>{t.data.forEach((e=>{var t=a.data.filter((a=>a.DatabaseName==e.DatabaseName));t.length>0&&Object.assign(e,t[0])})),o.$.cc([e.id],t.data),n(t.data)}))})).catch((e=>l(e)))}}))})),reqTable:(e,a,t=!1)=>new Promise(((n,l)=>{new Promise((n=>{t?n():o.$.cc([e.id,a]).then((e=>{null!=e?n(e.data):n()})).catch((()=>n()))})).then((t=>{if(t)n(t);else{var s=i.parameterJoin({tdb:e.type,conn:e.conn,databaseName:a});i.request(`${r.p.apiServer}${r.p.apiGetTable}?${s}`).then((t=>{o.$.cc([e.id,a],t.data),n(t.data)})).catch((e=>l(e)))}}))})),reqColumn:(e,a,t,n=!1)=>new Promise(((l,s)=>{new Promise((l=>{n?l():o.$.cc([e.id,a,"*"]).then((e=>{if(null!=e){var a=e.data.map((e=>`${e.SchemaName}.${e.TableName}`)),n=[];if(null!=t&&""!=t)n=t.split(",");else{var o=agg.getAllRows(r.p.gridOpsTable);n=o.map((e=>`${e.SchemaName}.${e.TableName}`))}if(n.filter((e=>!a.includes(e))).length)l();else{var i=e.data.filter((e=>n.includes(`${e.SchemaName}.${e.TableName}`)));l(i)}}else l()})).catch((()=>l()))})).then((n=>{if(n)l(n);else{var c=new FormData;c.append("tdb",e.type),c.append("conn",e.conn),c.append("filterSchemaNameTableName",t),c.append("databaseName",a),i.request(`${r.p.apiServer}${r.p.apiGetColumn}`,{method:"POST",body:c}).then((t=>{o.$.cc([e.id,a,"*"]).then((n=>{if(null!=n){var r=t.data.map((e=>e.TableName)),l=n.data.filter((e=>!r.includes(e.TableName)));l=l.concat(t.data).sort(((e,a)=>e.TableName.localeCompare(a.TableName))),o.$.cc([e.id,a,"*"],l)}else o.$.cc([e.id,a,"*"],t.data)})),l(t.data)})).catch((e=>s(e)))}}))})),reqTableDDL:(e,a,t,n)=>{var o=i.parameterJoin({tdb:e.type,conn:e.conn,tableName:n,schemaName:t,databaseName:a});return i.request(`${r.p.apiServer}${r.p.apiGetTableDDL}?${o}`)},setTableComment:(e,a,t,n,o)=>new Promise(((l,s)=>{if("SQLite"!=e.type){var c=new FormData;c.append("tdb",e.type),c.append("conn",e.conn),c.append("tableName",a),c.append("tableComment",t),c.append("schemaName",n),c.append("databaseName",o),i.request(`${r.p.apiServer}${r.p.apiSetTableComment}`,{method:"POST",body:c}).then((e=>l(e))).catch((e=>s(e)))}else s()})),setColumnComment:(e,a,t,n,o,l)=>new Promise(((s,c)=>{if("SQLite"!=e.type){var d=new FormData;d.append("tdb",e.type),d.append("conn",e.conn),d.append("tableName",a),d.append("columnName",t),d.append("columnComment",n),d.append("schemaName",o),d.append("databaseName",l),i.request(`${r.p.apiServer}${r.p.apiSetColumnComment}`,{method:"POST",body:d}).then((e=>s(e))).catch((e=>c(e)))}else c()}))}},372:(e,a,t)=>{t.d(a,{U:()=>p});var n=t(821),r=t(769),o=t(3),l=t(644),i=t(513),s=t(178),c=t(33),d=t(147),p={"cp-1":{cobj:{},databaseName:null},cpKeys:["1"],cpGet:e=>p[`cp-${e}`],cpSet:(e,a,t)=>{p.cpKeys.includes(e)||p.cpKeys.push(e),p[`cp-${e}`]={cobj:a,databaseName:t},p.stepSave()},cpRemove:e=>{var a=p.cpKeys.indexOf(e);a>=0&&p.cpKeys.splice(a,1),delete p[`cp-${e}`],p.stepSave()},cpInfo:e=>{if("reset"==e)n.p.domTabconns.style.display="none",n.p.domTabdatabase.style.display="none";else{var a=p.cpGet(e);if(null!=a){var t=a.cobj;if(1!=e){n.p.domTabconns.style.display="block",n.p.domTabdatabase.style.display="block",n.p.domTabconns.setAttribute("data-key",e),n.p.domTabdatabase.setAttribute("data-cobjid",t.id);var o,l=function(e){var t=n.p.colorEnv(a.cobj.env);return`<span ${t=t?`style="color:${t};"`:""}>${e}</span>`},d=l(n.p.iconSvg(t.type,t.alias+n.p.iconEnv(t.env),{className:"align-middle me-1",library:"nr-icon"})),u=l(null==a.databaseName?"(none)":n.p.iconSvg("server",a.databaseName,{className:"align-middle me-1"}));if(n.p.domGridTabconns)(o=n.p.domTabconns.firstElementChild).title=t.conn,o.innerHTML=d;else n.p.domTabconns.innerHTML=`\n                        <sl-button title="${t.conn}" slot="trigger" size="small" caret>${d}</sl-button>\n                        <sl-menu class="px-2">\n                            <div>\n                                <sl-input class="nr-filter-tabconns mb-2" size="small" placeholder="${r.t.lg.search}">\n                                    <sl-icon name="search" slot="prefix"></sl-icon>\n                                </sl-input>\n                            </div>\n                            <div class="nr-grid-tabconns" style="width:24em;max-width:100%;height:55vh"></div>\n                        </sl-menu>\n                        `,n.p.domGridTabconns=n.p.domTabconns.querySelector(".nr-grid-tabconns"),n.p.domFilterTabconns=n.p.domTabconns.querySelector(".nr-filter-tabconns"),n.p.domFilterTabconns.addEventListener("input",(function(){n.p.gridOpsTabconns.api.setQuickFilter(this.value)})),n.p.domTabconns.addEventListener("sl-show",(function(e){var a=n.p.domTabconns.getAttribute("data-key"),t=p.cpGet(a);if(null==n.p.gridOpsTabconns||1==n.p.envConnsChanged){n.p.envConnsChanged=!1;var o=agg.optionDef({rowData:agg.getAllRows(n.p.gridOpsConns),getRowId:e=>e.data.id,rowGroupPanelShow:"never",rowSelection:"single",suppressRowClickSelection:!1,enableRangeSelection:!1,suppressContextMenu:!0,headerHeight:0,columnDefs:[{field:"alias",headerName:r.t.lg.connAlias,tooltipField:"conn",flex:1,checkboxSelection:!0,cellRenderer:e=>{if(!e.node.group)return e.data.type?n.p.iconSvg(e.data.type,e.value,{library:"nr-icon"}):e.value},cellStyle:e=>{var a=e.node.data&&e.node.data.env;switch(a){case"Test":case"Production":return{color:n.p.colorEnv(a)}}}}],onSelectionChanged:function(){var e=n.p.domTabconns.getAttribute("data-key"),a=p.cpGet(e),t=n.p.gridOpsTabconns.api.getSelectedRows();t.length&&a.cobj.id!=t[0].id&&(p.cpSet(e,t[0]),s.W.tabKeys[e].domTab.innerHTML=n.p.iconSvg("plug-fill",t[0].alias),s.W.tabNavFix(),p.cpInfo(e))}});i.P.createGrid("tabconns",o)}n.p.domFilterTabconns.value="",n.p.gridOpsTabconns.api.setQuickFilter(""),n.p.gridOpsTabconns.api.clearRangeSelection(),n.p.gridOpsTabconns.api.forEachNode((function(e){e.data.id==t.cobj.id&&(e.setSelected(!0,!0),n.p.gridOpsTabconns.api.ensureIndexVisible(e.rowIndex))}))}));if(n.p.domGridTabdatabase)(o=n.p.domTabdatabase.firstElementChild).title=a.databaseName||"",o.innerHTML=u;else n.p.domTabdatabase.innerHTML=`\n                        <sl-button title="${a.databaseName||""}" slot="trigger" size="small" caret>${u}</sl-button>\n                        <sl-menu class="px-2">\n                            <div>\n                                <sl-input class="nr-filter-tabdatabase mb-2" size="small" placeholder="${r.t.lg.search}">\n                                    <sl-icon name="search" slot="prefix"></sl-icon>\n                                </sl-input>\n                            </div>\n                            <div class="nr-grid-tabdatabase" style="width:24em;max-width:100%;height:55vh"></div>\n                        </sl-menu>\n                        `,n.p.domGridTabdatabase=n.p.domTabdatabase.querySelector(".nr-grid-tabdatabase"),n.p.domFilterTabdatabase=n.p.domTabdatabase.querySelector(".nr-filter-tabdatabase"),n.p.domFilterTabdatabase.addEventListener("input",(function(){n.p.gridOpsTabdatabase.api.setQuickFilter(this.value)})),n.p.domTabdatabase.addEventListener("sl-show",(function(e){var a=n.p.domTabconns.getAttribute("data-key"),t=p.cpGet(a),o=n.p.domTabdatabase.getAttribute("data-grid-cobjid");new Promise(((e,a)=>{null==n.p.gridOpsTabdatabase||o!=t.cobj.id?(n.p.domTabdatabase.setAttribute("data-grid-cobjid",t.cobj.id),c.N.reqDatabaseName(t.cobj).then((a=>{var t=agg.optionDef({rowData:a,getRowId:e=>e.data.DatabaseName,rowGroupPanelShow:"never",rowSelection:"single",suppressRowClickSelection:!1,enableRangeSelection:!1,suppressContextMenu:!0,headerHeight:0,columnDefs:[{field:"DatabaseName",headerName:r.t.lg.dbName,tooltipField:"DatabaseName",flex:1,checkboxSelection:!0,cellRenderer:e=>n.p.iconSvg("server",e.value)}],onSelectionChanged:function(){var e=n.p.domTabconns.getAttribute("data-key"),a=p.cpGet(e),t=n.p.gridOpsTabdatabase.api.getSelectedRows(),r=t.length?t[0].DatabaseName:null;a.databaseName!=r&&(p.cpSet(e,a.cobj,r),s.W.tabKeys[e].domTab.innerHTML=r?n.p.iconSvg("server",t[0].DatabaseName):n.p.iconSvg("plug-fill",a.cobj.alias),s.W.tabNavFix(),p.cpInfo(e))}});i.P.createGrid("tabdatabase",t),e()})).catch((e=>{a(e)}))):e()})).then((()=>{n.p.domFilterTabdatabase.value="",n.p.gridOpsTabdatabase.api.setQuickFilter(""),n.p.gridOpsTabdatabase.api.clearRangeSelection(),t.databaseName?n.p.gridOpsTabdatabase.api.forEachNode((function(e){e.data.DatabaseName==t.databaseName&&e.setSelected(!0,!0)})):n.p.gridOpsTabdatabase.api.deselectAll()}))}))}}}},cpCurrent:function(){switch(n.p.domTabGroup1.activeTab.panel){case"tp1-conns":var e=n.p.gridOpsConns.api.getSelectedRows(),a=n.p.gridOpsConns.api.getCellRanges();if(e.length?t=e[0]:a.length&&(t=n.p.gridOpsConns.api.getDisplayedRowAtIndex(a[0].startRow.rowIndex).data),t)return{cobj:t};l.R.output(r.t.lg.selectConn);break;case"tp1-database":var t;e=n.p.gridOpsDatabase.api.getSelectedRows(),a=n.p.gridOpsDatabase.api.getCellRanges();e.length?t=e.sort(((e,a)=>e.DatabaseName.localeCompare(a.DatabaseName)))[0]:a.length&&(t=n.p.gridOpsDatabase.api.getDisplayedRowAtIndex(a[0].startRow.rowIndex).data);var o=p.cpGet(1);return t?{cobj:o.cobj,databaseName:t.DatabaseName}:o;case"tp1-table":case"tp1-column":return o=p.cpGet(1)}},stepVarIng:0,stepVarStart:Date.now(),stepVarEnd:Date.now(),stepVarIndex:0,stepVarDefer:null,stepStatus:e=>{switch(e){case 1:p.stepVarStart=Date.now(),p.stepVarIng=e,p.stepVarIndex=0;break;case 2:p.stepVarEnd=Date.now(),p.stepVarIng=e,console.debug("step done "+(p.stepVarEnd-p.stepVarStart)),clearTimeout(p.stepVarDefer);break;default:p.stepVarEnd=Date.now(),p.stepVarIng=-1,console.debug("step timeout")}},stepSave:()=>{if(1!=p.stepVarIng){var e={theme:n.p.theme,language:r.t.language,spliter1Size:d.x.getSpliterSize(n.p.domSpliter1),apiServer:n.p.apiServer,parameterConfig:{},connCache:{},tabGroup1Show:"tp-conns",filterConns:n.p.domFilterConns.value,viewDatabase:null!=n.p.gridOpsDatabase,filterDatabase:n.p.domFilterDatabase.value,viewTable:null!=n.p.gridOpsTable,filterTable:n.p.domFilterTable.value,viewColumn:null!=n.p.gridOpsColumn,filterColumn:n.p.domFilterColumn.value,viewColumnTableName:[]};for(const a in n.p.parameterConfig)e.parameterConfig[a]=n.p.parameterConfig[a].value;n.p.domTabGroup1.querySelectorAll("sl-tab-panel").forEach((a=>{"block"==a.style.display&&(e.tabGroup1Show=a.name)})),e.connCache[1]=p.cpGet(1)||{},e.viewColumn&&(e.viewColumnTableName=l.R.groupBy(n.p.gridOpsColumn.rowData,(e=>e.TableName))),o.$.stepsSet(e)}},stepStart:()=>new Promise((e=>{1==p.stepVarIng?l.R.output(r.t.lg.inProgress):(p.stepStatus(1),p.stepVarDefer=setTimeout((()=>{p.stepStatus(-1),e()}),3e4),o.$.stepsGet().then((a=>p.stepItemRun(["step-theme","step-spliter1-size","step-api-server","step-parameter-config","step-conn-cache","step-view-conns","step-tab-group1-show"],a).then((()=>p.stepItemRun(["step-view-database","step-view-table","step-view-column"],a).then((()=>{p.stepStatus(2),e()})))))))})),stepItemRun:(e,a)=>new Promise((t=>{var n=[];e.forEach((e=>n.push(p.stepItemCmd(e,a)))),Promise.all(n).then((()=>t())).catch((()=>t()))})),stepItemCmd:(e,a)=>new Promise((t=>{switch(a=a||{},e){case"step-theme":d.x.actionRun("theme",a.theme),t();break;case"step-spliter1-size":a.spliter1Size&&""!=a.spliter1Size&&d.x.setSpliterSize(n.p.domSpliter1,a.spliter1Size),t();break;case"step-api-server":a.apiServer&&""!=a.apiServer&&(n.p.apiServer=a.apiServer),t();break;case"step-parameter-config":if(a.parameterConfig)for(const e in a.parameterConfig)n.p.parameterConfig[e].value=a.parameterConfig[e];t();break;case"step-conn-cache":for(var r in a.connCache){var o=a.connCache[r];p.cpSet(r,o.cobj,o.databaseName)}t();break;case"step-view-conns":c.N.reqConns().then((e=>{i.P.viewConns(e).then((()=>{p.stepItemCmd("step-tab-group1-show",a);var e=(a.filterConns||"").trim();""!=e&&(n.p.domFilterConns.value=e,n.p.gridOpsConns.api.setQuickFilter(e)),t()}))}));break;case"step-view-database":if(a.viewDatabase){o=p.cpGet(1);c.N.reqDatabaseName(o.cobj).then((e=>{i.P.viewDatabase(e).then((()=>{p.stepItemCmd("step-tab-group1-show",a);var e=(a.filterDatabase||"").trim();""!=e&&(n.p.domFilterDatabase.value=e,n.p.gridOpsDatabase.api.setQuickFilter(e)),t()}))})).catch(t)}else t();break;case"step-view-table":o=p.cpGet(1);a.viewTable&&null!=o.databaseName?c.N.reqTable(o.cobj,o.databaseName).then((e=>{i.P.viewTable(e,o.cobj).then((()=>{p.stepItemCmd("step-tab-group1-show",a);var e=(a.filterTable||"").trim();""!=e&&(n.p.domFilterTable.value=e,n.p.gridOpsTable.api.setQuickFilter(e)),t()}))})).catch(t):t();break;case"step-view-column":o=p.cpGet(1);a.viewColumn&&a.viewColumnTableName.length&&null!=o.databaseName?c.N.reqColumn(o.cobj,o.databaseName,a.viewColumnTableName.join(",")).then((e=>{i.P.viewColumn(e,o.cobj).then((()=>{p.stepItemCmd("step-tab-group1-show",a);var e=(a.filterColumn||"").trim();""!=e&&(n.p.domFilterColumn.value=e,n.p.gridOpsColumn.api.setQuickFilter(e)),t()}))})).catch(t):t();break;case"step-tab-group1-show":a.tabGroup1Show&&""!=a.tabGroup1Show&&n.p.domTabGroup1.show(a.tabGroup1Show),t()}}))}},3:(e,a,t)=>{t.d(a,{$:()=>l});var n=t(821),r=t(644),o=t(372),l={instanceConfig:null,instanceCache:null,init:e=>{l.instanceConfig=e.createInstance({name:"ndk-config"}),l.instanceCache=e.createInstance({name:"ndk-cache"})},keys:{keyConns:{key:"conns"},keySteps:{key:"steps"},keyErrors:{key:"errors"},keyNotes:{key:"notes"},keyHistorys:{key:"historys"}},connsSet:e=>new Promise((a=>{l.connsGet().then((t=>{"Array"!=r.R.type(e)&&(e=[e]),e.forEach((e=>{for(var a=t.length-1;a>=0;a--){if(t[a].id==e.id){t.splice(a,1);break}}})),t=t.concat(e),n.p.envConnsChanged=!0,l.instanceConfig.setItem(l.keys.keyConns.key,t).then((()=>a(t)))}))})),connsDelete:e=>new Promise((a=>{e="Array"==r.R.type(e)?e:[e],l.connsGet().then((t=>{for(var r=0;r<t.length;r++){var o=t[r];e.includes(o.id)&&t.splice(r,1)}l.instanceCache.keys().then((a=>{a.filter((a=>e.includes(a.split("-")[0]))).forEach((e=>l.instanceCache.removeItem(e)))})),n.p.envConnsChanged=!0,l.instanceConfig.setItem(l.keys.keyConns.key,t).then((()=>a(t)))}))})),connsGet:e=>new Promise((a=>{l.instanceConfig.getItem(l.keys.keyConns.key).then((t=>{t=t||[],a(null!=e?t.filter((a=>a.id==e)).pop()||[]:t)}))})),stepsSet:e=>l.instanceConfig.setItem(l.keys.keySteps.key,e),stepsGet:()=>l.instanceConfig.getItem(l.keys.keySteps.key),stepsDelete:()=>l.instanceConfig.removeItem(l.keys.keySteps.key),errorsAdd:e=>new Promise((a=>{l.errorsGet().then((t=>{(t=t||[]).length>100&&(t=t.slice(50)),t.push(Object.assign({date:r.R.now()},e)),l.instanceConfig.setItem(l.keys.keyErrors.key,t).then((()=>a(t)))}))})),errorsGet:()=>new Promise((e=>{l.instanceConfig.getItem(l.keys.keyErrors.key).then((a=>{e(a||[])}))})),historysAdd:(e,a,t)=>new Promise((o=>{l.historysGet().then((i=>{(i=i||[]).length>2*n.p.parameterConfig.maxSqlHistory.value&&(i=i.slice(n.p.parameterConfig.maxSqlHistory.value)),i.unshift({sql:t,date:r.R.now(),databaseName:a,cobjId:e}),l.instanceConfig.setItem(l.keys.keyHistorys.key,i).then((()=>o(i)))}))})),historysGet:()=>l.instanceConfig.getItem(l.keys.keyHistorys.key),cc:(e,a)=>new Promise((t=>{switch(e.length){case 1:e.splice(1,0,"database");break;case 2:e.splice(1,0,"table");break;default:e.splice(1,0,"column")}null==a?l.instanceCache.getItem(e.join("-")).then((e=>t(e))):l.instanceCache.setItem(e.join("-"),{data:a,date:r.R.now()}).then((e=>t(e)))})),ccBrushTable:()=>{var e=o.U.cpGet(1),a=agg.getAllRows(n.p.gridOpsTable);l.cc([e.cobj.id,e.databaseName],a)}}},178:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{W:()=>ndkTab});var _ndkFunction__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(644),_ndkEditor__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(213),_ndkVary__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(821),_ndkI18n__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(769),_ndkExecute__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(334),_ndkAction__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(147),_ndkGenerateCode__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(722),ndkTab={tabKeys:{},tabBuild:(key,title,type)=>new Promise((resolve=>{if(key=`tp-${key}`,!(key in ndkTab.tabKeys)){var pbox="";switch(type){case"code":pbox=`\n<div class="nr-spliter3 nrc-spliter-horizontal">\n    \x3c!--Editor Code--\x3e\n    <div class="nrc-spliter-item">\n        <div class="nr-gc1-tool">\n            <sl-select class="nr-gc1-fn mb-2" size="small" panel="${key}" placeholder="${_ndkI18n__WEBPACK_IMPORTED_MODULE_3__.t.lg.pleaseChoose}" multiple clearable></sl-select>            \n            <sl-tooltip content="Debug">\n                <sl-icon-button class="nr-gc1-debug mb-2" name="play-circle" label="${_ndkI18n__WEBPACK_IMPORTED_MODULE_3__.t.lg.debug}" panel="${key}"></sl-icon-button>\n            </sl-tooltip>\n            <sl-tooltip content="Run">\n                <sl-icon-button class="nr-gc1-run mb-2" name="play-circle-fill" label="${_ndkI18n__WEBPACK_IMPORTED_MODULE_3__.t.lg.run}" panel="${key}"></sl-icon-button>\n            </sl-tooltip>\n        </div>\n        <div class="nr-editor-gc1"></div>\n    </div>\n\n    <div class="nrc-spliter-bar"></div>\n    <div class="nrc-spliter-bar-active"></div>\n\n    \x3c!--Editor Result--\x3e\n    <div class="nrc-spliter-item">\n        <div class="nr-gc2-tool">\n            <sl-select class="nr-gc2-language mb-2" size="small" panel="${key}"></sl-select>\n        </div>\n        <div class="nr-editor-gc2"></div>\n    </div>\n</div>\n                        `;var tabbox=document.createElement("div");tabbox.innerHTML=`<sl-tab slot="nav" panel="${key}" closable>${title}</sl-tab><sl-tab-panel name="${key}">${pbox}</sl-tab-panel>`;var domTab=tabbox.querySelector("sl-tab"),domTabPanel=tabbox.querySelector("sl-tab-panel"),domTool1=tabbox.querySelector(".nr-gc1-tool"),domTool2=tabbox.querySelector(".nr-gc2-tool"),domSelectFn=tabbox.querySelector(".nr-gc1-fn"),domSelectDebug=tabbox.querySelector(".nr-gc1-debug"),domSelectRun=tabbox.querySelector(".nr-gc1-run"),domEditor1=tabbox.querySelector(".nr-editor-gc1"),domEditor2=tabbox.querySelector(".nr-editor-gc2"),domSelectLanguage=tabbox.querySelector(".nr-gc2-language"),fnhtm=[];_ndkFunction__WEBPACK_IMPORTED_MODULE_0__.R.groupBy(_ndkGenerateCode__WEBPACK_IMPORTED_MODULE_6__.l.fns,(e=>e.language)).forEach((e=>{fnhtm.length>0&&fnhtm.push("<sl-divider></sl-divider>"),fnhtm.push(`<sl-menu-label>${e}</sl-menu-label>`),_ndkGenerateCode__WEBPACK_IMPORTED_MODULE_6__.l.fns.filter((a=>a.language==e)).forEach((a=>{fnhtm.push(`<sl-menu-item value="${e}:${a.name}">${e} - ${a.name}</sl-menu-item>`)}))})),domSelectFn.innerHTML=fnhtm.join(""),domSelectFn.addEventListener("sl-change",(function(){var e=ndkTab.tabKeys[this.getAttribute("panel")];if(1==this.value.length){var a=this.value[0].split(":"),t=_ndkGenerateCode__WEBPACK_IMPORTED_MODULE_6__.l.fns.find((e=>e.language==a[0]&&e.name==a[1])).code;e.editor1.setValue(`//${a.join(" - ")}\r\n${t}`),_ndkEditor__WEBPACK_IMPORTED_MODULE_1__.C.formatter(e.editor1)}else e.editor1.setValue("")})),domSelectDebug.addEventListener("click",(function(){var tpobj=ndkTab.tabKeys[this.getAttribute("panel")],code=tpobj.editor1.getValue().trim();if(""!=code){var fnout=eval("("+code+")");"function"==typeof fnout&&(fnout=fnout()),"object"==typeof fnout?(tpobj.editor2.setValue(fnout.map((e=>e.content)).join("\r\n\r\n\r\n")),domSelectLanguage.value=tpobj.domSelectFn.value[0].split(":")[0],_ndkEditor__WEBPACK_IMPORTED_MODULE_1__.C.formatter(tpobj.editor2)):tpobj.editor2.setValue(fnout.toString()),_ndkAction__WEBPACK_IMPORTED_MODULE_5__.x.setSpliterSize(tpobj.domTabPanel.children[0],"auto")}else _ndkFunction__WEBPACK_IMPORTED_MODULE_0__.R.output(_ndkI18n__WEBPACK_IMPORTED_MODULE_3__.t.lg.contentNotEmpty)})),domSelectRun.addEventListener("click",(function(){var tpobj=ndkTab.tabKeys[this.getAttribute("panel")];if(tpobj.domSelectFn.value.length){var zip=new JSZip;tpobj.domSelectFn.value.forEach((item=>{var vals=item.split(":"),code=_ndkGenerateCode__WEBPACK_IMPORTED_MODULE_6__.l.fns.find((e=>e.language==vals[0]&&e.name==vals[1])).code,fnout=eval("("+code+")");"function"==typeof fnout&&(fnout=fnout()),"object"==typeof fnout?fnout.forEach((e=>{var a=[e.name];""!=e.path&&a.unshift(e.path),zip.file(a.join("/"),e.content)})):_ndkFunction__WEBPACK_IMPORTED_MODULE_0__.R.output(fnout.toString())})),zip.generateAsync({type:"blob"}).then((function(e){_ndkFunction__WEBPACK_IMPORTED_MODULE_0__.R.download(e,"code.zip")})),_ndkFunction__WEBPACK_IMPORTED_MODULE_0__.R.output(_ndkI18n__WEBPACK_IMPORTED_MODULE_3__.t.lg.done)}else _ndkFunction__WEBPACK_IMPORTED_MODULE_0__.R.output(_ndkI18n__WEBPACK_IMPORTED_MODULE_3__.t.lg.selectAnItem)}));var slhtm=[];monaco.languages.getLanguages().map((e=>e.id)).sort().forEach((e=>{slhtm.push(`<sl-menu-item value="${e}">${e}</sl-menu-item>`)})),domSelectLanguage.innerHTML=slhtm.join(""),domSelectLanguage.value="csharp",domSelectLanguage.addEventListener("sl-change",(function(){var e=ndkTab.tabKeys[this.getAttribute("panel")];_ndkEditor__WEBPACK_IMPORTED_MODULE_1__.C.setLanguage(e.editor2,this.value)}));var slpanels=_ndkVary__WEBPACK_IMPORTED_MODULE_2__.p.domTabGroup2.querySelectorAll("sl-tab-panel");_ndkVary__WEBPACK_IMPORTED_MODULE_2__.p.domTabGroup2.insertBefore(domTab,slpanels[0]),_ndkVary__WEBPACK_IMPORTED_MODULE_2__.p.domTabGroup2.appendChild(domTabPanel),ndkTab.tabNavFix(),tabbox.remove(),ndkTab.tabKeys[key]={tpkey:key,type,domTab,domTabPanel,domTool1,domTool2,domSelectFn,domSelectSave:domSelectRun,domEditor1,domEditor2,domSelectLanguage},_ndkEditor__WEBPACK_IMPORTED_MODULE_1__.C.create(domEditor1,{language:"javascript"}).then((e=>{ndkTab.tabKeys[key].editor1=e,_ndkEditor__WEBPACK_IMPORTED_MODULE_1__.C.wordWrap(e),_ndkEditor__WEBPACK_IMPORTED_MODULE_1__.C.fullScreen(e),e.addCommand(monaco.KeyMod.CtrlCmd|monaco.KeyCode.KeyR,(function(){}))})),_ndkEditor__WEBPACK_IMPORTED_MODULE_1__.C.create(domEditor2,{language:"csharp"}).then((e=>{ndkTab.tabKeys[key].editor2=e,_ndkEditor__WEBPACK_IMPORTED_MODULE_1__.C.wordWrap(e),_ndkEditor__WEBPACK_IMPORTED_MODULE_1__.C.fullScreen(e)})),_ndkAction__WEBPACK_IMPORTED_MODULE_5__.x.setSpliterSize(domTabPanel.children[0],"no");break;case"faker":pbox='\n<div class="nr-spliter4 nrc-spliter-horizontal">\n    <div class="nrc-spliter-item">\n        Dev...\n    </div>\n\n    <div class="nrc-spliter-bar"></div>\n    <div class="nrc-spliter-bar-active"></div>\n\n    \x3c!--Editor Result--\x3e\n    <div class="nrc-spliter-item">\n        Dev...\n    </div>\n</div>\n                        ';var tabbox=document.createElement("div");tabbox.innerHTML=`<sl-tab slot="nav" panel="${key}" closable>${title}</sl-tab><sl-tab-panel name="${key}">${pbox}</sl-tab-panel>`;var domTab=tabbox.querySelector("sl-tab"),domTabPanel=tabbox.querySelector("sl-tab-panel"),slpanels=_ndkVary__WEBPACK_IMPORTED_MODULE_2__.p.domTabGroup2.querySelectorAll("sl-tab-panel");_ndkVary__WEBPACK_IMPORTED_MODULE_2__.p.domTabGroup2.insertBefore(domTab,slpanels[0]),_ndkVary__WEBPACK_IMPORTED_MODULE_2__.p.domTabGroup2.appendChild(domTabPanel),ndkTab.tabNavFix(),tabbox.remove();break;default:pbox=`\n<div class="nr-spliter2 nrc-spliter-vertical">\n    \x3c!--SQL--\x3e\n    <div class="nr-editor-box nrc-spliter-item">\n        <div class="nr-editor-tool" panel="${key}">\n            <sl-tooltip content="${_ndkI18n__WEBPACK_IMPORTED_MODULE_3__.t.lg.sqlButtonExecute} Ctrl + R" placement="right">\n              <sl-icon-button data-cmd="sql-execute-selected-or-all" panel="${key}" name="caret-right-fill" style="font-size: 1.5rem;"></sl-icon-button>\n            </sl-tooltip>\n            <sl-tooltip content="${_ndkI18n__WEBPACK_IMPORTED_MODULE_3__.t.lg.sqlButtonFormat} Alt + Shift + F" placement="right">\n              <sl-icon-button data-cmd="sql-formatting" panel="${key}" name="brush-fill" style="font-size: 1.5rem;"></sl-icon-button>\n            </sl-tooltip>\n            <sl-tooltip content="${_ndkI18n__WEBPACK_IMPORTED_MODULE_3__.t.lg.sqlButtonNote}" placement="right">\n              <sl-icon-button data-cmd="sql-notes" panel="${key}" name="journal-code" style="font-size: 1.5rem;"></sl-icon-button>\n            </sl-tooltip>\n            <sl-tooltip content="${_ndkI18n__WEBPACK_IMPORTED_MODULE_3__.t.lg.sqlButtonHistory}" placement="right">\n              <sl-icon-button data-cmd="sql-historys" panel="${key}" name="clock-history" style="font-size: 1.5rem;"></sl-icon-button>\n            </sl-tooltip>\n        </div>\n        <div class="nr-editor-sql" panel="${key}"></div>\n    </div>\n\n    <div class="nrc-spliter-bar"></div>\n    <div class="nrc-spliter-bar-active"></div>\n\n    \x3c!--Result--\x3e\n    <div class="nrc-spliter-item">\n        <sl-tab-group class="nr-tab-group-3">\n        </sl-tab-group>\n    </div>\n</div>\n                        `;var tabbox=document.createElement("div");tabbox.innerHTML=`<sl-tab slot="nav" panel="${key}" closable>${title}</sl-tab><sl-tab-panel name="${key}">${pbox}</sl-tab-panel>`;var domTab=tabbox.querySelector("sl-tab"),domTabPanel=tabbox.querySelector("sl-tab-panel"),domEditorTool=tabbox.querySelector(".nr-editor-tool"),domEditorSql=tabbox.querySelector(".nr-editor-sql"),domTabGroup3=tabbox.querySelector(".nr-tab-group-3"),slpanels=_ndkVary__WEBPACK_IMPORTED_MODULE_2__.p.domTabGroup2.querySelectorAll("sl-tab-panel");_ndkVary__WEBPACK_IMPORTED_MODULE_2__.p.domTabGroup2.insertBefore(domTab,slpanels[0]),_ndkVary__WEBPACK_IMPORTED_MODULE_2__.p.domTabGroup2.appendChild(domTabPanel),ndkTab.tabNavFix(),tabbox.remove(),ndkTab.tabKeys[key]={tpkey:key,type,domTab,domTabPanel,domEditorTool,domEditorSql,domTabGroup3},_ndkEditor__WEBPACK_IMPORTED_MODULE_1__.C.create(domEditorSql,{language:_ndkEditor__WEBPACK_IMPORTED_MODULE_1__.C.typeAsLanguage(type)}).then((e=>{ndkTab.tabKeys[key].editor=e,_ndkEditor__WEBPACK_IMPORTED_MODULE_1__.C.wordWrap(e),_ndkEditor__WEBPACK_IMPORTED_MODULE_1__.C.fullScreen(e),e.addCommand(monaco.KeyMod.CtrlCmd|monaco.KeyCode.KeyR,(function(){var e=ndkTab.tabKeys[_ndkVary__WEBPACK_IMPORTED_MODULE_2__.p.domTabGroup2.activeTab.panel];_ndkExecute__WEBPACK_IMPORTED_MODULE_4__.Y.editorSql(e.tpkey)}))})),_ndkAction__WEBPACK_IMPORTED_MODULE_5__.x.setSpliterSize(domTabPanel.children[0],"no")}}resolve(key)})),tabNavFix:()=>{document.body.style.zoom="1"==document.body.style.zoom?1.00001:1}}},821:(e,a,t)=>{t.d(a,{p:()=>r});var n=t(769),r={version:"1.1.3",theme:"auto",themeGet:()=>"auto"==r.theme?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":r.theme,resTheme:[{key:"auto",icon:"yin-yang"},{key:"light",icon:"sun"},{key:"dark",icon:"moon"}],typeDB:["SQLite","MySQL","MariaDB","Oracle","SQLServer","PostgreSQL"],typeEnv:["Development","Test","Production"],colorEnv:e=>{switch(e){case"Test":return"var(--sl-color-primary-600)";case"Production":return"var(--sl-color-danger-600)"}},iconEnv:e=>["⚫","🔵","🔴"][r.typeEnv.indexOf(e)],iconSvg:(e,a,t)=>(a=a??"",(t=Object.assign({className:"",slot:null,library:"default"},t)).slot=t.slot?`slot="${t.slot}"`:"",`<sl-icon library="${t.library}" class="${t.className}" name="${e.toLowerCase()}" ${t.slot}></sl-icon>${a}`),iconGrid:e=>`<span class="ag-icon ag-icon-${e}"></span>`,emoji:{menu:"Ⓜ",quick:"📌",id:"🆔",loading:"🛑",comment:"📝",ok:"🆗",key:"🔑",incr:"👆",star:"⭐",remove:"❌",success:"✔",cog:"⚙",parameter:"🛠",server:"🌎",io:"♻",clipboard:"📋",save:"💾",cut:"✂",see:"👁",wait:"⏳",package:"📦",link:"🔗",bucket:"🛢"},resConnTemplate:{SQLite:"Data Source={文件物理路径，或网络路径，后台自动下载文件}",MySQL:"Server={IP};Port=3306;Uid={USER};Pwd={PWD};Database={DBNAME};",MariaDB:"Server={IP};Port=3306;Uid={USER};Pwd={PWD};Database={DBNAME};",Oracle:"Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST={IP})(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=ORCL)));User Id={USER};Password={PWD};",SQLServer:"Server={IP},1433;User Id={USER};Password={PWD};Database={DBNAME};TrustServerCertificate=True;",PostgreSQL:"Server={IP};Port=5432;User Id={USER};Password={PWD};Database={DBNAME};"},resConnDemo:[{id:10001,type:"SQLite",alias:"SQLite:netnrf",group:"demo",order:1,env:"Test",conn:"Data Source=https://gs.zme.ink/2020/05/22/2037505934.db"},{id:10002,type:"MySQL",alias:"Heroku-JawsDB:ustf345c1n0wkaow",group:"demo",order:2,env:"Test",conn:"Server=c8u4r7fp8i8qaniw.chr7pe7iynqr.eu-west-1.rds.amazonaws.com;Port=3306;Uid=fyxnmvubyl01t2k9;Pwd=ai7a4eg3c31scfcm;Database=ustf345c1n0wkaow;"},{id:10003,type:"MariaDB",alias:"Heroku-JawsDB:gvx25hgtxzfr2lia",group:"demo",order:3,env:"Test",conn:"Server=eporqep6b4b8ql12.chr7pe7iynqr.eu-west-1.rds.amazonaws.com;Port=3306;Uid=hydfd5qr08d3akt9;Pwd=tk53sieop5ua97pv;Database=gvx25hgtxzfr2lia;"},{id:10005,type:"PostgreSQL",alias:"Heroku-pgsql:d7mhfq80unm96q",group:"demo",order:6,env:"Test",conn:"Server=ec2-54-74-35-87.eu-west-1.compute.amazonaws.com;Port=5432;User Id=psphnovbbmsgtj;Password=7554b25380195aa5755a24c7f6e1f9f94f3de3dcef9c345c7e93ae8b07699ace;Database=d7mhfq80unm96q;SslMode=Require;Trust Server Certificate=true;"}],parameterConfig:{autoFilterDatabaseNumber:{type:"number",value:40},selectDataLimit:{type:"number",value:100},buildSqlWithQuote:{type:"boolean",list:[{val:!0},{val:!1}],value:!0},buildSqlWithComment:{type:"boolean",list:[{val:!0},{val:!1}],value:!0},dataSqlBulkInsert:{type:"number",value:10},dataSqlWithAutoIncrement:{type:"boolean",list:[{val:!0},{val:!1}],value:!0},editorFontSize:{type:"number",value:18},editorLineNumbers:{type:"select",list:[{val:"on"},{val:"off"}],value:"on"},editorWordWrap:{type:"select",list:[{val:"on"},{val:"off"}],value:"off"},gridDataShowLength:{type:"number",value:200},maxSqlHistory:{type:"number",value:5e3},readFileEncoding:{type:"select",list:[{val:"GBK"},{val:"utf-8"}],value:"GBK"}},resApiServer:[{key:location.origin,remark:n.t.lg.current},{key:"https://netnr.zme.ink/api/v1",remark:"Deploy on Heroku"}],apiServer:"https://netnr.zme.ink/api/v1",apiHeaders:null,apiGetDatabaseName:"/DK/GetDatabaseName",apiGetDatabaseInfo:"/DK/GetDatabase",apiGetTable:"/DK/GetTable",apiGetColumn:"/DK/GetColumn",apiSetTableComment:"/DK/SetTableComment",apiSetColumnComment:"/DK/SetColumnComment",apiGetTableDDL:"/DK/GetTableDDL",apiExecuteSql:"/DK/ExecuteSql",defer:{},envConnsChanged:!1,fileObject:null,fileContent:null,pasteContent:null};for(const e in r.parameterConfig)r.parameterConfig[e].defaultValue=r.parameterConfig[e].value},513:(e,a,t)=>{t.d(a,{P:()=>g});var n=t(484),r=t(769),o=t(644),l=t(3),i=t(821),s=t(372),c=t(178),d=t(268),p=t(213),u=t(33),m=t(334),b=t(147),g={createGrid:(e,a)=>{g.removeGrid(e);var t=`gridOps${e=o.R.hump(e)}`,n=`domGrid${e}`;b.x.themeGrid(i.p.theme),b.x.size(),i.p[t]=new agGrid.Grid(i.p[n],a).gridOptions},removeGrid:e=>{var a=`gridOps${e=o.R.hump(e)}`;i.p[a]&&i.p[a].api&&(i.p[`domFilter${e}`].value="",i.p[a].api.destroy(),i.p[a]=null)},gridComponents:{connStatusBarComponent:class{init(e){this.params=e;var a=s.U.cpGet(1),t=i.p.colorEnv(a.cobj.env);t=t?`color:${t};`:"";var r=n.F.getContainer(e),o=`${a.cobj.type} ${i.p.emoji.link}${a.cobj.alias}`;a.databaseName&&!r.classList.contains("nr-grid-database")&&(o=`${o} ${i.p.emoji.bucket}${a.databaseName}`),this.eGui=document.createElement("div"),this.eGui.style.cssText=`display:flex;align-items:center;${t}`,this.eGui.innerHTML=`<small title="${a.cobj.conn}" style="white-space: nowrap;">${o}</small></sl-tooltip>`}getGui(){return this.eGui}}},viewConns:e=>new Promise((a=>{var t=n.F.optionDef({rowData:e,getRowId:e=>e.data.id,defaultColDef:n.F.defaultColDef({editable:!0}),suppressClickEdit:!0,columnDefs:[{field:"alias",headerName:r.t.lg.connAlias,tooltipField:"conn",width:350,checkboxSelection:!0,headerCheckboxSelection:!0,headerCheckboxSelectionFilteredOnly:!0,cellRenderer:e=>{if(!e.node.group)return e.data.type?i.p.iconSvg(e.data.type,e.value,{library:"nr-icon"}):e.value},cellStyle:e=>{var a=e.node.data&&e.node.data.env;switch(a){case"Test":case"Production":return{color:i.p.colorEnv(a)}}}},{field:"group",headerName:r.t.lg.connGroup,width:160,enableRowGroup:!0},{field:"env",headerName:r.t.lg.connEnv,width:160,enableRowGroup:!0,cellRenderer:e=>e.value?i.p.iconEnv(e.value)+e.value:"",cellEditor:"agRichSelectCellEditor",cellEditorParams:{values:i.p.typeEnv,formatValue:e=>i.p.iconEnv(e)+e}},{field:"type",headerName:r.t.lg.connType,enableRowGroup:!0,width:160,cellRenderer:e=>e.value?i.p.iconSvg(e.value.toLowerCase(),e.value,{library:"nr-icon"}):"",cellEditor:"agRichSelectCellEditor",cellEditorParams:{values:i.p.typeDB}},{field:"order",headerName:r.t.lg.connOrder,rowDrag:!0,filterParams:n.F.filterParamsDef("Number")},{field:"id",headerName:i.p.emoji.id,width:150,editable:!1},{field:"conn",headerName:r.t.lg.connConnection,width:600,cellEditor:"agLargeTextCellEditor",cellEditorParams:{maxLength:999}},{headerName:r.t.lg.connControl,pinned:"right",width:100,hide:!0,filter:!1,sortable:!1,editable:!1,menuTabs:!1,cellRenderer:class{init(e){this.eGui=document.createElement("div"),e.data&&(this.eGui.innerHTML='\n                                <a href="javascript:void(0);" class="text-decoration-none nr-conn-cell-add" title="新增">➕</a> &nbsp;\n                                <a href="javascript:void(0);" class="text-decoration-none nr-conn-cell-del" title="删除">❌</a>\n                               ',this.eGui.addEventListener("click",(function(a){var t=a.target;if(t.classList.contains("nr-conn-cell-add")){var n={...e.data};n.id=o.R.random(2e4,99999),n.alias+="+",i.p.gridOpsConns.api.applyTransaction({add:[n],addIndex:e.rowIndex+1}),l.$.connsSet(n)}else t.classList.contains("nr-conn-cell-del")&&confirm("确定删除？")&&(i.p.gridOpsConns.api.applyTransaction({remove:[e.data]}),l.$.connsDelete(e.data.id))}),!1))}getGui(){return this.eGui}}}],rowDragManaged:!0,rowDragMultiRow:!0,onRowDragEnd:function(e){var a=[],t=1;e.api.forEachNode((e=>{var n=e.data;n.order=t++,a.push(n)})),e.api.applyTransaction({update:a}),l.$.connsSet(a)},onCellValueChanged:function(e){"type"==e.column.colId&&e.api.refreshCells({rowNodes:[e.data],force:!0}),l.$.connsSet(n.F.getAllRows(i.p.gridOpsConns,!0))},onRowDoubleClicked:function(e){s.U.cpGet(1).cobj.id!=e.data.id&&["database","table","column"].forEach((e=>g.removeGrid(e))),s.U.cpSet(1,e.data),u.N.reqDatabaseName(e.data).then((e=>{g.viewDatabase(e).then((()=>{i.p.domTabGroup1.show("tp1-database")}))}))},onCellKeyDown:function(e){e.event.ctrlKey&&e.event.altKey&&"KeyM"==e.event.code&&(i.p.domGridConns.classList.toggle("nrc-fullscreen"),b.x.size())},getContextMenuItems:e=>{var a=e.node,t=a&&a.data,d=i.p.gridOpsConns.api.getSelectedRows(),p=[];i.p.typeDB.forEach((e=>{p.push({name:e,icon:i.p.iconSvg(e),action:function(){var t=a?a.rowIndex+1:n.F.getAllRows(i.p.gridOpsConns,!0).length,r={id:o.R.random(2e4,99999),type:e,alias:"alias",group:"default",order:t+1,env:i.p.typeEnv[0],conn:i.p.resConnTemplate[e]};i.p.gridOpsConns.api.applyTransaction({add:[r],addIndex:t}),l.$.connsSet(r)}})}));var m=[];i.p.resConnDemo.forEach((e=>{m.push({name:e.alias,icon:i.p.iconSvg(e.type),action:function(){var a=n.F.getAllRows(i.p.gridOpsConns,!0);if(a.filter((a=>a.id==e.id)).length){var t=i.p.gridOpsConns.api.getRowNode(e.id);i.p.gridOpsConns.api.ensureIndexVisible(t.rowIndex),i.p.gridOpsConns.api.flashCells({rowNodes:[t]})}else{var r=e;r.order=a.length+1,i.p.gridOpsConns.api.applyTransaction({add:[r],addIndex:a.length}),l.$.connsSet(r)}}})}));var h=[];0==d.length&&t&&d.push(t),d.length&&(h.push({name:`${r.t.lg.confirmDelete}（${d.length}）`,icon:i.p.emoji.ok,action:function(){i.p.gridOpsConns.api.applyTransaction({remove:d}),l.$.connsDelete(d.map((e=>e.id)))}}),d.forEach((e=>{h.push({name:i.p.iconSvg(e.type,e.alias,{library:"nr-icon"}),icon:i.p.iconSvg("trash"),action:function(){i.p.gridOpsConns.api.applyTransaction({remove:[e]}),l.$.connsDelete(e.id)}})})));var f=[{name:r.t.lg.newQuery,icon:i.p.emoji.comment,disabled:null==t,action:function(){c.W.tabBuild(o.R.random(),i.p.iconSvg("plug-fill",t.alias),"sql").then((e=>{i.p.domTabGroup2.show(e),s.U.cpSet(e,t),s.U.cpInfo(e)}))}},"separator",{name:r.t.lg.openConn,icon:i.p.iconSvg("plug-fill"),disabled:null==t,action:function(){s.U.cpGet(1).cobj.id!=e.node.data.id&&["database","table","column"].forEach((e=>g.removeGrid(e))),s.U.cpSet(1,e.node.data),u.N.reqDatabaseName(e.node.data).then((e=>{g.viewDatabase(e).then((()=>{i.p.domTabGroup1.show("tp1-database")}))}))}},{name:r.t.lg.createConn,icon:i.p.iconSvg("plug-fill"),subMenu:p},{name:r.t.lg.demoConn,subMenu:m},{name:r.t.lg.editConn,icon:i.p.iconSvg("pencil-square"),disabled:null==t,action:function(){e.api.startEditingCell({rowIndex:e.node.rowIndex,colKey:e.column.colId})}},{name:r.t.lg.copyConn,icon:i.p.iconGrid("copy"),disabled:null==t,action:function(){var a={...e.node.data};a.id=o.R.random(),a.alias+="+",i.p.gridOpsConns.api.applyTransaction({add:[a],addIndex:e.node.rowIndex+1}),l.$.connsSet(a)}},{name:r.t.lg.deleteConn,icon:i.p.iconSvg("trash"),disabled:0==h.length,subMenu:h},"separator",{name:r.t.lg.refresh,icon:i.p.iconSvg("arrow-repeat"),action:function(){u.N.reqConns().then((e=>{g.viewConns(e)}))}},"autoSizeAll","resetColumns",{name:r.t.lg.fullScreenSwitch,icon:i.p.iconGrid("maximize"),shortcut:"Ctrl+Alt+M",action:function(){i.p.domGridConns.classList.toggle("nrc-fullscreen"),b.x.size()}},"separator",{name:r.t.lg.save,icon:i.p.iconGrid("save"),subMenu:["csvExport","excelExport","separator",{name:"JSON",icon:i.p.iconGrid("save"),action:function(){i.p.pasteContent=JSON.stringify(n.F.getAllRows(i.p.gridOpsConns)),o.R.clipboard(i.p.pasteContent).then((()=>{o.R.output(r.t.lg.copiedToClipboard)}))}}]},"copy","copyWithHeaders"];return f}});g.createGrid("conns",t),a()})),viewTrunk:(e,a)=>new Promise((a=>{e=[{Level:0,path:["Database-1"]},{Level:1,path:["Database-1","Schema-1"]},{Level:2,path:["Database-1","Schema-1","Type-1"]},{Level:3,path:["Database-1","Schema-1","Type-1","Item-1"]},{Level:3,path:["Database-1","Schema-1","Type-1","Item-2"]}];var t=n.F.optionDef({rowData:e,getRowId:e=>e.data.TableName,rowGroupPanelShow:"never",treeData:!0,getDataPath:function(e){return console.log(arguments),e.path},defaultColDef:{flex:1},autoGroupColumnDef:{headerName:"Trunk",minWidth:300,cellRendererParams:{suppressCount:!0}},onCellKeyDown:function(e){e.event.ctrlKey&&e.event.altKey&&"KeyM"==e.event.code&&(i.p.domGridTable.classList.toggle("nrc-fullscreen"),b.x.size())},getContextMenuItems:e=>{e.node&&e.node.data;return[]}});g.createGrid("trunk",t),i.p.domGridTrunk.style.height="90vh",a()})),viewDatabase:e=>new Promise((a=>{var t=n.F.optionDef({rowData:e,getRowId:e=>e.data.DatabaseName,columnDefs:[{headerName:r.t.lg.databaseInfo,children:[n.F.numberCol(),{field:"DatabaseName",headerName:r.t.lg.dbName,tooltipField:"DatabaseName",width:350,cellRenderer:e=>{if(!e.node.group)return i.p.iconSvg("server",e.value)}},{field:"DatabaseOwner",headerName:r.t.lg.dbOwner,enableRowGroup:!0,columnGroupShow:"open"},{field:"DatabaseSpace",headerName:r.t.lg.dbSpace,enableRowGroup:!0,columnGroupShow:"open"},{field:"DatabaseCharset",headerName:r.t.lg.dbCharSet,enableRowGroup:!0,columnGroupShow:"open"},{field:"DatabaseCollation",headerName:r.t.lg.dbCollate,width:260,enableRowGroup:!0,columnGroupShow:"open"},{field:"DatabaseDataLength",headerName:r.t.lg.dbDataSize,columnGroupShow:"open",aggFunc:"sum",cellRenderer:e=>e.value>0?o.R.formatByteSize(e.value):"",filterParams:n.F.filterParamsDef("Number")},{field:"DatabaseLogLength",headerName:r.t.lg.dbLogSize,columnGroupShow:"open",aggFunc:"sum",cellRenderer:e=>e.value>0?o.R.formatByteSize(e.value):"",filterParams:n.F.filterParamsDef("Number")},{field:"DatabaseIndexLength",headerName:r.t.lg.dbIndexSize,columnGroupShow:"open",aggFunc:"sum",cellRenderer:e=>e.value>0?o.R.formatByteSize(e.value):"",filterParams:n.F.filterParamsDef("Number")},{field:"DatabasePath",headerName:r.t.lg.dbDataPath,width:400,columnGroupShow:"open"},{field:"DatabaseLogPath",headerName:r.t.lg.dbLogPath,width:400,columnGroupShow:"open"},{field:"DatabaseCreateTime",headerName:r.t.lg.createTime,width:210,columnGroupShow:"open",filterParams:n.F.filterParamsDef("Date")}]}],statusBar:{statusPanels:[{statusPanel:"connStatusBarComponent",align:"left"},{statusPanel:"agSelectedRowCountComponent"},{statusPanel:"agTotalAndFilteredRowCountComponent"}]},components:{connStatusBarComponent:g.gridComponents.connStatusBarComponent},onRowDoubleClicked:function(e){if(!e.node.group){var a=s.U.cpGet(1);s.U.cpSet(1,a.cobj,e.node.data.DatabaseName),u.N.reqTable(a.cobj,e.node.data.DatabaseName).then((e=>{g.viewTable(e,a.cobj).then((()=>{i.p.domTabGroup1.show("tp1-table")}))}))}},onColumnGroupOpened:function(e){if(e.columnGroup.expanded){var a=e.api.getSelectedRows();if(0==a.length)for(var t=e.api.getFirstDisplayedRow(),r=e.api.getLastDisplayedRow(),o=t;o<=r;o++){var l=e.api.getDisplayedRowAtIndex(o);l.group||a.push(l.data)}else n.F.getAllRows(i.p.gridOpsDatabase).length==a.length&&(a=[]);var c=s.U.cpGet(1);u.N.reqDatabaseInfo(c.cobj,a.map((e=>e.DatabaseName)).join(",")).then((e=>{i.p.gridOpsDatabase.api.applyTransactionAsync({update:e})}))}},onCellKeyDown:function(e){e.event.ctrlKey&&e.event.altKey&&"KeyM"==e.event.code&&(i.p.domGridDatabase.classList.toggle("nrc-fullscreen"),b.x.size())},getContextMenuItems:e=>{var a=e.node?e.node.data:null,t=[{name:r.t.lg.newQuery,icon:i.p.emoji.comment,disabled:null==a,action:function(){c.W.tabBuild(o.R.random(),i.p.iconSvg("server",a.DatabaseName),"sql").then((e=>{i.p.domTabGroup2.show(e);var t=s.U.cpGet(1);s.U.cpSet(e,t.cobj,a.DatabaseName),s.U.cpInfo(e)}))}},"separator",{name:r.t.lg.openDatabase,icon:i.p.iconSvg("server"),disabled:null==a,action:function(){var e=s.U.cpGet(1);s.U.cpSet(1,e.cobj,a.DatabaseName),u.N.reqTable(e.cobj,a.DatabaseName).then((a=>{g.viewTable(a,e.cobj).then((()=>{i.p.domTabGroup1.show("tp1-table")}))}))}},{name:r.t.lg.exportData,icon:i.p.iconGrid("save"),disabled:!0},{name:r.t.lg.importData,icon:i.p.iconGrid("save"),disabled:!0},{name:r.t.lg.executeSqlFile,icon:i.p.iconSvg("file-earmark-code"),disabled:!0,action:function(){}},"separator",{name:r.t.lg.refresh,icon:i.p.iconSvg("arrow-repeat"),action:function(){var e=s.U.cpGet(1);u.N.reqDatabaseName(e.cobj,!0).then((e=>{g.viewDatabase(e)}))}},"autoSizeAll","resetColumns",{name:r.t.lg.fullScreenSwitch,icon:i.p.iconGrid("maximize"),shortcut:"Ctrl+Alt+M",action:function(){i.p.domGridDatabase.classList.toggle("nrc-fullscreen"),b.x.size()}},"separator",{name:r.t.lg.save,icon:i.p.iconGrid("save"),subMenu:["csvExport","excelExport","separator",{name:"JSON",icon:i.p.iconGrid("save"),action:function(){i.p.pasteContent=JSON.stringify(n.F.getAllRows(i.p.gridOpsDatabase)),o.R.clipboard(i.p.pasteContent).then((()=>{o.R.output(r.t.lg.copiedToClipboard)}))}}]},"copy","copyWithHeaders","separator","chartRange"];return t}});if(g.setDisplayItem(t.columnDefs[0].children),g.createGrid("database",t),e.length>i.p.parameterConfig.autoFilterDatabaseNumber.value){var l,d=s.U.cpGet(1),p="Oracle"==d.cobj.type?"user id=":"database=",m=d.cobj.conn.split(";").filter((e=>e.toLowerCase().startsWith(p)));if(m.length){l=m[0].split("=").pop();try{i.p.gridOpsDatabase.api.setFilterModel({DatabaseName:{filterType:"multi",filterModels:[null,{values:[l],filterType:"set"}]}})}catch(e){console.debug(e)}}}a()})),viewTable:(e,a)=>new Promise((t=>{var h="SQLite"==a.type,f=["SQLServer","PostgreSQL"].includes(a.type),v=n.F.optionDef({rowData:e,getRowId:e=>`${e.data.SchemaName}.${e.data.TableName}`,rowGroupPanelShow:"never",columnDefs:[n.F.numberCol(),{field:"TableName",tooltipField:"TableName",headerName:r.t.lg.tableName,width:350,cellRenderer:e=>{var a=e.value;return f&&e.data&&(a=`${e.data.SchemaName}.${e.value}`),null==a?"":i.p.iconSvg("table",a)}},{field:"TableComment",tooltipField:"TableComment",headerName:r.t.lg.tableComment,width:290,hide:h,editable:!h,cellEditor:"agLargeTextCellEditor",cellEditorParams:{maxLength:999}},{field:"TableRows",headerName:r.t.lg.tableRows,filterParams:n.F.filterParamsDef("Number"),aggFunc:"sum"},{field:"TableDataLength",headerName:r.t.lg.tableDataSize,width:160,aggFunc:"sum",cellRenderer:e=>o.R.formatByteSize(e.value),filterParams:n.F.filterParamsDef("Number")},{field:"TableIndexLength",headerName:r.t.lg.tableIndexSize,width:160,aggFunc:"sum",cellRenderer:e=>o.R.formatByteSize(e.value),filterParams:n.F.filterParamsDef("Number")},{field:"TableCollation",headerName:r.t.lg.tableCollate,width:260},{field:"TableCreateTime",headerName:r.t.lg.createTime,width:220,filterParams:n.F.filterParamsDef("Date")},{field:"TableModifyTime",headerName:r.t.lg.updateTime,width:220,filterParams:n.F.filterParamsDef("Date")},{field:"TableEngine",headerName:"Engine"},{field:"SchemaName",headerName:r.t.lg.schemaName,width:200},{field:"TableOwner",headerName:r.t.lg.tableOwner},{field:"TableSpace",headerName:r.t.lg.tableSpace},{field:"TableType",headerName:r.t.lg.tableCatagory}],groupIncludeFooter:!0,groupIncludeTotalFooter:!0,statusBar:{statusPanels:[{statusPanel:"connStatusBarComponent",align:"left"},{statusPanel:"agSelectedRowCountComponent"},{statusPanel:"agTotalAndFilteredRowCountComponent"}]},components:{connStatusBarComponent:g.gridComponents.connStatusBarComponent},onCellDoubleClicked:function(e){if("TableComment"!=e.column.colId){var a=e.node.data,t=s.U.cpGet(1);s.U.cpSet(1,t.cobj,t.databaseName);var n=a.SchemaName?`${a.SchemaName}.${a.TableName}`:a.TableName;u.N.reqColumn(t.cobj,t.databaseName,n).then((e=>{g.viewColumn(e,t.cobj).then((()=>{i.p.domTabGroup1.show("tp1-column")}))}))}},onCellValueChanged:function(e){if("TableComment"==e.column.colId){var a=s.U.cpGet(1),t=e.data;u.N.setTableComment(a.cobj,t.TableName,e.value,t.SchemaName,a.databaseName).then((()=>{l.$.ccBrushTable()})).catch((()=>{var a={...e.data};a.TableComment=e.oldValue,e.api.applyTransaction({update:[a]})}))}},onCellKeyDown:function(e){e.event.ctrlKey&&e.event.altKey&&"KeyM"==e.event.code&&(i.p.domGridTable.classList.toggle("nrc-fullscreen"),b.x.size())},getContextMenuItems:e=>{var a=e.node?e.node.data:null,t="SQLite"==s.U.cpGet(1).cobj.type,l=[{name:r.t.lg.tableDesign,disabled:null==a,icon:i.p.iconSvg("layout-three-columns"),action:function(){var e=i.p.gridOpsTable.api.getSelectedRows();0==e.length&&(e=[a]);var t="";i.p.gridOpsTable.rowData.length!=e.length&&(t=e.map((e=>null==e.SchemaName?e.TableName:`${e.SchemaName}.${e.TableName}`)).join(","));var n=s.U.cpGet(1);s.U.cpSet(1,n.cobj,n.databaseName),u.N.reqColumn(n.cobj,n.databaseName,t).then((e=>{g.viewColumn(e,n.cobj).then((()=>{i.p.domTabGroup1.show("tp1-column"),s.U.stepSave()}))}))}},{name:r.t.lg.tableData,icon:i.p.iconSvg("grid-3x3-gap-fill"),disabled:null==a,action:function(){var e=i.p.gridOpsTable.api.getSelectedRows();0==e.length&&(e=[a]),c.W.tabBuild(o.R.random(),i.p.iconSvg("table",e[0].TableName),"sql").then((a=>{i.p.domTabGroup2.show(a);var t=c.W.tabKeys[a];t.editor.setValue(`-- ${r.t.lg.generatingScript}`);var n=s.U.cpGet(1);s.U.cpSet(a,n.cobj,n.databaseName),s.U.cpInfo(a);var o=s.U.cpGet(a),l=[];e.forEach((e=>{l.push(d.A.buildSelectSql(o,e))})),l=1==l.length?p.C.formatterSQL(l[0],n.cobj.type):l.join(";\r\n"),t.editor.setValue(l),e.length<6&&m.Y.editorSql(a)}))}},{name:r.t.lg.tableGenerateSQL,icon:i.p.iconSvg("file-earmark-code"),subMenu:[{name:"SELECT",icon:i.p.iconSvg("file-earmark-code"),action:function(){d.A.buildNewTabSql(a,"Select")}},{name:"INSERT",icon:i.p.iconSvg("file-earmark-code"),action:function(){d.A.buildNewTabSql(a,"Insert")}},{name:"UPDATE",icon:i.p.iconSvg("file-earmark-code"),action:function(){d.A.buildNewTabSql(a,"Update")}},{name:"DELETE",icon:i.p.iconSvg("file-earmark-code"),action:function(){d.A.buildNewTabSql(a,"Delete")}},{name:"TRUNCATE",icon:i.p.iconSvg("file-earmark-code"),disabled:t,action:function(){d.A.buildNewTabSql(a,"Truncate")}},{name:"DROP",icon:i.p.iconSvg("file-earmark-code"),action:function(){d.A.buildNewTabSql(a,"Drop")}},"separator",{name:"DDL",icon:i.p.iconSvg("file-earmark-code"),action:function(){d.A.buildNewTabSql(a,"DDL")}},{name:"结构和数据",icon:i.p.iconSvg("file-earmark-code"),action:function(){}}]},{name:r.t.lg.exportData,icon:i.p.iconGrid("save"),disabled:!0},{name:r.t.lg.importData,icon:i.p.iconGrid("save"),disabled:!0},"separator",{name:r.t.lg.refresh,icon:i.p.iconSvg("arrow-repeat"),action:function(){var e=s.U.cpGet(1);u.N.reqTable(e.cobj,e.databaseName,!0).then((a=>{g.viewTable(a,e.cobj)}))}},"autoSizeAll","resetColumns",{name:r.t.lg.fullScreenSwitch,icon:i.p.iconGrid("maximize"),shortcut:"Ctrl+Alt+M",action:function(){i.p.domGridTable.classList.toggle("nrc-fullscreen"),b.x.size()}},"separator",{name:r.t.lg.save,icon:i.p.iconGrid("save"),subMenu:["csvExport","excelExport","separator",{name:"JSON",icon:i.p.iconGrid("save"),action:function(){i.p.pasteContent=JSON.stringify(n.F.getAllRows(i.p.gridOpsTable)),o.R.clipboard(i.p.pasteContent).then((()=>{o.R.output(r.t.lg.copiedToClipboard)}))}},{name:"Markdown",icon:i.p.iconGrid("save"),action:function(){var e=i.p.gridOpsTable.columnApi.getAllGridColumns(),a=[];for(let n=1;n<e.length;n++){var t=e[n];t.visible&&a.push(t.colDef)}i.p.pasteContent=o.R.rowsToMarkdown(n.F.getAllRows(i.p.gridOpsTable),a,{htmlCull:!0}),o.R.clipboard(i.p.pasteContent).then((()=>{o.R.output(r.t.lg.copiedToClipboard)}))}}]},"copy","copyWithHeaders","separator","chartRange"];return l}});g.setDisplayItem(v.columnDefs),g.createGrid("table",v),t()})),viewColumn:(e,a)=>new Promise((t=>{var l="SQLite"==a.type,c=n.F.optionDef({rowData:e,getRowId:e=>`${e.data.SchemaName}.${e.data.TableName}.${e.data.ColumnName}`,groupSelectsChildren:!0,groupDefaultExpanded:2,columnDefs:[n.F.numberCol({hide:!0}),{field:"SchemaName",headerName:r.t.lg.schemaName,rowGroup:!0,enableRowGroup:!0,width:200,hide:!0},{field:"TableName",headerName:r.t.lg.tableName,rowGroup:!0,enableRowGroup:!0,width:350,hide:!0},{field:"TableComment",headerName:r.t.lg.tableComment,width:300,hide:!0},{field:"ColumnName",headerName:r.t.lg.columnName,width:200,hide:!0},{field:"ColumnComment",tooltipField:"ColumnComment",headerName:r.t.lg.columnComment,width:330,hide:l,editable:!l,cellEditor:"agLargeTextCellEditor",cellEditorParams:{maxLength:999}},{field:"ColumnType",headerName:r.t.lg.columnTypeLength,width:180,hide:!0},{field:"DataType",headerName:r.t.lg.columnType,width:130,hide:!0},{field:"DataLength",headerName:r.t.lg.columnLength,hide:!0,filterParams:n.F.filterParamsDef("Number")},{field:"DataScale",headerName:r.t.lg.columnScale,hide:!0,filterParams:n.F.filterParamsDef("Number")},{field:"ColumnOrder",headerName:r.t.lg.columnOrder,filterParams:n.F.filterParamsDef("Number")},{field:"PrimaryKey",headerName:r.t.lg.columnPrimary,hide:!0,cellRenderer:e=>e.value>0?i.p.emoji.key+e.value:""},{field:"AutoIncr",headerName:r.t.lg.columnAutoIncrement,cellRenderer:e=>1==e.value?i.p.emoji.incr:""},{field:"IsNullable",headerName:r.t.lg.columnIsNullable,hide:!0,cellRenderer:e=>0==e.value?i.p.emoji.star:""},{field:"ColumnDefault",headerName:r.t.lg.columnDefault,width:120}],autoGroupColumnDef:n.F.autoGroupColumnDef({field:"ColumnName",headerName:r.t.lg.group,width:560,headerCheckboxSelection:!0,headerCheckboxSelectionFilteredOnly:!0,filterValueGetter:e=>null!=e.data.SchemaName?`${e.data.SchemaName}.${e.data.TableName}`:e.data.TableName,cellRendererParams:{checkbox:!0,suppressCount:!0,suppressEnterExpand:!0,suppressDoubleClickExpand:!0,innerRenderer:function(e){if(!e.node.group){var a=[];return e.data.PrimaryKey>0&&a.push(i.p.emoji.key+e.data.PrimaryKey),a.push(e.data.ColumnType),1==e.data.IsNullable?a.push("null"):a.push("not null"),i.p.iconSvg("bookshelf",`${e.value} <span class="opacity-75">( ${a.join(", ")} )</span>`)}switch(e.node.field){case"SchemaName":var t=o.R.groupBy(i.p.gridOpsColumn.rowData.filter((a=>a[e.node.field]==e.value)),(e=>e.TableName));return`<b>${e.value} (${t.length})</b>`;case"TableName":t="SchemaName"==e.node.parent.field?i.p.gridOpsColumn.rowData.filter((a=>a[e.node.parent.field]==e.node.parent.key&&a[e.node.field]==e.value)):i.p.gridOpsColumn.rowData.filter((a=>a[e.node.field]==e.value));return`<b>${e.value} (${t.length})</b> <span title="${t[0].TableComment||""}">${t[0].TableComment||""}</span>`;default:return e.value}}}}),statusBar:{statusPanels:[{statusPanel:"connStatusBarComponent",align:"left"},{statusPanel:"agSelectedRowCountComponent"},{statusPanel:"agTotalAndFilteredRowCountComponent"}]},components:{connStatusBarComponent:g.gridComponents.connStatusBarComponent},onCellValueChanged:function(e){if("ColumnComment"==e.column.colId){var t=s.U.cpGet(1),n=e.data;u.N.setColumnComment(a,n.TableName,n.ColumnName,e.value,n.SchemaName,t.databaseName).then((()=>{})).catch((()=>{var a={...e.data};a.columnComment=e.oldValue,e.api.applyTransaction({update:[a]})}))}},onCellKeyDown:function(e){e.event.ctrlKey&&e.event.altKey&&"KeyM"==e.event.code&&(i.p.domGridColumn.classList.toggle("nrc-fullscreen"),b.x.size())},getContextMenuItems:e=>{var a=["expandAll","contractAll","separator",{name:r.t.lg.refresh,icon:i.p.iconSvg("arrow-repeat"),action:function(){var e=s.U.cpGet(1),a=o.R.groupBy(i.p.gridOpsColumn.rowData,(e=>null==e.SchemaName?e.TableName:`${e.SchemaName}.${e.TableName}`)).join(",");u.N.reqColumn(e.cobj,e.databaseName,a,!0).then((a=>{g.viewColumn(a,e.cobj)}))}},"autoSizeAll","resetColumns",{name:r.t.lg.fullScreenSwitch,icon:i.p.iconGrid("maximize"),shortcut:"Ctrl+Alt+M",action:function(){i.p.domGridColumn.classList.toggle("nrc-fullscreen"),b.x.size()}},"separator",{name:r.t.lg.save,icon:i.p.iconGrid("save"),subMenu:["csvExport","excelExport","separator",{name:"JSON",icon:i.p.iconGrid("save"),action:function(){i.p.pasteContent=JSON.stringify(n.F.getAllRows(i.p.gridOpsColumn)),o.R.clipboard(i.p.pasteContent).then((()=>{o.R.output(r.t.lg.copiedToClipboard)}))}},{name:"Markdown",icon:i.p.iconGrid("save"),action:function(){var e=i.p.gridOpsColumn.columnApi.getAllGridColumns(),a=[],t=!1;for(let n=1;n<e.length;n++){var l=e[n];l.visible&&a.push(l.colDef),"TableName"==l.colId&&l.rowGroupActive&&(t=!0)}if(t){var s=[],c=n.F.getAllRows(i.p.gridOpsColumn);o.R.groupBy(c,(e=>e.TableName)).forEach((e=>{var t=c.filter((a=>a.TableName==e)),n=o.R.markdownEncode(t[0].TableComment),r=o.R.rowsToMarkdown(t,a);s.push(`### ${e}\n${n}\n\n`+r)})),i.p.pasteContent=s.join("\n\n")}else i.p.pasteContent=o.R.rowsToMarkdown(n.F.getAllRows(i.p.gridOpsColumn),a);o.R.clipboard(i.p.pasteContent).then((()=>{o.R.output(r.t.lg.copiedToClipboard)}))}}]},"copy","copyWithHeaders"];return a}});g.setDisplayItem(c.columnDefs),g.createGrid("column",c),t()})),setDisplayItem:(e,a)=>{var t=[];switch(a=a||s.U.cpGet(1).cobj.type){case"SQLite":t=["DatabaseOwner","DatabaseSpace","DatabaseCollation","DatabaseLogLength","DatabaseIndexLength","DatabaseLogPath","TableDataLength","TableIndexLength","TableCollation","TableCreateTime","TableModifyTime","TableEngine","SchemaName","TableOwner","TableSpace","TableType","TableComment","ColumnComment"];break;case"MySQL":case"MariaDB":t=["DatabaseOwner","DatabaseSpace","DatabaseLogLength","DatabaseLogPath","TableModifyTime","TableOwner","TableSpace"];break;case"Oracle":t=["DatabaseLogLength","DatabaseLogPath","TableCollation","TableEngine","SchemaName"];break;case"SQLServer":t=["DatabaseSpace","DatabaseCharset","DatabaseIndexLength","TableCollation","TableEngine","TableSpace"];break;case"PostgreSQL":t=["DatabaseLogLength","DatabaseIndexLength","DatabaseLogPath","DatabaseCreateTime","TableCollation","TableCreateTime","TableModifyTime","TableEngine","TableSpace"]}for(var n=e.length-1;n>=0;n--){var r=e[n];t.includes(r.field)&&e.splice(n,1)}},viewExecuteSql:(e,a)=>new Promise((t=>{var l=c.W.tabKeys[a];l.grids&&l.grids.forEach((e=>e.gridOps&&e.gridOps.api.destroy())),l.grids=[],l.esdata=e,l.domTabGroup3.innerHTML="",l.domTabGroup3.getAttribute("data-bind")||(l.domTabGroup3.setAttribute("data-bind",!0),l.domTabGroup3.addEventListener("sl-close",(async e=>{var a=e.target,t=l.domTabGroup3.querySelector(`sl-tab-panel[name="${a.panel}"]`);if(a.active){var n=a.previousElementSibling||a.nextElementSibling;n.nodeName!="sl-tab-panel".toUpperCase()&&l.domTabGroup3.show(n.panel)}a.remove(),t.remove(),c.W.tabNavFix();for(var r=0;r<l.grids.length;r++){if(l.grids[r].tpkey==a.panel){l.grids.splice(r,1);break}}0==l.domTabGroup3.children.length&&b.x.setSpliterSize(l.domTabPanel.children[0],"no"),e.stopPropagation()})),l.domTabGroup3.addEventListener("sl-tab-show",(function(e){b.x.size()}),!1)),new Promise((t=>{for(const t in e)if("Item2"!=t){var c,p=0;for(const A in e[t]){p++,e.Item2&&A in e.Item2&&(c=e.Item2[A]);var u=e[t][A],m=[],g="Result",h=`tp3-${t}-${p}`;"Item1"==t?(["sql-notes","sql-historys"].includes(A)?g=o.R.hump(r.t.lg[`storageKey_${A.split("-").pop()}`]):c&&(g=c[0].BaseTableName||g),p>1&&(g+=" - "+p),g=i.p.iconSvg("grid-3x3-gap-fill",g)):g=i.p.iconSvg("info-circle","Info");var f=document.createElement("div");f.innerHTML=`\n<sl-tab slot="nav" panel="${h}" closable>${g}</sl-tab>\n<sl-tab-panel name="${h}">\n    <sl-input class="nr-filter-execute-sql mb-2" placeholder="${r.t.lg.search}" size="small">\n        <sl-icon name="search" slot="prefix"></sl-icon>\n    </sl-input>\n    <div class="nr-grid-execute-sql" data-key="${a}"></div>\n</sl-tab-panel>\n                `;let k=f.querySelector("sl-tab"),O=f.querySelector("sl-tab-panel"),I=f.querySelector(".nr-filter-execute-sql"),x=f.querySelector(".nr-grid-execute-sql");var v=l.domTabGroup3.querySelectorAll("sl-tab-panel");l.domTabGroup3.insertBefore(k,v[0]),l.domTabGroup3.appendChild(O),f.remove();var S=function(e){e.api.sizeColumnsToFit(),b.x.size()};if(u.length>0){"Item1"==t&&m.push(n.F.numberCol());var y=u[0];for(var E in y){var _=[],T=[],C={field:E,headerName:E,headerTooltip:E,width:200,enableRowGroup:!0,cellRenderer:e=>null!=e.value||e.node.group?e.value:o.R.formatNull(),headerComponentParams:{template:null}};if(c){var D=c.find((e=>e.ColumnName==E));if(D){var N=D.DataTypeName;null==N&&(N=D.DataType.split(",")[0].split(".")[1].toLowerCase()),D.IsKey&&_.push(i.p.emoji.key),_.push(D.ColumnName),_.push(N),_.push(D.ColumnSize),_.push(D.AllowDBNull?"null":"not null");var w=s.U.cpGet(l.tpkey).cobj.type,L={DataType:null==D.DataTypeName?N.replace(/\d+/g,""):D.DataTypeName,DataLength:D.ColumnSize,PrimaryKey:D.IsKey?1:0};switch(d.A.sqlDataType(w,L).category){case"string":if(C.width=Math.min(10*D.ColumnSize,500),D.DataType.startsWith("System.Byte"))if("image"===D.DataTypeName)C.cellRenderer=e=>null==e.value?o.R.formatNull():`<span role="button" data-cmd="view-cell-image" data-val="${e.value}">${i.p.emoji.see}image</span>`;else C.cellRenderer=e=>null==e.value?o.R.formatNull():`<span role="button" data-cmd="view-cell-text" data-val="${e.value}">${i.p.emoji.see}text</span>`;else C.cellRenderer=e=>{var a=i.p.parameterConfig.gridDataShowLength.value;return null==e.value?o.R.formatNull():e.value.length>a?`${i.p.emoji.cut} ${o.R.htmlEncode(e.value.substring(0,a))} ...`:o.R.htmlEncode(e.value)};T.push(i.p.iconSvg("type"));break;case"number":T.push(i.p.iconSvg("123")),C.filterParams=n.F.filterParamsDef("Number");break;case"date":T.push(i.p.iconSvg("clock")),C.width=280,C.filterParams=n.F.filterParamsDef("Date")}D.IsKey&&T.push(i.p.iconSvg("key","",{className:"nrc-text-orange"})),C.width=Math.max(C.width,200),C.width=Math.min(C.width,500)}}else _.push(E);C.headerTooltip=_.join(" "),C.headerComponentParams.template=`\n                            <div class="ag-cell-label-container" role="presentation">\n                                <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n                                <div ref="eLabel" class="ag-header-cell-label" role="presentation" unselectable="on">\n                                    <sup class="ag-header-type-icon">${T.join("")}</sup>\n                                    <span ref="eText" class="ag-header-cell-text" unselectable="on"></span>\n                                    <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n                                    <span ref="eSortOrder" class="ag-header-icon ag-header-label-icon ag-sort-order" aria-hidden="true"></span>\n                                    <span ref="eSortAsc" class="ag-header-icon ag-header-label-icon ag-sort-ascending-icon" aria-hidden="true"></span>\n                                    <span ref="eSortDesc" class="ag-header-icon ag-header-label-icon ag-sort-descending-icon" aria-hidden="true"></span>\n                                    <span ref="eSortNone" class="ag-header-icon ag-header-label-icon ag-sort-none-icon" aria-hidden="true"></span>\n                                </div>\n                            </div>`,m.push(C)}m.length>3&&(S=function(){b.x.size()})}else if(A in(e.Item2||{})){for(const a in e.Item2[A]){var R=e.Item2[A][a];m.push({headerName:R.ColumnName,field:R.ColumnName,headerTooltip:E})}S=function(e){e.columnApi.autoSizeAllColumns(),b.x.size()}}let P=n.F.optionDef({rowData:u,columnDefs:m,statusBar:{statusPanels:[{statusPanel:"agSelectedRowCountComponent"},{statusPanel:"agTotalAndFilteredRowCountComponent"}]},onCellKeyDown:function(e){e.event.ctrlKey&&e.event.altKey&&"KeyM"==e.event.code&&(x.classList.toggle("nrc-fullscreen"),b.x.size())},getContextMenuItems:e=>[{name:"NULL",disabled:!0},{name:r.t.lg.delete,icon:i.p.iconGrid("cross"),disabled:!0},"separator",{name:r.t.lg.save,icon:i.p.iconGrid("save"),subMenu:["csvExport","excelExport","separator",{name:"JSON",icon:i.p.iconGrid("save"),action:function(){i.p.pasteContent=JSON.stringify(n.F.getAllRows(P)),o.R.clipboard(i.p.pasteContent).then((()=>{o.R.output(r.t.lg.copiedToClipboard)}))}},{name:"Markdown",icon:i.p.iconGrid("save")}]},"copy","copyWithHeaders",{name:r.t.lg.dataGenerateSQL,icon:i.p.iconSvg("file-earmark-code"),subMenu:[{name:"INSERT",icon:i.p.iconSvg("file-earmark-code"),action:function(){d.A.dataNewSql(e,"Insert")}},{name:"UPDATE",icon:i.p.iconSvg("file-earmark-code"),action:function(){d.A.dataNewSql(e,"Update")}},{name:"DELETE",icon:i.p.iconSvg("file-earmark-code"),action:function(){d.A.dataNewSql(e,"Delete")}}]},"separator","autoSizeAll","resetColumns",{name:r.t.lg.fullScreenSwitch,icon:i.p.iconGrid("maximize"),shortcut:"Ctrl+Alt+M",action:function(){x.classList.toggle("nrc-fullscreen"),b.x.size()}},"separator","chartRange"],onGridReady:S});"Item1"!=t&&(P.columnDefs.forEach((e=>{delete e.width,e.flex=1})),delete P.onGridReady,P.rowGroupPanelShow="never",P.headerHeight=0,P.getContextMenuItems=()=>["copy","csvExport","excelExport","separator","autoSizeAll","resetColumns",{name:r.t.lg.fullScreenSwitch,icon:i.p.iconGrid("maximize"),shortcut:"Ctrl+Alt+M",action:function(){x.classList.toggle("nrc-fullscreen"),b.x.size()}}]),l.grids.push({tpkey:h,domTab:k,domTabPanel:O,domFilterExecuteSql:I,domGridExecuteSql:x,opsExecuteSql:P})}}t()})).then((()=>{c.W.tabNavFix(),2==l.grids.length&&0==l.grids[0].opsExecuteSql.columnDefs.length?l.domTabGroup3.show(l.grids[1].tpkey):l.domTabGroup3.show(l.grids[0].tpkey),b.x.setSpliterSize(l.domTabPanel.children[0],"auto"),b.x.themeGrid(i.p.theme),b.x.size(),t(l)}))}))}}},__webpack_module_cache__={};function __webpack_require__(e){var a=__webpack_module_cache__[e];if(void 0!==a)return a.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.exports}__webpack_require__.d=(e,a)=>{for(var t in a)__webpack_require__.o(a,t)&&!__webpack_require__.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},__webpack_require__.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a);var __webpack_exports__={};(()=>{var e=__webpack_require__(484),a=__webpack_require__(147),t=__webpack_require__(213),n=__webpack_require__(334),r=__webpack_require__(644),o=__webpack_require__(722),l=__webpack_require__(268),i=__webpack_require__(408),s=__webpack_require__(769),c=__webpack_require__(33),d=__webpack_require__(384),p=__webpack_require__(372),u=__webpack_require__(3),m=__webpack_require__(178),b=__webpack_require__(821),g=__webpack_require__(513),h={dom:()=>{var e=document.createElement("div");e.className="nr-main",e.style.visibility="hidden";var a=[`<sl-input class="nr-text-api-server mb-2" placeholder="${s.t.lg.setServerPlaceholder}"></sl-input>`];b.p.resApiServer.forEach((e=>{a.push(`\n            <sl-tooltip content="${e.remark??e.key}">\n                <sl-button class="mb-2" size="small" data-cmd="set-api-server" data-val="${e.key}" >${e.key}</sl-button>\n            </sl-tooltip>\n            `)}));var t=[];b.p.resTheme.forEach((e=>{t.push(`<sl-menu-item data-cmd="theme" data-val="${e.key}">${b.p.iconSvg(e.icon,s.t.lg[`themeKey_${e.key}`],{slot:"prefix"})}</sl-menu-item>`)}));var n=[];s.t.resLanguage.forEach((e=>{n.push(`<sl-menu-item data-cmd="language" data-val="${e.key}">${b.p.iconSvg(e.icon,s.t.lg[`languageKey_${e.key.replace("-","_")}`],{slot:"prefix"})}</sl-menu-item>`)}));var o=[];o.push('<div class="nr-config-export-items mb-2">');for(const e in u.$.keys){var l=u.$.keys[e].key,i=s.t.lg[`storageKey_${l}`];o.push(`<sl-checkbox checked class="me-3" data-val="${l}">${i}</sl-checkbox>`)}o.push("</div>"),o.push(`\n        <sl-button type="default" class="mb-2" data-cmd="config-export">${b.p.emoji.save}${s.t.lg.setExportSave}</sl-button>\n        <sl-button type="default" class="mb-2" data-cmd="config-export-clipboard">${b.p.emoji.clipboard}${s.t.lg.setExportSaveClipboard}</sl-button>\n        `);var c=[];c.push(`\n        <sl-textarea label="ndk.json" class="mb-2" placeholder="${s.t.lg.setImportPlaceholder}"></sl-textarea>\n        <sl-button type="default" data-cmd="config-import">${b.p.emoji.save}${s.t.lg.setImportSave}</sl-button>\n        `),r.R.supportClipboard&&c.push(`<sl-button type="default" data-cmd="config-import-clipboard">${b.p.emoji.clipboard}${s.t.lg.setImportSaveClipboard}</sl-button>`),e.innerHTML=`\n        \x3c!--顶部--\x3e\n        <div class="nr-box0">\n            \x3c!--菜单--\x3e\n            <sl-dropdown class="nr-menu mb-2">\n                <sl-button type="default" slot="trigger" size="small" caret class="nr-request-status">${b.p.emoji.menu}${s.t.lg.menu}</sl-button>\n                <sl-menu>\n                    <sl-menu-item data-cmd="setting-manager">\n                        ${b.p.iconSvg("gear",s.t.lg.setting,{slot:"prefix"})}\n                    </sl-menu-item>\n                    <sl-divider></sl-divider>\n                    ${t.join("\n")}\n                    <sl-divider></sl-divider>\n                    ${n.join("\n")}\n                    <sl-divider></sl-divider>\n                    <sl-menu-item data-cmd="about">\n                        ${b.p.iconSvg("info-circle",s.t.lg.about,{slot:"prefix"})}\n                    </sl-menu-item>\n                </sl-menu>\n            </sl-dropdown>\n\n            \x3c!--设置弹窗--\x3e\n            <sl-dialog label="${b.p.emoji.cog}${s.t.lg.setTitle}" class="nr-dialog-setting dialog-width" style="--width: 70vw;">\n                <sl-details summary="${b.p.emoji.server}${s.t.lg.setServerTitle}" open>\n                    ${a.join("\n")}\n                </sl-details>\n                <sl-details summary="${b.p.emoji.parameter}${s.t.lg.setParameterConfigTitle}" open>\n                    <div class="nr-parameter-config"></div>\n                </sl-details>\n                <sl-details summary="${b.p.emoji.io}${s.t.lg.setExportTitle}" open>\n                    ${o.join("\n")}                    \n                    <sl-divider></sl-divider>\n                    ${c.join("\n")}                    \n                </sl-details>\n            </sl-dialog>\n\n            \x3c!--新建查询--\x3e\n            <sl-button class="mb-2" data-cmd="new-query" size="small">${b.p.emoji.comment}${s.t.lg.newQuery}</sl-button>\n\n            <sl-divider vertical></sl-divider>\n            \n            \x3c!--快捷01--\x3e\n            <sl-dropdown class="nr-quick01 mb-2">\n                <sl-button slot="trigger" size="small" caret>${b.p.emoji.quick}${s.t.lg.quick}</sl-button>\n                <sl-menu>\n                    <sl-menu-item data-cmd="quick-dbenvinfo">\n                        ${b.p.iconSvg("info-circle",s.t.lg.dbEnvInfo,{slot:"prefix"})}\n                    </sl-menu-item>\n                    <sl-menu-item data-cmd="quick-dbparamsinfo">\n                        ${b.p.iconSvg("info-circle",s.t.lg.dbParamsInfo,{slot:"prefix"})}\n                    </sl-menu-item>\n                    <sl-divider></sl-divider>\n                    <sl-menu-item data-cmd="quick-generate-code">\n                        ${b.p.iconSvg("file-earmark-code",s.t.lg.generateCode,{slot:"prefix"})}\n                    </sl-menu-item>\n                    <sl-menu-item data-cmd="quick-generate-faker">\n                        ${b.p.iconSvg("box",s.t.lg.generateFaker,{slot:"prefix"})}\n                    </sl-menu-item>\n                    <sl-divider></sl-divider>\n                    <sl-menu-item data-cmd="open-link" data-val="https://www.connectionstrings.com">\n                        ${b.p.iconSvg("box-arrow-up-right","ConnectionString",{slot:"prefix"})}\n                    </sl-menu-item>\n                    <sl-menu-item data-cmd="open-link" data-val="https://database.guide">\n                        ${b.p.iconSvg("box-arrow-up-right","Guide",{slot:"prefix"})}\n                    </sl-menu-item>\n                </sl-menu>\n            </sl-dropdown>\n\n            \x3c!--快捷02--\x3e\n            <sl-dropdown class="nr-quick02 mb-2">\n                <sl-button slot="trigger" size="small" caret>${b.p.emoji.package}${s.t.lg.package}</sl-button>\n                <sl-menu>\n                    <sl-menu-item data-cmd="quick-notes">\n                        ${b.p.iconSvg("journal-code",s.t.lg.note,{slot:"prefix"})}\n                    </sl-menu-item>\n                    <sl-menu-item data-cmd="quick-links">\n                        ${b.p.iconSvg("link-45deg",s.t.lg.link,{slot:"prefix"})}\n                    </sl-menu-item>\n                </sl-menu>\n            </sl-dropdown>\n\n            <sl-divider vertical></sl-divider>\n            \n            \x3c!--当前选项卡连接信息--\x3e\n            <sl-dropdown class="nr-tabconns mb-2"></sl-dropdown>\n            <sl-dropdown class="nr-tabdatabase mb-2"></sl-dropdown>\n\n            <div>\n                \x3c!--输出--\x3e\n                <div class="nr-output">\n                    <sl-icon-button slot="trigger" name="info-circle"></sl-icon-button>\n                    <div class="nr-output-body">\n                        <sl-input class="nr-filter-output mb-2" size="small" placeholder="${s.t.lg.search}">\n                            <sl-icon name="search" slot="prefix"></sl-icon>\n                        </sl-input>\n                        <div class="nr-grid-output" style="width:40em;max-width:100%;height:30vh"></div>\n\n                        \x3c!--队列--\x3e\n                        <div class="nr-grid-queue" style="width:40em;max-width:100%;height:5em;margin-top:0.3em"></div>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n\n        \x3c!--主体分离器--\x3e\n        <div class="nr-spliter1 nrc-spliter-horizontal">\n\n            \x3c!--左--\x3e\n            <div class="nr-box1 nrc-spliter-item">\n                \x3c!--选项卡--\x3e\n                <sl-tab-group class="nr-tab-group-1">\n                    <sl-tab slot="nav" panel="tp1-conns">${b.p.iconSvg("plug-fill",s.t.lg.tab1Conns)}</sl-tab>\n                    <sl-tab slot="nav" panel="tp1-trunk" style="display:none">${b.p.iconSvg("diagram-3-fill","Trunk")}</sl-tab>\n                    <sl-tab slot="nav" panel="tp1-database">${b.p.iconSvg("server",s.t.lg.tab1Database)}</sl-tab>\n                    <sl-tab slot="nav" panel="tp1-table">${b.p.iconSvg("table",s.t.lg.tab1Table)}</sl-tab>\n                    <sl-tab slot="nav" panel="tp1-column">${b.p.iconSvg("bookshelf",s.t.lg.tab1Column)}</sl-tab>\n\n                    <sl-tab-panel name="tp1-conns">\n                        <sl-input class="nr-filter-conns mb-2" placeholder="${s.t.lg.search}" size="small">\n                            <sl-icon name="search" slot="prefix"></sl-icon>\n                        </sl-input>\n                        <div class="nr-grid-conns"></div>\n                    </sl-tab-panel>\n                    <sl-tab-panel name="tp1-trunk" style="display:none">\n                        <sl-input class="nr-filter-trunk mb-2" placeholder="${s.t.lg.search}" size="small">\n                            <sl-icon name="search" slot="prefix"></sl-icon>\n                        </sl-input>\n                        <div class="nr-grid-trunk"></div>\n                    </sl-tab-panel>\n                    <sl-tab-panel name="tp1-database">\n                        <sl-input class="nr-filter-database mb-2" placeholder="${s.t.lg.search}" size="small">\n                            <sl-icon name="search" slot="prefix"></sl-icon>\n                        </sl-input>\n                        <div class="nr-grid-database"></div>\n                    </sl-tab-panel>\n                    <sl-tab-panel name="tp1-table">\n                        <sl-input class="nr-filter-table mb-2" placeholder="${s.t.lg.search}" size="small">\n                            <sl-icon name="search" slot="prefix"></sl-icon>\n                        </sl-input>\n                        <div class="nr-grid-table"></div>\n                    </sl-tab-panel>\n                    <sl-tab-panel name="tp1-column">\n                        <sl-input class="nr-filter-column mb-2" placeholder="${s.t.lg.search}" size="small">\n                            <sl-icon name="search" slot="prefix"></sl-icon>\n                        </sl-input>\n                        <div class="nr-grid-column"></div>\n                    </sl-tab-panel>\n                </sl-tab-group>\n            </div>\n            <div class="nrc-spliter-bar"></div>\n            <div class="nrc-spliter-bar-active"></div>\n\n            \x3c!--右--\x3e\n            <div class="nr-box2 nrc-spliter-item">\n                <sl-tab-group class="nr-tab-group-2">\n                </sl-tab-group>\n            </div>\n        </div>\n        `,document.body.appendChild(e)},event:function(){if(document.body.addEventListener("click",(function(e){var t=e.target.getAttribute("data-cmd");null!=t&&a.x.actionRun(t,e.target)}),!1),document.body.addEventListener("mousedown",(function(e){if(e.target.classList.contains("nrc-spliter-bar")){var t,n,r=e.target.parentElement,o=r.children,l=o[0],i=o[2];e.target.parentElement.classList.contains("nrc-spliter-horizontal")?(t=function(a){var t=l.clientWidth-(e.clientX-a.clientX);t=Math.max(0,t),t=Math.min(r.clientWidth-i.clientWidth,t),i.style.display="block",i.style.left=`${t}px`},n=function(){i.style.display="none";var e=i.style.left;e.includes("%")||(e=(parseInt(i.style.left||l.clientWidth)/r.clientWidth*100).toFixed(4)+"%"),a.x.setSpliterSize(r,e),window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",n),this.releaseCapture&&this.releaseCapture()}):(t=function(a){var t=l.clientHeight-(e.clientY-a.clientY);t=Math.max(0,t),t=Math.min(r.clientHeight-i.clientHeight,t),i.style.display="block",i.style.top=`${t}px`},n=function(){i.style.display="none";var e=i.style.top;e.includes("%")||(e=(parseInt(i.style.top||l.clientHeight)/r.clientHeight*100).toFixed(4)+"%"),i.style.top=e,l.style.height=e,i.nextElementSibling.style.height=`calc(100% - var(--nrc-spliter-width) - ${e})`,a.x.size(),window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",n),this.releaseCapture&&this.releaseCapture()}),window.addEventListener("mousemove",t,!1),window.addEventListener("mouseup",n,!1),this.setCapture&&this.setCapture()}}),!1),document.body.addEventListener("dblclick",(function(e){if(e.target.classList.contains("nrc-spliter-bar")){var t,n=e.target.parentElement;(t=n.classList.contains("nrc-spliter-horizontal")?(e.clientY-e.target.getBoundingClientRect().top)/e.target.clientHeight:(e.clientX-e.target.getBoundingClientRect().left)/e.target.clientWidth)<.33333?a.x.setSpliterSize(n,"85%"):t>.33333&&t<.66666?a.x.setSpliterSize(n,"50%"):a.x.setSpliterSize(n,"15%")}})),document.body.addEventListener("transitionend",(function(e){if(e.target.classList.contains("nrc-spliter-item")&&["width","height"].indexOf(e.propertyName)>-1){var t=e.target.parentElement;t.classList.contains("nr-spliter1")&&p.U.stepSave(),t.classList.contains("nr-spliter2")&&a.x.size()}})),b.p.domTabGroup1.addEventListener("sl-tab-show",(function(){new Promise((e=>e())).then((()=>{a.x.size(),p.U.stepSave()}))}),!1),["conns","database","table","column"].forEach((e=>{e=r.R.hump(e),b.p[`domFilter${e}`].addEventListener("input",(function(a){clearTimeout(a.target.si),a.target.si=setTimeout((()=>{var a=b.p[`gridOps${e}`];a&&a.api&&(a.api.setQuickFilter(this.value),p.U.stepSave())}),200)}))})),b.p.domTabGroup2.addEventListener("sl-close",(async e=>{var a=e.target,t=b.p.domTabGroup2.querySelector(`sl-tab-panel[name="${a.panel}"]`);if(a.active){var n=a.previousElementSibling||a.nextElementSibling;n.nodeName!="sl-tab-panel".toUpperCase()?b.p.domTabGroup2.show(n.panel):p.U.cpInfo("reset")}a.remove(),t.remove(),m.W.tabNavFix(),delete m.W.tabKeys[a.panel],p.U.cpRemove(a.panel)})),b.p.domTabGroup2.addEventListener("sl-tab-show",(function(e){e.target.classList.contains("nr-tab-group-2")&&p.U.cpInfo(e.detail.name),new Promise((e=>e())).then((()=>a.x.size()))}),!1),b.p.domOutput.firstElementChild.addEventListener("click",(function(){b.p.domOutputBody.style.display="block"==b.p.domOutputBody.style.display?"none":"block"}),!1),b.p.domOutputBody.addEventListener("mouseenter",(function(){clearTimeout(b.p.defer.outputAutoHide)}),!1),b.p.domOutputBody.addEventListener("mouseleave",(function(){b.p.defer.outputAutoHide=setTimeout((()=>{b.p.domOutputBody.style.display="none"}),6e3)}),!1),null==b.p.gridOpsOutput){var t=e.F.optionDef({rowData:[],defaultColDef:e.F.defaultColDef(),columnDefs:[{field:"content",flex:1}],headerHeight:0,rowGroupPanelShow:"never",onCellKeyDown:function(e){e.event.ctrlKey&&e.event.altKey&&"KeyM"==e.event.code&&(b.p.domGridOutput.classList.toggle("nrc-fullscreen"),a.x.size())},getContextMenuItems:()=>[{name:"清空",icon:b.p.iconSvg("trash"),action:function(){b.p.gridOpsOutput.rowData=[],b.p.gridOpsOutput.api.setRowData([])}},{name:s.t.lg.save,icon:b.p.iconGrid("save"),subMenu:["csvExport","excelExport"]},"copy","separator",{name:s.t.lg.fullScreenSwitch,icon:b.p.iconGrid("maximize"),shortcut:"Ctrl+Alt+M",action:function(){b.p.domGridOutput.classList.toggle("nrc-fullscreen")}}]});ndkView.createGrid("output",t),b.p.domFilterOutput.addEventListener("input",(function(){b.p.gridOpsOutput.api.setQuickFilter(this.value)}),!1)}if(null==b.p.gridOpsQueue){t=e.F.optionDef({rowData:[],defaultColDef:e.F.defaultColDef(),columnDefs:[{field:"cancel",cellRenderer:()=>b.p.emoji.loading,width:30},{field:"abortCtrl",flex:1,cellRenderer:e=>`${s.t.lg.inProgress} &nbsp; ${e.data.date}`}],headerHeight:0,rowGroupPanelShow:"never",onCellClicked:function(e){"cancel"==e.column.colId&&c.N.statusInfo.queueCancel(e.data)}});ndkView.createGrid("queue",t)}window.addEventListener("error",(function(e){if(console.debug(e),e.error){var a={message:e.error.message,stack:e.error.stack};u.$.errorsAdd(a),r.R.notify(s.t.lg.notify,{body:a.message,icon:"favicon.ico",tag:"error"})}})),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>{if("auto"==b.p.theme){let t=e.matches?"dark":"light";console.debug(`Change the theme to ${t}`),a.x.actionRun("theme","auto")}})),document.addEventListener("dragover",(function(e){e.stopPropagation(),e.preventDefault()})),document.addEventListener("drop",(function(e){e.stopPropagation(),e.preventDefault();var a=e.dataTransfer.files[0];a&&(b.p.fileObject=a,b.p.fileContent=null,["text","json"].filter((e=>a.type.includes(e))).length>0||[".sql",".md"].filter((e=>a.name.endsWith(e))).length>0?r.R.readFileContent(a,b.p.parameterConfig.readFileEncoding.value).then((a=>{b.p.fileContent=a,e.target.nodeName.includes("TEXTAREA")?(b.p.fileEditor=e.target,b.p.fileEditor.value=a):document.querySelectorAll(".monaco-editor").forEach((t=>{if(t.contains(e.target)){var n=monaco.editor.getModels().find((e=>e.uri==t.dataset.uri));n&&(b.p.fileEditor=n,n.setValue(a))}}))})).catch((e=>{r.R.output(e)})):r.R.output(s.t.lg.onlyTextFile))})),document.addEventListener("paste",(function(e){var a=e.clipboardData.getData("text/plain");b.p.pasteContent=a})),window.addEventListener("resize",(()=>a.x.size()),!1)}};window.addEventListener("DOMContentLoaded",(function(){e.F.lk(),u.$.init(window.localforage),u.$.stepsGet().then((e=>{e&&e.language&&(s.t.language=e.language),h.dom(),document.querySelectorAll("*").forEach((e=>{if(e.classList.value.startsWith("nr-")){var a="dom";e.classList[0].substring(3).split("-").forEach((e=>a+=e.substring(0,1).toUpperCase()+e.substring(1))),b.p[a]=e}})),a.x.actionRun("language",s.t.language),t.C.init(window.meRequire),h.event(),p.U.stepStart().then((()=>{b.p.domLoading.style.display="none",b.p.domMain.style.visibility="visible"}))}))}),!1),Object.assign(window,{agg:e.F,ndkInit:h,ndkAction:a.x,ndkEditor:t.C,ndkExecute:n.Y,ndkFunction:r.R,ndkGenerateCode:o.l,ndkGenerateSQL:l.A,ndkGenerateDDL:i.w,ndkI18n:s.t,ndkRequest:c.N,ndkNoteSQL:d.A,ndkStep:p.U,ndkStorage:u.$,ndkTab:m.W,ndkVary:b.p,ndkView:g.P})})()})();